/*
* picasso.js v0.15.0
* Copyright (c) 2018 QlikTech International AB
* Released under the MIT license.
*/


!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.picasso=e()}(this,function(){"use strict";var o={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},n=/([astvzqmhlc])([^astvzqmhlc]*)/gi,s=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/gi;function d(t){var a=[],e=String(t).trim();return"M"!==e[0]&&"m"!==e[0]||e.replace(n,function(t,e,n){var i,r=e.toLowerCase();if(n=(i=n.match(s))?i.map(Number):[],"m"===r&&2<n.length&&(a.push([e].concat(n.splice(0,2))),r="l",e="m"===e?"l":"L"),n.length<o[r])return"";for(a.push([e].concat(n.splice(0,o[r])));n.length>=o[r]&&n.length&&o[r];)a.push([e].concat(n.splice(0,o[r])));return""}),a}function c(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function l(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function R(t,e){var n=t.x*Math.cos(e)-t.y*Math.sin(e),i=t.y*Math.cos(e)+t.x*Math.sin(e);t.x=n,t.y=i}function z(t,e,n){t.x+=e,t.y+=n}"undefined"!=typeof window&&function(t){if(void 0!==t&&t.CanvasRenderingContext2D&&(!t.Path2D||(n=(e=t).document.createElement("canvas").getContext("2d"),i=new e.Path2D("M0 0 L1 1"),n.strokeStyle="red",n.lineWidth=1,n.stroke(i),255!==n.getImageData(0,0,1,1).data[0]))){var e,n,i,r=function(){function n(t){var e;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,n),this.segments=[],t&&t instanceof n?(e=this.segments).push.apply(e,l(t.segments)):t&&(this.segments=d(t))}var t,e;return c((t=n).prototype,[{key:"addPath",value:function(t){var e;t&&t instanceof n&&(e=this.segments).push.apply(e,l(t.segments))}},{key:"moveTo",value:function(t,e){this.segments.push(["M",t,e])}},{key:"lineTo",value:function(t,e){this.segments.push(["L",t,e])}},{key:"arc",value:function(t,e,n,i,r,a){this.segments.push(["AC",t,e,n,i,r,!!a])}},{key:"arcTo",value:function(t,e,n,i,r){this.segments.push(["AT",t,e,n,i,r])}},{key:"closePath",value:function(){this.segments.push(["Z"])}},{key:"bezierCurveTo",value:function(t,e,n,i,r,a){this.segments.push(["C",t,e,n,i,r,a])}},{key:"quadraticCurveTo",value:function(t,e,n,i){this.segments.push(["Q",t,e,n,i])}},{key:"rect",value:function(t,e,n,i){this.segments.push(["R",t,e,n,i])}}]),e&&c(t,e),n}(),a=t.CanvasRenderingContext2D.prototype.fill,o=t.CanvasRenderingContext2D.prototype.stroke;t.CanvasRenderingContext2D.prototype.fill=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i="nonzero";0===e.length||1===e.length&&"string"==typeof e[0]?a.apply(this,e):(2===arguments.length&&(i=e[1]),s(this,e[0].segments),a.call(this,i))},t.CanvasRenderingContext2D.prototype.stroke=function(t){t&&s(this,t.segments),o.call(this)},t.Path2D=r}function s(t,e){var n,i,r,a,o,s,c,l,u,h,f,d,g,p,y,v,m,x,b,w,k,M={x:0,y:0};"S"!==y&&"s"!==y&&"C"!==y&&"c"!==y&&(x=m=null),"T"!==y&&"t"!==y&&"Q"!==y&&"q"!==y&&(w=b=null),t.beginPath();for(var _=0;_<e.length;++_){var S=e[_];switch(y=S[0]){case"m":c+=S[1],u+=S[2],t.moveTo(c,u);break;case"M":c=S[1],u=S[2],t.moveTo(c,u);break;case"l":c+=S[1],u+=S[2],t.lineTo(c,u);break;case"L":c=S[1],u=S[2],t.lineTo(c,u);break;case"H":c=S[1],t.lineTo(c,u);break;case"h":c+=S[1],t.lineTo(c,u);break;case"V":u=S[1],t.lineTo(c,u);break;case"v":u+=S[1],t.lineTo(c,u);break;case"a":case"A":"a"===y?(c+=S[6],u+=S[7]):(c=S[6],u=S[7]),f=S[1],r=S[4],a=S[5],z(o={x:c,y:u},-M.x,-M.y),R(o,-(s=Math.atan2(o.y,o.x))),(v={x:0,y:0}).x=d=o.x/2,v.y=a&&!r||!a&&r?Math.sqrt(f*f-d*d):-Math.sqrt(f*f-d*d),i=Math.atan2(-v.y,-v.x),n=Math.atan2(o.y-v.y,o.x-v.x),i+=s,n+=s,R(o,s),R(v,s),z(o,M.x,M.y),z(v,M.x,M.y),t.arc(v.x,v.y,f,i,n,!a);break;case"C":m=S[3],x=S[4],c=S[5],u=S[6],t.bezierCurveTo(S[1],S[2],m,x,c,u);break;case"c":t.bezierCurveTo(S[1]+c,S[2]+u,S[3]+c,S[4]+u,S[5]+c,S[6]+u),m=S[3]+c,x=S[4]+u,c+=S[5],u+=S[6];break;case"S":null!==m&&null!==m||(m=c,x=u),t.bezierCurveTo(2*c-m,2*u-x,S[1],S[2],S[3],S[4]),m=S[1],x=S[2],c=S[3],u=S[4];break;case"s":null!==m&&null!==m||(m=c,x=u),t.bezierCurveTo(2*c-m,2*u-x,S[1]+c,S[2]+u,S[3]+c,S[4]+u),m=S[1]+c,x=S[2]+u,c+=S[3],u+=S[4];break;case"Q":b=S[1],w=S[2],c=S[3],u=S[4],t.quadraticCurveTo(b,w,c,u);break;case"q":b=S[1]+c,w=S[2]+u,c+=S[3],u+=S[4],t.quadraticCurveTo(b,w,c,u);break;case"T":null!==b&&null!==b||(b=c,w=u),b=2*c-b,w=2*u-w,c=S[1],u=S[2],t.quadraticCurveTo(b,w,c,u);break;case"t":null!==b&&null!==b||(b=c,w=u),b=2*c-b,w=2*u-w,c+=S[1],u+=S[2],t.quadraticCurveTo(b,w,c,u);break;case"z":case"Z":t.closePath();break;case"AC":c=S[1],u=S[2],f=S[3],i=S[4],n=S[5],k=S[6],t.arc(c,u,f,i,n,k);break;case"AT":l=S[1],h=S[2],c=S[3],u=S[4],f=S[5],t.arcTo(l,h,c,u,f);break;case"R":c=S[1],u=S[2],g=S[3],p=S[4],t.rect(c,u,g,p)}M.x=c,M.y=u}}}(window);var r=Object.prototype.hasOwnProperty,a=Object.prototype.toString,i=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h=function(t){return"function"==typeof Array.isArray?Array.isArray(t):"[object Array]"===a.call(t)},f=function(t){if(!t||"[object Object]"!==a.call(t))return!1;var e,n=r.call(t,"constructor"),i=t.constructor&&t.constructor.prototype&&r.call(t.constructor.prototype,"isPrototypeOf");if(t.constructor&&!n&&!i)return!1;for(e in t);return void 0===e||r.call(t,e)},g=function(t,e){i&&"__proto__"===e.name?i(t,e.name,{enumerable:!0,configurable:!0,value:e.newValue,writable:!0}):t[e.name]=e.newValue},p=function(t,e){if("__proto__"===e){if(!r.call(t,e))return;if(u)return u(t,e).value}return t[e]},G=function t(){var e,n,i,r,a,o,s=arguments[0],c=1,l=arguments.length,u=!1;for("boolean"==typeof s&&(u=s,s=arguments[1]||{},c=2),(null==s||"object"!=typeof s&&"function"!=typeof s)&&(s={});c<l;++c)if(null!=(e=arguments[c]))for(n in e)i=p(s,n),s!==(r=p(e,n))&&(u&&r&&(f(r)||(a=h(r)))?(o=a?(a=!1,i&&h(i)?i:[]):i&&f(i)?i:{},g(s,{name:n,newValue:t(u,o,r)})):void 0!==r&&g(s,{name:n,newValue:r}));return s},y={version:"0.15.0"};function Q(t){return(Q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function v(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function m(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function x(t,e,n){return e&&m(t.prototype,e),n&&m(t,n),t}function A(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function b(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&k(t,e)}function w(t){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function k(t,e){return(k=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function M(t,e,n){return(M=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&k(r,n.prototype),r}).apply(null,arguments)}function _(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function S(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?_(t):e}function N(t,e,n){return(N="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=w(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function C(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],i=!0,r=!1,a=void 0;try{for(var o,s=t[Symbol.iterator]();!(i=(o=s.next()).done)&&(n.push(o.value),!e||n.length!==e);i=!0);}catch(t){r=!0,a=t}finally{try{i||null==s.return||s.return()}finally{if(r)throw a}}return n}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function K(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function T(t){t.x=Math.ceil(t.x),t.y=Math.ceil(t.y),t.width=Math.ceil(t.width),t.height=Math.ceil(t.height)}function E(t,e){return function(t,e){var n={x:0,y:0,width:0,height:0},i={x:0,y:0,width:0,height:0};if("function"==typeof t.getBoundingClientRect){var r=t.getBoundingClientRect();n.width=r.width,n.height=r.height}else n.width=t.width||0,n.height=t.height||0;return void 0!==e.size&&(n.width=isNaN(e.size.width)?n.width:e.size.width,n.height=isNaN(e.size.height)?n.height:e.size.height),void 0!==e.logicalSize?(i.width=isNaN(e.logicalSize.width)?n.width:e.logicalSize.width,i.height=isNaN(e.logicalSize.height)?n.height:e.logicalSize.height,i.align=isNaN(e.logicalSize.align)?.5:Math.min(Math.max(e.logicalSize.align,0),1),i.preserveAspectRatio=e.logicalSize.preserveAspectRatio):(i.width=n.width,i.height=n.height,i.preserveAspectRatio=!1),T(i),T(n),[i,n]}(t,e)}function e(t){var e={logicalSize:{preserveAspectRatio:!1},center:{minWidthRatio:.5,minHeightRatio:.5,minWidth:0,minHeight:0}};return G(!0,e,t),e.center.minWidthRatio=Math.min(Math.max(e.center.minWidthRatio,0),1),e.center.minHeightRatio=Math.min(Math.max(e.center.minHeightRatio,0),1),e.center.minWidth=Math.max(e.center.minWidth,0),e.center.minHeight=Math.max(e.center.minHeight,0),e}function O(t){return"number"==typeof t&&!isNaN(t)}function j(t){return"number"!=typeof t||isNaN(t)}function P(t){for(var e=t.length,n=NaN,i=NaN,r=NaN,a=NaN,o=0;o<e;o++)n=isNaN(n)?t[o].x:Math.min(n,t[o].x),i=isNaN(i)?t[o].x:Math.max(i,t[o].x),r=isNaN(r)?t[o].y:Math.min(r,t[o].y),a=isNaN(a)?t[o].y:Math.max(a,t[o].y);return[n,r,i,a]}function F(t){return[{x:t.x1||0,y:t.y1||0},{x:t.x2||0,y:t.y2||0}]}function D(t){return[{x:t.x,y:t.y},{x:t.x+t.width,y:t.y},{x:t.x+t.width,y:t.y+t.height},{x:t.x,y:t.y+t.height}]}function L(t){var e=C(P(t),4),n=e[0],i=e[1];return{x:n,y:i,width:e[2]-n,height:e[3]-i}}function B(t){return{x1:t[0].x,y1:t[0].y,x2:t[1].x,y2:t[1].y}}function W(t){var e=t||{},n=e.x,i=e.y,r=e.width,a=e.height,o=e.x1,s=e.x2,c=e.y1,l=e.y2,u=e.cx,h=e.cy,f=e.r,d=e.vertices;return O(u)&&O(h)&&O(f)?"circle":O(o)&&O(s)&&O(c)&&O(l)?"line":O(n)&&O(i)&&O(r)&&O(a)?"rect":O(n)&&O(i)?"point":Array.isArray(d)?"polygon":null}function I(t,e,n){if(void 0===t.cachedSize){var i=t.config.requiredSize()(e,n);"object"===Q(i)?(t.cachedSize=Math.ceil(i.size),t.edgeBleed=i.edgeBleed):t.cachedSize=Math.ceil(i)}return t.cachedSize}function $(t,e){switch(e.config.dock()){case"top":t.y+=e.cachedSize,t.height-=e.cachedSize;break;case"bottom":t.height-=e.cachedSize;break;case"left":t.x+=e.cachedSize,t.width-=e.cachedSize;break;case"right":t.width-=e.cachedSize}}function V(t,e){var n=e.edgeBleed;n&&(t.left=Math.max(t.left,n.left||0),t.right=Math.max(t.right,n.right||0),t.top=Math.max(t.top,n.top||0),t.bottom=Math.max(t.bottom,n.bottom||0))}function q(t,e,n){e.x<n.left&&(e.width-=n.left-e.x,e.x=n.left);var i=t.width-(e.x+e.width);i<n.right&&(e.width-=n.right-i),e.y<n.top&&(e.height-=n.top-e.y,e.y=n.top);var r=t.height-(e.y+e.height);r<n.bottom&&(e.height-=n.bottom-r)}function U(t,e,n,i,r){var a,o,s,c,l,u=G({},e),h=G({},n);return $(u,i),V(h,i),q(t,u,h),a=t,o=u,s=r,c=Math.min(s.center.minWidth,a.width)||Math.max(a.width*s.center.minWidthRatio,1),l=Math.min(s.center.minHeight,a.height)||Math.max(a.height*s.center.minHeightRatio,1),o.width>=c&&o.height>=l&&($(e,i),V(n,i),!0)}function H(t){var e;return L((e=[]).concat.apply(e,K(t.map(D))))}function Y(t,a,o,s){var c={x:o.x,y:o.y,width:o.width,height:o.height},l={x:o.x,y:o.y,width:o.width,height:o.height},u={};t.sort(function(t,e){return/^@/.test(e.config.dock())?-1:/^@/.test(t.config.dock())?1:t.config.displayOrder()-e.config.displayOrder()}).forEach(function(t){var e={},n={},i=t.config.dock();switch(i){case"top":e.height=n.height=t.cachedSize,e.width=a.width,n.width=c.width,e.x=a.x,n.x=c.x,e.y=n.y=c.y-t.cachedSize,c.y-=t.cachedSize,c.height+=t.cachedSize;break;case"bottom":e.x=a.x,n.x=c.x,e.y=n.y=c.y+c.height,e.width=a.width,n.width=c.width,e.height=n.height=t.cachedSize,c.height+=t.cachedSize;break;case"left":e.x=n.x=l.x-t.cachedSize,e.y=a.y,n.y=l.y,e.width=n.width=t.cachedSize,e.height=a.height,n.height=l.height,l.x-=t.cachedSize,l.width+=t.cachedSize;break;case"right":e.x=n.x=l.x+l.width,e.y=a.y,n.y=l.y,e.width=n.width=t.cachedSize,e.height=a.height,n.height=l.height,l.width+=t.cachedSize;break;default:e.x=n.x=o.x,e.y=n.y=o.y,e.width=n.width=o.width,e.height=n.height=o.height}if(/^@/.test(i)){var r=i.split(",").map(function(t){return u[t.replace("@","")]}).filter(function(t){return!!t});0<r.length&&(e=H(r.map(function(t){return t.outerRect})),n=H(r.map(function(t){return t.rect})))}else t.key&&(u[t.key]={rect:n,outerRect:e});!function(t,e,n,i){var r={x:i.width/n.width,y:i.height/n.height},a={left:0,top:0};if(n.preserveAspectRatio){var o=r.x<r.y,s=Math.min(r.x,r.y);r.x=s,r.y=s;var c=o?"height":"width",l=(i[c]-n[c]*r.x)*n.align;a.left=o?0:l,a.top=o?l:0}t.scaleRatio=r,t.margin=a,e.scaleRatio=r,e.margin=a,n.scaleRatio=r,n.margin=a}(n,e,a,s),t.instance.resize(n,e,a),t.cachedSize=void 0})}function X(t){var a=[],o=[],s=e(t),i=function(){};return i.addComponent=function(t,e){var n;n=t,["resize"].forEach(function(t){if("function"!=typeof n[t])throw new Error('Component is missing required function "'.concat(t,'"'))}),i.removeComponent(t),a.push({instance:t,key:e,config:"function"==typeof t.dockConfig?t.dockConfig:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.dock,n=void 0===e?"":e,i=t.displayOrder,r=void 0===i?0:i,a=t.prioOrder,o=void 0===a?0:a,s=t.requiredSize,c=void 0===s?function(){return 0}:s,l=t.minimumLayoutMode,u=t.show,h=void 0===u||u,f=function(){};return f.requiredSize=function(t){return"function"==typeof t?(c=t,this):c},f.dock=function(t){return void 0===t?n:(n=t,this)},f.displayOrder=function(t){return void 0===t?r:(r=t,this)},f.prioOrder=function(t){return void 0===t?o:(o=t,this)},f.minimumLayoutMode=function(t){return void 0===t?l:(l=t,this)},f.show=function(t){return void 0===t?h:(h=!!t,this)},f}(t.dockConfig)})},i.removeComponent=function(t){var e=a.map(function(t){return t.instance}).indexOf(t);-1<e&&a.splice(e,1)},i.layout=function(t){var e=C(E(t,s),2),n=e[0],i=e[1];!function(t,e,n,i){for(var r=n.layoutModes||{},a=0;a<t.length;++a){var o=t[a],s=o.config.minimumLayoutMode(),c=o.config.show();c&&"object"===Q(s)?c=r[s.width]&&r[s.height]&&i.width>=r[s.width].width&&i.height>=r[s.height].height:c&&void 0!==s&&(c=r[s]&&i.width>=r[s].width&&i.height>=r[s].height),c||(t.splice(a,1),e.push(o.instance),--a)}}(a,o,s,n);var r=function(t,e,n,i){var r={x:t.x,y:t.y,width:t.width,height:t.height},a={left:0,right:0,top:0,bottom:0},o=e.slice();o.sort(function(t,e){return t.config.prioOrder()-e.config.prioOrder()});for(var s=0;s<o.length;++s){var c=o[s];I(c,r,t),U(t,r,a,c,i)||(o.splice(s,1),n.push(c.instance),--s)}var l=e.filter(function(t){return-1!==o.indexOf(t)});return e.length=0,e.push.apply(e,K(l)),q(t,r,a),r}(n,a,o,s);return Y(a,n,r,i),{visible:a.map(function(t){return t.instance}),hidden:o}},i.settings=function(t){s=e(t)},i}function Z(t){return!!t.changedTouches}var J=Math.PI,tt=2*J,et=1e-6,nt=tt-et;function t(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function it(){return new t}function rt(t){return function(){return t}}t.prototype=it.prototype={constructor:t,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,i){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+i)},bezierCurveTo:function(t,e,n,i,r,a){this._+="C"+ +t+","+ +e+","+ +n+","+ +i+","+(this._x1=+r)+","+(this._y1=+a)},arcTo:function(t,e,n,i,r){t=+t,e=+e,n=+n,i=+i,r=+r;var a=this._x1,o=this._y1,s=n-t,c=i-e,l=a-t,u=o-e,h=l*l+u*u;if(r<0)throw new Error("negative radius: "+r);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(et<h)if(Math.abs(u*s-c*l)>et&&r){var f=n-a,d=i-o,g=s*s+c*c,p=f*f+d*d,y=Math.sqrt(g),v=Math.sqrt(h),m=r*Math.tan((J-Math.acos((g+h-p)/(2*y*v)))/2),x=m/v,b=m/y;Math.abs(x-1)>et&&(this._+="L"+(t+x*l)+","+(e+x*u)),this._+="A"+r+","+r+",0,0,"+ +(l*d<u*f)+","+(this._x1=t+b*s)+","+(this._y1=e+b*c)}else this._+="L"+(this._x1=t)+","+(this._y1=e);else;},arc:function(t,e,n,i,r,a){t=+t,e=+e;var o=(n=+n)*Math.cos(i),s=n*Math.sin(i),c=t+o,l=e+s,u=1^a,h=a?i-r:r-i;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+c+","+l:(Math.abs(this._x1-c)>et||Math.abs(this._y1-l)>et)&&(this._+="L"+c+","+l),n&&(h<0&&(h=h%tt+tt),nt<h?this._+="A"+n+","+n+",0,1,"+u+","+(t-o)+","+(e-s)+"A"+n+","+n+",0,1,"+u+","+(this._x1=c)+","+(this._y1=l):et<h&&(this._+="A"+n+","+n+",0,"+ +(J<=h)+","+u+","+(this._x1=t+n*Math.cos(r))+","+(this._y1=e+n*Math.sin(r))))},rect:function(t,e,n,i){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +i+"h"+-n+"Z"},toString:function(){return this._}};var at=Math.abs,ot=Math.atan2,st=Math.cos,ct=Math.max,lt=Math.min,ut=Math.sin,ht=Math.sqrt,ft=1e-12,dt=Math.PI,gt=dt/2,pt=2*dt;function yt(t){return 1<=t?gt:t<=-1?-gt:Math.asin(t)}function vt(t){return t.innerRadius}function mt(t){return t.outerRadius}function xt(t){return t.startAngle}function bt(t){return t.endAngle}function wt(t){return t&&t.padAngle}function kt(t,e,n,i,r,a,o){var s=t-n,c=e-i,l=(o?a:-a)/ht(s*s+c*c),u=l*c,h=-l*s,f=t+u,d=e+h,g=n+u,p=i+h,y=(f+g)/2,v=(d+p)/2,m=g-f,x=p-d,b=m*m+x*x,w=r-a,k=f*p-g*d,M=(x<0?-1:1)*ht(ct(0,w*w*b-k*k)),_=(k*x-m*M)/b,S=(-k*m-x*M)/b,R=(k*x+m*M)/b,z=(-k*m+x*M)/b,N=_-y,C=S-v,A=R-y,T=z-v;return A*A+T*T<N*N+C*C&&(_=R,S=z),{cx:_,cy:S,x01:-u,y01:-h,x11:_*(r/w-1),y11:S*(r/w-1)}}function Mt(){var X=vt,Z=mt,J=rt(0),G=null,Q=xt,K=bt,tt=wt,et=null;function e(){var t,e,n,i,r,a,o,s,c,l,u,h,f=+X.apply(this,arguments),d=+Z.apply(this,arguments),g=Q.apply(this,arguments)-gt,p=K.apply(this,arguments)-gt,y=at(p-g),v=g<p;if(et||(et=t=it()),d<f&&(e=d,d=f,f=e),ft<d)if(pt-ft<y)et.moveTo(d*st(g),d*ut(g)),et.arc(0,0,d,g,p,!v),ft<f&&(et.moveTo(f*st(p),f*ut(p)),et.arc(0,0,f,p,g,v));else{var m,x,b=g,w=p,k=g,M=p,_=y,S=y,R=tt.apply(this,arguments)/2,z=ft<R&&(G?+G.apply(this,arguments):ht(f*f+d*d)),N=lt(at(d-f)/2,+J.apply(this,arguments)),C=N,A=N;if(ft<z){var T=yt(z/f*ut(R)),E=yt(z/d*ut(R));(_-=2*T)>ft?(k+=T*=v?1:-1,M-=T):(_=0,k=M=(g+p)/2),(S-=2*E)>ft?(b+=E*=v?1:-1,w-=E):(S=0,b=w=(g+p)/2)}var O=d*st(b),j=d*ut(b),P=f*st(M),F=f*ut(M);if(ft<N){var D=d*st(w),L=d*ut(w),B=f*st(k),W=f*ut(k);if(y<dt){var I=ft<_?[(i=O)+(h=((l=P-(a=D))*((r=j)-(o=L))-(u=F-o)*(i-a))/(u*(s=B-i)-l*(c=W-r)))*s,r+h*c]:[P,F],$=O-I[0],V=j-I[1],q=D-I[0],U=L-I[1],H=1/ut((1<(n=($*q+V*U)/(ht($*$+V*V)*ht(q*q+U*U)))?0:n<-1?dt:Math.acos(n))/2),Y=ht(I[0]*I[0]+I[1]*I[1]);C=lt(N,(f-Y)/(H-1)),A=lt(N,(d-Y)/(H+1))}}ft<S?ft<A?(m=kt(B,W,O,j,d,A,v),x=kt(D,L,P,F,d,A,v),et.moveTo(m.cx+m.x01,m.cy+m.y01),A<N?et.arc(m.cx,m.cy,A,ot(m.y01,m.x01),ot(x.y01,x.x01),!v):(et.arc(m.cx,m.cy,A,ot(m.y01,m.x01),ot(m.y11,m.x11),!v),et.arc(0,0,d,ot(m.cy+m.y11,m.cx+m.x11),ot(x.cy+x.y11,x.cx+x.x11),!v),et.arc(x.cx,x.cy,A,ot(x.y11,x.x11),ot(x.y01,x.x01),!v))):(et.moveTo(O,j),et.arc(0,0,d,b,w,!v)):et.moveTo(O,j),ft<f&&ft<_?ft<C?(m=kt(P,F,D,L,f,-C,v),x=kt(O,j,B,W,f,-C,v),et.lineTo(m.cx+m.x01,m.cy+m.y01),C<N?et.arc(m.cx,m.cy,C,ot(m.y01,m.x01),ot(x.y01,x.x01),!v):(et.arc(m.cx,m.cy,C,ot(m.y01,m.x01),ot(m.y11,m.x11),!v),et.arc(0,0,f,ot(m.cy+m.y11,m.cx+m.x11),ot(x.cy+x.y11,x.cx+x.x11),v),et.arc(x.cx,x.cy,C,ot(x.y11,x.x11),ot(x.y01,x.x01),!v))):et.arc(0,0,f,M,k,v):et.lineTo(P,F)}else et.moveTo(0,0);if(et.closePath(),t)return et=null,t+""||null}return e.centroid=function(){var t=(+X.apply(this,arguments)+ +Z.apply(this,arguments))/2,e=(+Q.apply(this,arguments)+ +K.apply(this,arguments))/2-dt/2;return[st(e)*t,ut(e)*t]},e.innerRadius=function(t){return arguments.length?(X="function"==typeof t?t:rt(+t),e):X},e.outerRadius=function(t){return arguments.length?(Z="function"==typeof t?t:rt(+t),e):Z},e.cornerRadius=function(t){return arguments.length?(J="function"==typeof t?t:rt(+t),e):J},e.padRadius=function(t){return arguments.length?(G=null==t?null:"function"==typeof t?t:rt(+t),e):G},e.startAngle=function(t){return arguments.length?(Q="function"==typeof t?t:rt(+t),e):Q},e.endAngle=function(t){return arguments.length?(K="function"==typeof t?t:rt(+t),e):K},e.padAngle=function(t){return arguments.length?(tt="function"==typeof t?t:rt(+t),e):tt},e.context=function(t){return arguments.length?(et=null==t?null:t,e):et},e}function _t(t){this._context=t}function St(t){return new _t(t)}function Rt(t){return t[0]}function zt(t){return t[1]}function Nt(){var u=Rt,h=null,f=rt(0),d=zt,g=rt(!0),p=null,y=St,v=null;function e(t){var e,n,i,r,a,o=t.length,s=!1,c=new Array(o),l=new Array(o);for(null==p&&(v=y(a=it())),e=0;e<=o;++e){if(!(e<o&&g(r=t[e],e,t))===s)if(s=!s)n=e,v.areaStart(),v.lineStart();else{for(v.lineEnd(),v.lineStart(),i=e-1;n<=i;--i)v.point(c[i],l[i]);v.lineEnd(),v.areaEnd()}s&&(c[e]=+u(r,e,t),l[e]=+f(r,e,t),v.point(h?+h(r,e,t):c[e],d?+d(r,e,t):l[e]))}if(a)return v=null,a+""||null}function t(){return function(){var o=Rt,s=zt,c=rt(!0),l=null,u=St,h=null;function e(t){var e,n,i,r=t.length,a=!1;for(null==l&&(h=u(i=it())),e=0;e<=r;++e)!(e<r&&c(n=t[e],e,t))===a&&((a=!a)?h.lineStart():h.lineEnd()),a&&h.point(+o(n,e,t),+s(n,e,t));if(i)return h=null,i+""||null}return e.x=function(t){return arguments.length?(o="function"==typeof t?t:rt(+t),e):o},e.y=function(t){return arguments.length?(s="function"==typeof t?t:rt(+t),e):s},e.defined=function(t){return arguments.length?(c="function"==typeof t?t:rt(!!t),e):c},e.curve=function(t){return arguments.length?(u=t,null!=l&&(h=u(l)),e):u},e.context=function(t){return arguments.length?(null==t?l=h=null:h=u(l=t),e):l},e}().defined(g).curve(y).context(p)}return e.x=function(t){return arguments.length?(u="function"==typeof t?t:rt(+t),h=null,e):u},e.x0=function(t){return arguments.length?(u="function"==typeof t?t:rt(+t),e):u},e.x1=function(t){return arguments.length?(h=null==t?null:"function"==typeof t?t:rt(+t),e):h},e.y=function(t){return arguments.length?(f="function"==typeof t?t:rt(+t),d=null,e):f},e.y0=function(t){return arguments.length?(f="function"==typeof t?t:rt(+t),e):f},e.y1=function(t){return arguments.length?(d=null==t?null:"function"==typeof t?t:rt(+t),e):d},e.lineX0=e.lineY0=function(){return t().x(u).y(f)},e.lineY1=function(){return t().x(u).y(d)},e.lineX1=function(){return t().x(h).y(f)},e.defined=function(t){return arguments.length?(g="function"==typeof t?t:rt(!!t),e):g},e.curve=function(t){return arguments.length?(y=t,null!=p&&(v=y(p)),e):y},e.context=function(t){return arguments.length?(null==t?p=v=null:v=y(p=t),e):p},e}function Ct(t,e){return e<t?-1:t<e?1:t<=e?0:NaN}function At(t){return t}_t.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var Tt=Array.prototype.slice;function Et(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Ot(t){this._context=t}function jt(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Pt(t,e){this._context=t,this._k=(1-e)/6}Ot.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Et(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Et(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Pt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:jt(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:jt(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Ft=function e(n){function t(t){return new Pt(t,n)}return t.tension=function(t){return e(+t)},t}(0);function Dt(t,e){this._context=t,this._alpha=e}Dt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:!function(t,e,n){var i=t._x1,r=t._y1,a=t._x2,o=t._y2;if(t._l01_a>ft){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,r=(r*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>ft){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,u=3*t._l23_a*(t._l23_a+t._l12_a);a=(a*l+t._x1*t._l23_2a-e*t._l12_2a)/u,o=(o*l+t._y1*t._l23_2a-n*t._l12_2a)/u}t._context.bezierCurveTo(i,r,a,o,t._x2,t._y2)}(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Lt=function e(n){function t(t){return n?new Dt(t,n):new Pt(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function Bt(t){return t<0?-1:1}function Wt(t,e,n){var i=t._x1-t._x0,r=e-t._x1,a=(t._y1-t._y0)/(i||r<0&&-0),o=(n-t._y1)/(r||i<0&&-0),s=(a*r+o*i)/(i+r);return(Bt(a)+Bt(o))*Math.min(Math.abs(a),Math.abs(o),.5*Math.abs(s))||0}function It(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function $t(t,e,n){var i=t._x0,r=t._y0,a=t._x1,o=t._y1,s=(a-i)/3;t._context.bezierCurveTo(i+s,r+s*e,a-s,o-s*n,a,o)}function Vt(t){this._context=t}function qt(t){this._context=new Ut(t)}function Ut(t){this._context=t}function Ht(t){this._context=t}function Yt(t){var e,n,i=t.length-1,r=new Array(i),a=new Array(i),o=new Array(i);for(a[r[0]=0]=2,o[0]=t[0]+2*t[1],e=1;e<i-1;++e)r[e]=1,a[e]=4,o[e]=4*t[e]+2*t[e+1];for(r[i-1]=2,a[i-1]=7,o[i-1]=8*t[i-1]+t[i],e=1;e<i;++e)n=r[e]/a[e-1],a[e]-=n,o[e]-=n*o[e-1];for(r[i-1]=o[i-1]/a[i-1],e=i-2;0<=e;--e)r[e]=(o[e]-r[e+1])/a[e];for(a[i-1]=(t[i]+r[i-1])/2,e=0;e<i-1;++e)a[e]=2*t[e+1]-r[e+1];return[r,a]}function Xt(t,e){this._context=t,this._t=e}function Zt(t,e){if(1<(r=t.length))for(var n,i,r,a=1,o=t[e[0]],s=o.length;a<r;++a)for(i=o,o=t[e[a]],n=0;n<s;++n)o[n][1]+=o[n][0]=isNaN(i[n][1])?i[n][0]:i[n][1]}function Jt(t){for(var e=t.length,n=new Array(e);0<=--e;)n[e]=e;return n}function Gt(t,e){return t[e]}function Qt(t){for(var e,n=0,i=-1,r=t.length;++i<r;)(e=+t[i][1])&&(n+=e);return n}function Kt(t){var n,i={},e=t||{get:function(){},has:function(){return!1},default:function(){}};function r(t,e){if(!t||"string"!=typeof t)throw new TypeError("Invalid argument: key must be a non-empty string");return!(t in i)&&(i[t]=e,!0)}function a(t){return i[t]||e.get(t)}function o(t,e){return void 0!==e?r(t,e):a(t||n)}return n=e.default(),o.add=r,o.get=a,o.has=function(t){return!!i[t]||e.has(t)},o.remove=function(t){var e=i[t];return delete i[t],e},o.getKeys=function(){return Object.keys(i)},o.getValues=function(){return Object.keys(i).map(function(t){return i[t]})},o.default=function(t){return void 0!==t&&(n=t),n},o.register=r,o}function te(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,i=t.slice(0,n);return[1<i.length?i[0]+i.slice(2):i,+t.slice(n+1)]}function ee(t){return(t=te(Math.abs(t)))?t[1]:NaN}Vt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:$t(this,this._t0,It(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,$t(this,It(this,n=Wt(this,t,e)),n);break;default:$t(this,this._t0,n=Wt(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(qt.prototype=Object.create(Vt.prototype)).point=function(t,e){Vt.prototype.point.call(this,e,t)},Ut.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,i,r,a){this._context.bezierCurveTo(e,t,i,n,a,r)}},Ht.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var i=Yt(t),r=Yt(e),a=0,o=1;o<n;++a,++o)this._context.bezierCurveTo(i[0][a],r[0][a],i[1][a],r[1][a],t[o],e[o]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},Xt.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),0<=this._line&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var ne,ie=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function re(t){return new ae(t)}function ae(t){if(!(e=ie.exec(t)))throw new Error("invalid format: "+t);var e;this.fill=e[1]||" ",this.align=e[2]||">",this.sign=e[3]||"-",this.symbol=e[4]||"",this.zero=!!e[5],this.width=e[6]&&+e[6],this.comma=!!e[7],this.precision=e[8]&&+e[8].slice(1),this.trim=!!e[9],this.type=e[10]||""}function oe(t,e){var n=te(t,e);if(!n)return t+"";var i=n[0],r=n[1];return r<0?"0."+new Array(-r).join("0")+i:i.length>r+1?i.slice(0,r+1)+"."+i.slice(r+1):i+new Array(r-i.length+2).join("0")}re.prototype=ae.prototype,ae.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(null==this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(null==this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var se={"%":function(t,e){return(100*t).toFixed(e)},b:function(t){return Math.round(t).toString(2)},c:function(t){return t+""},d:function(t){return Math.round(t).toString(10)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},g:function(t,e){return t.toPrecision(e)},o:function(t){return Math.round(t).toString(8)},p:function(t,e){return oe(100*t,e)},r:oe,s:function(t,e){var n=te(t,e);if(!n)return t+"";var i=n[0],r=n[1],a=r-(ne=3*Math.max(-8,Math.min(8,Math.floor(r/3))))+1,o=i.length;return a===o?i:o<a?i+new Array(a-o+1).join("0"):0<a?i.slice(0,a)+"."+i.slice(a):"0."+new Array(1-a).join("0")+te(t,Math.max(0,e+a-1))[0]},X:function(t){return Math.round(t).toString(16).toUpperCase()},x:function(t){return Math.round(t).toString(16)}};function ce(t){return t}var le,ue,he,fe=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function de(t){var e,s,c,k=t.grouping&&t.thousands?(s=t.grouping,c=t.thousands,function(t,e){for(var n=t.length,i=[],r=0,a=s[0],o=0;0<n&&0<a&&(e<o+a+1&&(a=Math.max(1,e-o)),i.push(t.substring(n-=a,n+a)),!((o+=a+1)>e));)a=s[r=(r+1)%s.length];return i.reverse().join(c)}):ce,i=t.currency,M=t.decimal,_=t.numerals?(e=t.numerals,function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}):ce,r=t.percent||"%";function o(t){var l=(t=re(t)).fill,u=t.align,h=t.sign,e=t.symbol,f=t.zero,d=t.width,g=t.comma,p=t.precision,y=t.trim,v=t.type;"n"===v?(g=!0,v="g"):se[v]||(null==p&&(p=12),y=!0,v="g"),(f||"0"===l&&"="===u)&&(f=!0,l="0",u="=");var m="$"===e?i[0]:"#"===e&&/[boxX]/.test(v)?"0"+v.toLowerCase():"",x="$"===e?i[1]:/[%p]/.test(v)?r:"",b=se[v],w=/[defgprs%]/.test(v);function n(t){var e,n,i,r=m,a=x;if("c"===v)a=b(t)+a,t="";else{var o=(t=+t)<0;if(t=b(Math.abs(t),p),y&&(t=function(t){t:for(var e,n=t.length,i=1,r=-1;i<n;++i)switch(t[i]){case".":r=e=i;break;case"0":0===r&&(r=i),e=i;break;default:if(0<r){if(!+t[i])break t;r=0}}return 0<r?t.slice(0,r)+t.slice(e+1):t}(t)),o&&0==+t&&(o=!1),r=(o?"("===h?h:"-":"-"===h||"("===h?"":h)+r,a=("s"===v?fe[8+ne/3]:"")+a+(o&&"("===h?")":""),w)for(e=-1,n=t.length;++e<n;)if((i=t.charCodeAt(e))<48||57<i){a=(46===i?M+t.slice(e+1):t.slice(e))+a,t=t.slice(0,e);break}}g&&!f&&(t=k(t,1/0));var s=r.length+t.length+a.length,c=s<d?new Array(d-s+1).join(l):"";switch(g&&f&&(t=k(c+t,c.length?d-a.length:1/0),c=""),u){case"<":t=r+t+a+c;break;case"=":t=r+c+t+a;break;case"^":t=c.slice(0,s=c.length>>1)+r+t+a+c.slice(s);break;default:t=c+r+t+a}return _(t)}return p=null==p?6:/[gprs]/.test(v)?Math.max(1,Math.min(21,p)):Math.max(0,Math.min(20,p)),n.toString=function(){return t+""},n}return{format:o,formatPrefix:function(t,e){var n=o(((t=re(t)).type="f",t)),i=3*Math.max(-8,Math.min(8,Math.floor(ee(e)/3))),r=Math.pow(10,-i),a=fe[8+i/3];return function(t){return n(r*t)+a}}}}le=de({decimal:".",thousands:",",grouping:[3],currency:["$",""]}),ue=le.format,he=le.formatPrefix;var ge=new Date,pe=new Date;function ye(a,o,n,i){function s(t){return a(t=new Date(+t)),t}return(s.floor=s).ceil=function(t){return a(t=new Date(t-1)),o(t,1),a(t),t},s.round=function(t){var e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=function(t,e){return o(t=new Date(+t),null==e?1:Math.floor(e)),t},s.range=function(t,e,n){var i,r=[];if(t=s.ceil(t),n=null==n?1:Math.floor(n),!(t<e&&0<n))return r;for(;r.push(i=new Date(+t)),o(t,n),a(t),i<t&&t<e;);return r},s.filter=function(n){return ye(function(t){if(t<=t)for(;a(t),!n(t);)t.setTime(t-1)},function(t,e){if(t<=t)if(e<0)for(;++e<=0;)for(;o(t,-1),!n(t););else for(;0<=--e;)for(;o(t,1),!n(t););})},n&&(s.count=function(t,e){return ge.setTime(+t),pe.setTime(+e),a(ge),a(pe),Math.floor(n(ge,pe))},s.every=function(e){return e=Math.floor(e),isFinite(e)&&0<e?1<e?s.filter(i?function(t){return i(t)%e==0}:function(t){return s.count(0,t)%e==0}):s:null}),s}var ve=ye(function(){},function(t,e){t.setTime(+t+e)},function(t,e){return e-t});ve.every=function(n){return n=Math.floor(n),isFinite(n)&&0<n?1<n?ye(function(t){t.setTime(Math.floor(t/n)*n)},function(t,e){t.setTime(+t+e*n)},function(t,e){return(e-t)/n}):ve:null};ve.range;var me=6e4,xe=36e5,be=(ye(function(t){t.setTime(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(+t+1e3*e)},function(t,e){return(e-t)/1e3},function(t){return t.getUTCSeconds()}).range,ye(function(t){t.setTime(Math.floor(t/me)*me)},function(t,e){t.setTime(+t+e*me)},function(t,e){return(e-t)/me},function(t){return t.getMinutes()}).range,ye(function(t){var e=t.getTimezoneOffset()*me%xe;e<0&&(e+=xe),t.setTime(Math.floor((+t-e)/xe)*xe+e)},function(t,e){t.setTime(+t+e*xe)},function(t,e){return(e-t)/xe},function(t){return t.getHours()}).range,ye(function(t){t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*me)/864e5},function(t){return t.getDate()-1}));be.range;function we(e){return ye(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,e){t.setDate(t.getDate()+7*e)},function(t,e){return(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*me)/6048e5})}var ke=we(0),Me=we(1),_e=(we(2),we(3),we(4)),Se=(we(5),we(6),ke.range,Me.range,_e.range,ye(function(t){t.setDate(1),t.setHours(0,0,0,0)},function(t,e){t.setMonth(t.getMonth()+e)},function(t,e){return e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())},function(t){return t.getMonth()}).range,ye(function(t){t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t,e){return e.getFullYear()-t.getFullYear()},function(t){return t.getFullYear()}));Se.every=function(n){return isFinite(n=Math.floor(n))&&0<n?ye(function(t){t.setFullYear(Math.floor(t.getFullYear()/n)*n),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,e){t.setFullYear(t.getFullYear()+e*n)}):null};Se.range,ye(function(t){t.setUTCSeconds(0,0)},function(t,e){t.setTime(+t+e*me)},function(t,e){return(e-t)/me},function(t){return t.getUTCMinutes()}).range,ye(function(t){t.setUTCMinutes(0,0,0)},function(t,e){t.setTime(+t+e*xe)},function(t,e){return(e-t)/xe},function(t){return t.getUTCHours()}).range;var Re=ye(function(t){t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+e)},function(t,e){return(e-t)/864e5},function(t){return t.getUTCDate()-1});Re.range;function ze(e){return ye(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCDate(t.getUTCDate()+7*e)},function(t,e){return(e-t)/6048e5})}var Ne=ze(0),Ce=ze(1),Ae=(ze(2),ze(3),ze(4)),Te=(ze(5),ze(6),Ne.range,Ce.range,Ae.range,ye(function(t){t.setUTCDate(1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCMonth(t.getUTCMonth()+e)},function(t,e){return e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())},function(t){return t.getUTCMonth()}).range,ye(function(t){t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e)},function(t,e){return e.getUTCFullYear()-t.getUTCFullYear()},function(t){return t.getUTCFullYear()}));Te.every=function(n){return isFinite(n=Math.floor(n))&&0<n?ye(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/n)*n),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,e){t.setUTCFullYear(t.getUTCFullYear()+e*n)}):null};Te.range;function Ee(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function Oe(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function je(t){return{y:t,m:0,d:1,H:0,M:0,S:0,L:0}}function Pe(t){var i=t.dateTime,r=t.date,a=t.time,e=t.periods,n=t.days,o=t.shortDays,s=t.months,c=t.shortMonths,l=Ue(e),u=He(e),h=Ue(n),f=He(n),d=Ue(o),g=He(o),p=Ue(s),y=He(s),v=Ue(c),m=He(c),x={a:function(t){return o[t.getDay()]},A:function(t){return n[t.getDay()]},b:function(t){return c[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:dn,e:dn,f:mn,H:gn,I:pn,j:yn,L:vn,m:xn,M:bn,p:function(t){return e[+(12<=t.getHours())]},Q:Xn,s:Zn,S:wn,u:kn,U:Mn,V:_n,w:Sn,W:Rn,x:null,X:null,y:zn,Y:Nn,Z:Cn,"%":Yn},b={a:function(t){return o[t.getUTCDay()]},A:function(t){return n[t.getUTCDay()]},b:function(t){return c[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:An,e:An,f:Pn,H:Tn,I:En,j:On,L:jn,m:Fn,M:Dn,p:function(t){return e[+(12<=t.getUTCHours())]},Q:Xn,s:Zn,S:Ln,u:Bn,U:Wn,V:In,w:$n,W:Vn,x:null,X:null,y:qn,Y:Un,Z:Hn,"%":Yn},w={a:function(t,e,n){var i=d.exec(e.slice(n));return i?(t.w=g[i[0].toLowerCase()],n+i[0].length):-1},A:function(t,e,n){var i=h.exec(e.slice(n));return i?(t.w=f[i[0].toLowerCase()],n+i[0].length):-1},b:function(t,e,n){var i=v.exec(e.slice(n));return i?(t.m=m[i[0].toLowerCase()],n+i[0].length):-1},B:function(t,e,n){var i=p.exec(e.slice(n));return i?(t.m=y[i[0].toLowerCase()],n+i[0].length):-1},c:function(t,e,n){return _(t,i,e,n)},d:nn,e:nn,f:ln,H:an,I:an,j:rn,L:cn,m:en,M:on,p:function(t,e,n){var i=l.exec(e.slice(n));return i?(t.p=u[i[0].toLowerCase()],n+i[0].length):-1},Q:hn,s:fn,S:sn,u:Xe,U:Ze,V:Je,w:Ye,W:Ge,x:function(t,e,n){return _(t,r,e,n)},X:function(t,e,n){return _(t,a,e,n)},y:Ke,Y:Qe,Z:tn,"%":un};function k(c,l){return function(t){var e,n,i,r=[],a=-1,o=0,s=c.length;for(t instanceof Date||(t=new Date(+t));++a<s;)37===c.charCodeAt(a)&&(r.push(c.slice(o,a)),null!=(n=Be[e=c.charAt(++a)])?e=c.charAt(++a):n="e"===e?" ":"0",(i=l[e])&&(e=i(t,n)),r.push(e),o=a+1);return r.push(c.slice(o,a)),r.join("")}}function M(r,a){return function(t){var e,n,i=je(1900);if(_(i,r,t+="",0)!=t.length)return null;if("Q"in i)return new Date(i.Q);if("p"in i&&(i.H=i.H%12+12*i.p),"V"in i){if(i.V<1||53<i.V)return null;"w"in i||(i.w=1),i.d="Z"in i?(e=4<(n=(e=Oe(je(i.y))).getUTCDay())||0===n?Ce.ceil(e):Ce(e),e=Re.offset(e,7*(i.V-1)),i.y=e.getUTCFullYear(),i.m=e.getUTCMonth(),e.getUTCDate()+(i.w+6)%7):(e=4<(n=(e=a(je(i.y))).getDay())||0===n?Me.ceil(e):Me(e),e=be.offset(e,7*(i.V-1)),i.y=e.getFullYear(),i.m=e.getMonth(),e.getDate()+(i.w+6)%7)}else("W"in i||"U"in i)&&("w"in i||(i.w="u"in i?i.u%7:"W"in i?1:0),n="Z"in i?Oe(je(i.y)).getUTCDay():a(je(i.y)).getDay(),i.m=0,i.d="W"in i?(i.w+6)%7+7*i.W-(n+5)%7:i.w+7*i.U-(n+6)%7);return"Z"in i?(i.H+=i.Z/100|0,i.M+=i.Z%100,Oe(i)):a(i)}}function _(t,e,n,i){for(var r,a,o=0,s=e.length,c=n.length;o<s;){if(c<=i)return-1;if(37===(r=e.charCodeAt(o++))){if(r=e.charAt(o++),!(a=w[r in Be?e.charAt(o++):r])||(i=a(t,n,i))<0)return-1}else if(r!=n.charCodeAt(i++))return-1}return i}return x.x=k(r,x),x.X=k(a,x),x.c=k(i,x),b.x=k(r,b),b.X=k(a,b),b.c=k(i,b),{format:function(t){var e=k(t+="",x);return e.toString=function(){return t},e},parse:function(t){var e=M(t+="",Ee);return e.toString=function(){return t},e},utcFormat:function(t){var e=k(t+="",b);return e.toString=function(){return t},e},utcParse:function(t){var e=M(t,Oe);return e.toString=function(){return t},e}}}var Fe,De,Le,Be={"-":"",_:" ",0:"0"},We=/^\s*\d+/,Ie=/^%/,$e=/[\\^$*+?|[\]().{}]/g;function Ve(t,e,n){var i=t<0?"-":"",r=(i?-t:t)+"",a=r.length;return i+(a<n?new Array(n-a+1).join(e)+r:r)}function qe(t){return t.replace($e,"\\$&")}function Ue(t){return new RegExp("^(?:"+t.map(qe).join("|")+")","i")}function He(t){for(var e={},n=-1,i=t.length;++n<i;)e[t[n].toLowerCase()]=n;return e}function Ye(t,e,n){var i=We.exec(e.slice(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function Xe(t,e,n){var i=We.exec(e.slice(n,n+1));return i?(t.u=+i[0],n+i[0].length):-1}function Ze(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.U=+i[0],n+i[0].length):-1}function Je(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.V=+i[0],n+i[0].length):-1}function Ge(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.W=+i[0],n+i[0].length):-1}function Qe(t,e,n){var i=We.exec(e.slice(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Ke(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.y=+i[0]+(68<+i[0]?1900:2e3),n+i[0].length):-1}function tn(t,e,n){var i=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return i?(t.Z=i[1]?0:-(i[2]+(i[3]||"00")),n+i[0].length):-1}function en(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function nn(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function rn(t,e,n){var i=We.exec(e.slice(n,n+3));return i?(t.m=0,t.d=+i[0],n+i[0].length):-1}function an(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function on(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function sn(t,e,n){var i=We.exec(e.slice(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function cn(t,e,n){var i=We.exec(e.slice(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function ln(t,e,n){var i=We.exec(e.slice(n,n+6));return i?(t.L=Math.floor(i[0]/1e3),n+i[0].length):-1}function un(t,e,n){var i=Ie.exec(e.slice(n,n+1));return i?n+i[0].length:-1}function hn(t,e,n){var i=We.exec(e.slice(n));return i?(t.Q=+i[0],n+i[0].length):-1}function fn(t,e,n){var i=We.exec(e.slice(n));return i?(t.Q=1e3*+i[0],n+i[0].length):-1}function dn(t,e){return Ve(t.getDate(),e,2)}function gn(t,e){return Ve(t.getHours(),e,2)}function pn(t,e){return Ve(t.getHours()%12||12,e,2)}function yn(t,e){return Ve(1+be.count(Se(t),t),e,3)}function vn(t,e){return Ve(t.getMilliseconds(),e,3)}function mn(t,e){return vn(t,e)+"000"}function xn(t,e){return Ve(t.getMonth()+1,e,2)}function bn(t,e){return Ve(t.getMinutes(),e,2)}function wn(t,e){return Ve(t.getSeconds(),e,2)}function kn(t){var e=t.getDay();return 0===e?7:e}function Mn(t,e){return Ve(ke.count(Se(t),t),e,2)}function _n(t,e){var n=t.getDay();return t=4<=n||0===n?_e(t):_e.ceil(t),Ve(_e.count(Se(t),t)+(4===Se(t).getDay()),e,2)}function Sn(t){return t.getDay()}function Rn(t,e){return Ve(Me.count(Se(t),t),e,2)}function zn(t,e){return Ve(t.getFullYear()%100,e,2)}function Nn(t,e){return Ve(t.getFullYear()%1e4,e,4)}function Cn(t){var e=t.getTimezoneOffset();return(0<e?"-":(e*=-1,"+"))+Ve(e/60|0,"0",2)+Ve(e%60,"0",2)}function An(t,e){return Ve(t.getUTCDate(),e,2)}function Tn(t,e){return Ve(t.getUTCHours(),e,2)}function En(t,e){return Ve(t.getUTCHours()%12||12,e,2)}function On(t,e){return Ve(1+Re.count(Te(t),t),e,3)}function jn(t,e){return Ve(t.getUTCMilliseconds(),e,3)}function Pn(t,e){return jn(t,e)+"000"}function Fn(t,e){return Ve(t.getUTCMonth()+1,e,2)}function Dn(t,e){return Ve(t.getUTCMinutes(),e,2)}function Ln(t,e){return Ve(t.getUTCSeconds(),e,2)}function Bn(t){var e=t.getUTCDay();return 0===e?7:e}function Wn(t,e){return Ve(Ne.count(Te(t),t),e,2)}function In(t,e){var n=t.getUTCDay();return t=4<=n||0===n?Ae(t):Ae.ceil(t),Ve(Ae.count(Te(t),t)+(4===Te(t).getUTCDay()),e,2)}function $n(t){return t.getUTCDay()}function Vn(t,e){return Ve(Ce.count(Te(t),t),e,2)}function qn(t,e){return Ve(t.getUTCFullYear()%100,e,2)}function Un(t,e){return Ve(t.getUTCFullYear()%1e4,e,4)}function Hn(){return"+0000"}function Yn(){return"%"}function Xn(t){return+t}function Zn(t){return Math.floor(+t/1e3)}Fe=Pe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),Fe.format,Fe.parse,De=Fe.utcFormat,Le=Fe.utcParse;var Jn="%Y-%m-%dT%H:%M:%S.%LZ";Date.prototype.toISOString||De(Jn);+new Date("2000-01-01T00:00:00.000Z")||Le(Jn);var Gn=Kt();Gn("d3-number",function(e,r,a){var o,n;function t(t){return n(t)}function s(){t.locale({decimal:a||".",thousands:r||",",grouping:[3],currency:["$",""]})}return t.locale=function(t){return o=de(t),n=o.format(e),this},s(),t.format=function(t,e,n,i){return(n||i)&&(r=n,a=i,s()),o.format(t)(e)},t.pattern=function(t){return t&&(e=t,n=o.format(t)),e},t}),Gn("d3-time",function(t){var n=Pe({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),e=n.format(t);function i(t){return e(t)}return i.format=function(t,e){return n.format(t)(e)},i.locale=function(){return n=Pe.apply(void 0,arguments),e=n.format(t),this},i.parse=function(t,e){return n.parse(t)(e)},i.parsePattern=function(t){return n.parse(t)},i});var Qn={id:function(t){return"".concat(t.source,"/").concat(t.key||t.title)},key:function(t){return String(t.key||t.title)},tags:function(t){return t.tags},min:function(t){return t.min},max:function(t){return t.max},type:function(t){return t.type},title:function(t){return String(t.title)},values:function(t){return t.values},value:function(t){return t},label:function(t){return t},formatter:function(t){return function(t){if("function"==typeof t.formatter)return t.formatter();var e=t.formatter||{};return Gn(e.type||"d3-number")(e.format||"")}(t)}};function Kn(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=e.id,i=void 0===n?Qn.id:n,r=e.key,a=void 0===r?Qn.key:r,o=e.min,s=void 0===o?Qn.min:o,c=e.max,l=void 0===c?Qn.max:c,u=e.type,h=void 0===u?Qn.type:u,f=e.tags,d=void 0===f?Qn.tags:f,g=e.title,p=void 0===g?Qn.title:g,y=e.values,v=void 0===y?Qn.values:y,m=e.value,x=void 0===m?Qn.value:m,b=e.label,w=void 0===b?Qn.label:b,k=e.formatter,M=void 0===k?Qn.formatter:k;return{id:function(){return i(t)},key:function(){return a(t)},raw:function(){return t},tags:function(){return d(t)},type:function(){return h(t)},min:function(){return s(t)},max:function(){return l(t)},title:function(){return p(t)},items:function(){return v(t)},formatter:function(){return M(t)},value:x,label:w}}var ti={diverging:function(t,e){if(1<(s=t.length))for(var n,i,r,a,o,s,c=0,l=t[e[0]].length;c<l;++c)for(a=o=0,n=0;n<s;++n)0<=(r=(i=t[e[n]][c])[1]-i[0])?(i[0]=a,i[1]=a+=r):i[0]=r<0?(i[1]=o,o+=r):a},none:Zt,silhouette:function(t,e){if(0<(n=t.length)){for(var n,i=0,r=t[e[0]],a=r.length;i<a;++i){for(var o=0,s=0;o<n;++o)s+=t[o][i][1]||0;r[i][1]+=r[i][0]=-s/2}Zt(t,e)}},expand:function(t,e){if(0<(i=t.length)){for(var n,i,r,a=0,o=t[0].length;a<o;++a){for(r=n=0;n<i;++n)r+=t[n][a][1]||0;if(r)for(n=0;n<i;++n)t[n][a][1]/=r}Zt(t,e)}},wiggle:function(t,e){if(0<(r=t.length)&&0<(i=(n=t[e[0]]).length)){for(var n,i,r,a=0,o=1;o<i;++o){for(var s=0,c=0,l=0;s<r;++s){for(var u=t[e[s]],h=u[o][1]||0,f=(h-(u[o-1][1]||0))/2,d=0;d<s;++d){var g=t[e[d]];f+=(g[o][1]||0)-(g[o-1][1]||0)}c+=h,l+=f*h}n[o-1][1]+=n[o-1][0]=a,c&&(a-=l/c)}n[o-1][1]+=n[o-1][0]=a,Zt(t,e)}}},ei={ascending:function(t){var n=t.map(Qt);return Jt(t).sort(function(t,e){return n[t]-n[e]})},insideout:function(t){var e,n,i=t.length,r=t.map(Qt),a=Jt(t).sort(function(t,e){return r[e]-r[t]}),o=0,s=0,c=[],l=[];for(e=0;e<i;++e)n=a[e],o<s?(o+=r[n],c.push(n)):(s+=r[n],l.push(n));return l.reverse().concat(c)},none:Jt,reverse:function(t){return Jt(t).reverse()}};function ni(t,e,n){for(var i={},r=e.stackKey,a=e.value,o=e.startProp||"start",s=e.endProp||"end",c=e.offset||"none",l=e.order||"none",u=e.valueRef||"",h=0,f={},d=0;d<t.items.length;d++){var g=t.items[d],p=u?g[u]:null;if(p&&p.source){var y="".concat(p.source.key||"","/").concat(p.source.field);f[y]||(f[y]=p.source)}var v=r(g);i[v]=i[v]||{items:[]},i[v].items.push(g),h=Math.max(h,i[v].items.length)}for(var m=Array.apply(null,{length:h}).map(Number.call,Number),x=Object.keys(i).map(function(t){return i[t].items}),b=function(){var h=rt([]),f=Jt,d=Zt,g=Gt;function e(t){var e,n,i=h.apply(this,arguments),r=t.length,a=i.length,o=new Array(a);for(e=0;e<a;++e){for(var s,c=i[e],l=o[e]=new Array(r),u=0;u<r;++u)l[u]=s=[0,+g(t[u],c,u,t)],s.data=t[u];l.key=c}for(e=0,n=f(o);e<a;++e)o[n[e]].index=e;return d(o,n),o}return e.keys=function(t){return arguments.length?(h="function"==typeof t?t:rt(Tt.call(t)),e):h},e.value=function(t){return arguments.length?(g="function"==typeof t?t:rt(+t),e):g},e.order=function(t){return arguments.length?(f=null==t?Jt:"function"==typeof t?t:rt(Tt.call(t)),e):f},e.offset=function(t){return arguments.length?(d=null==t?Zt:t,e):d},e}().keys(m).value(function(t,e){return t[e]?a(t[e]):0}).order(ei[l]).offset(ti[c])(x),w=[],k=0;k<b.length;k++)for(var M=b[k],_=0;_<M.length;_++){var S=M[_],R=M[_].data[M.key];R&&(R[o]={value:S[0]},R[s]={value:S[1]},w.push(S[0],S[1]))}var z=Object.keys(f).map(function(t){var e=n(f[t].key);return e?e.field(f[t].field):null}).filter(function(t){return!!t}),N=Kn({title:z.map(function(t){return t.title()}).join(", "),min:Math.min.apply(Math,w),max:Math.max.apply(Math,w),type:"measure",formatter:z[0]?z[0].formatter:void 0});t.fields.push(N)}function ii(e){var i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},t=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r={},n=t.logger;if(Array.isArray(e))r.items=e.map(function(t){return{value:t,label:String(t)}});else if(e){if("collection"in e)return i.collection(e.collection);var a=i.dataset?i.dataset(e.source):null,o=e.value||function(t){return t},s=e.label||function(t){return t};if(e.groupBy||e.mapTo)n.warn('Deprecated "data" configuration',e),r.items=[];else if(e.hierarchy)r.root=a.hierarchy?a.hierarchy(e.hierarchy):null,r.fields=a.fields();else if(e.items)r.items=e.items.map(function(t){return{value:o(t),label:String(s(t))}});else if(e.extract){var c=Array.isArray(e.extract)?e.extract:[e.extract];r.items=[];var l,u=[];if(c.forEach(function(t){var e,n=t.source?i.dataset(t.source):a;n&&((e=r.items).push.apply(e,K(n.extract(t))),void 0!==t.field&&u.push(n.field(t.field)))}),u.length&&(r.fields=u),e.amend&&Array.isArray(e.amend))(l=r.items).push.apply(l,K(e.amend))}else if(void 0!==e.field&&a){var h=a.field(e.field);h&&(r.fields||(r.fields=[]),r.fields.push(h),"value"in e||(o=h.value||function(t){return t},s=h.label||function(t){return t},r.value=o),r.items=h.items().map(function(t){return{value:o(t),label:String(s(t)),source:{field:e.field}}}))}else e.fields&&e.fields.forEach(function(t){var e,n="object"===Q(t)&&t.source?i.dataset(t.source):a;n&&((e="object"===Q(t)&&void 0!==t.field?n.field(t.field):n.field(t))&&(r.fields||(r.fields=[]),r.fields.push(e)))});r.items&&e.map&&(r.items=r.items.map(e.map))}return e&&e.stack&&ni(r,e.stack,i.dataset),e&&!Array.isArray(e)&&"function"==typeof e.sort&&r.items&&(r.items=r.items.sort(e.sort)),r}function ri(t,e,n){var i,r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ii;if(t.data){var a=r(t.data,e,n);if(a&&a.fields&&a.fields[0])return a.fields[0].formatter()}if(i=t.formatter?"".concat(t.formatter,"-").concat(t.type||"number"):t.type||"d3-number",n.formatter.has(i))return n.formatter.get(i)(t.format||"");throw new Error("Formatter of type '".concat(i,"' was not found"))}function ai(t,e){return t<e?-1:e<t?1:e<=t?0:NaN}var oi,si,ci=(1===(oi=ai).length&&(si=oi,oi=function(t,e){return ai(si(t),e)}),{left:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;oi(t[r],e)<0?n=r+1:i=r}return n},right:function(t,e,n,i){for(null==n&&(n=0),null==i&&(i=t.length);n<i;){var r=n+i>>>1;0<oi(t[r],e)?i=r:n=r+1}return n}}).right;var li=Math.sqrt(50),ui=Math.sqrt(10),hi=Math.sqrt(2);function fi(t,e,n){var i=(e-t)/Math.max(0,n),r=Math.floor(Math.log(i)/Math.LN10),a=i/Math.pow(10,r);return 0<=r?(li<=a?10:ui<=a?5:hi<=a?2:1)*Math.pow(10,r):-Math.pow(10,-r)/(li<=a?10:ui<=a?5:hi<=a?2:1)}var di="$";function gi(){}function pi(t,e){var n=new gi;if(t instanceof gi)t.each(function(t,e){n.set(e,t)});else if(Array.isArray(t)){var i,r=-1,a=t.length;if(null==e)for(;++r<a;)n.set(r,t[r]);else for(;++r<a;)n.set(e(i=t[r],r,t),i)}else if(t)for(var o in t)n.set(o,t[o]);return n}function yi(){}gi.prototype=pi.prototype={constructor:gi,has:function(t){return di+t in this},get:function(t){return this[di+t]},set:function(t,e){return this[di+t]=e,this},remove:function(t){var e=di+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===di&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===di&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===di&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===di&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===di&&++t;return t},empty:function(){for(var t in this)if(t[0]===di)return!1;return!0},each:function(t){for(var e in this)e[0]===di&&t(this[e],e.slice(1),this)}};var vi=pi.prototype;yi.prototype=function(t,e){var n=new yi;if(t instanceof yi)t.each(function(t){n.add(t)});else if(t){var i=-1,r=t.length;if(null==e)for(;++i<r;)n.add(t[i]);else for(;++i<r;)n.add(e(t[i],i,t))}return n}.prototype={constructor:yi,has:vi.has,add:function(t){return this[di+(t+="")]=t,this},remove:vi.remove,clear:vi.clear,values:vi.keys,size:vi.size,empty:vi.empty,each:vi.each};var mi=Array.prototype,xi=mi.map,bi=mi.slice,wi={name:"implicit"};function ki(i){var a=pi(),o=[],r=wi;function s(t){var e=t+"",n=a.get(e);if(!n){if(r!==wi)return r;a.set(e,n=o.push(t))}return i[(n-1)%i.length]}return i=null==i?[]:bi.call(i),s.domain=function(t){if(!arguments.length)return o.slice();o=[],a=pi();for(var e,n,i=-1,r=t.length;++i<r;)a.has(n=(e=t[i])+"")||a.set(n,o.push(e));return s},s.range=function(t){return arguments.length?(i=bi.call(t),s):i.slice()},s.unknown=function(t){return arguments.length?(r=t,s):r},s.copy=function(){return ki().domain(o).range(i).unknown(r)},s}function Mi(){var a,o,t=ki().unknown(void 0),s=t.domain,c=t.range,l=[0,1],u=!1,h=0,f=0,d=.5;function e(){var t=s().length,e=l[1]<l[0],n=l[e-0],i=l[1-e];a=(i-n)/Math.max(1,t-h+2*f),u&&(a=Math.floor(a)),n+=(i-n-a*(t-h))*d,o=a*(1-h),u&&(n=Math.round(n),o=Math.round(o));var r=function(t,e,n){t=+t,e=+e,n=(r=arguments.length)<2?(e=t,t=0,1):r<3?1:+n;for(var i=-1,r=0|Math.max(0,Math.ceil((e-t)/n)),a=new Array(r);++i<r;)a[i]=t+i*n;return a}(t).map(function(t){return n+a*t});return c(e?r.reverse():r)}return delete t.unknown,t.domain=function(t){return arguments.length?(s(t),e()):s()},t.range=function(t){return arguments.length?(l=[+t[0],+t[1]],e()):l.slice()},t.rangeRound=function(t){return l=[+t[0],+t[1]],u=!0,e()},t.bandwidth=function(){return o},t.step=function(){return a},t.round=function(t){return arguments.length?(u=!!t,e()):u},t.padding=function(t){return arguments.length?(h=f=Math.max(0,Math.min(1,t)),e()):h},t.paddingInner=function(t){return arguments.length?(h=Math.max(0,Math.min(1,t)),e()):h},t.paddingOuter=function(t){return arguments.length?(f=Math.max(0,Math.min(1,t)),e()):f},t.align=function(t){return arguments.length?(d=Math.max(0,Math.min(1,t)),e()):d},t.copy=function(){return Mi().domain(s()).range(l).round(u).paddingInner(h).paddingOuter(f).align(d)},e()}function _i(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Si(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Ri(){}var zi=1/.7,Ni="\\s*([+-]?\\d+)\\s*",Ci="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",Ai="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Ti=/^#([0-9a-f]{3})$/,Ei=/^#([0-9a-f]{6})$/,Oi=new RegExp("^rgb\\("+[Ni,Ni,Ni]+"\\)$"),ji=new RegExp("^rgb\\("+[Ai,Ai,Ai]+"\\)$"),Pi=new RegExp("^rgba\\("+[Ni,Ni,Ni,Ci]+"\\)$"),Fi=new RegExp("^rgba\\("+[Ai,Ai,Ai,Ci]+"\\)$"),Di=new RegExp("^hsl\\("+[Ci,Ai,Ai]+"\\)$"),Li=new RegExp("^hsla\\("+[Ci,Ai,Ai,Ci]+"\\)$"),Bi={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function Wi(t){var e;return t=(t+"").trim().toLowerCase(),(e=Ti.exec(t))?new Ui((e=parseInt(e[1],16))>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):(e=Ei.exec(t))?Ii(parseInt(e[1],16)):(e=Oi.exec(t))?new Ui(e[1],e[2],e[3],1):(e=ji.exec(t))?new Ui(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=Pi.exec(t))?$i(e[1],e[2],e[3],e[4]):(e=Fi.exec(t))?$i(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=Di.exec(t))?Yi(e[1],e[2]/100,e[3]/100,1):(e=Li.exec(t))?Yi(e[1],e[2]/100,e[3]/100,e[4]):Bi.hasOwnProperty(t)?Ii(Bi[t]):"transparent"===t?new Ui(NaN,NaN,NaN,0):null}function Ii(t){return new Ui(t>>16&255,t>>8&255,255&t,1)}function $i(t,e,n,i){return i<=0&&(t=e=n=NaN),new Ui(t,e,n,i)}function Vi(t){return t instanceof Ri||(t=Wi(t)),t?new Ui((t=t.rgb()).r,t.g,t.b,t.opacity):new Ui}function qi(t,e,n,i){return 1===arguments.length?Vi(t):new Ui(t,e,n,null==i?1:i)}function Ui(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}function Hi(t){return((t=Math.max(0,Math.min(255,Math.round(t)||0)))<16?"0":"")+t.toString(16)}function Yi(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||1<=n?t=e=NaN:e<=0&&(t=NaN),new Xi(t,e,n,i)}function Xi(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function Zi(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}_i(Ri,Wi,{displayable:function(){return this.rgb().displayable()},hex:function(){return this.rgb().hex()},toString:function(){return this.rgb()+""}}),_i(Ui,qi,Si(Ri,{brighter:function(t){return t=null==t?zi:Math.pow(zi,t),new Ui(this.r*t,this.g*t,this.b*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Ui(this.r*t,this.g*t,this.b*t,this.opacity)},rgb:function(){return this},displayable:function(){return 0<=this.r&&this.r<=255&&0<=this.g&&this.g<=255&&0<=this.b&&this.b<=255&&0<=this.opacity&&this.opacity<=1},hex:function(){return"#"+Hi(this.r)+Hi(this.g)+Hi(this.b)},toString:function(){var t=this.opacity;return(1===(t=isNaN(t)?1:Math.max(0,Math.min(1,t)))?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(1===t?")":", "+t+")")}})),_i(Xi,function(t,e,n,i){return 1===arguments.length?function(t){if(t instanceof Xi)return new Xi(t.h,t.s,t.l,t.opacity);if(t instanceof Ri||(t=Wi(t)),!t)return new Xi;if(t instanceof Xi)return t;var e=(t=t.rgb()).r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),a=Math.max(e,n,i),o=NaN,s=a-r,c=(a+r)/2;return s?(o=e===a?(n-i)/s+6*(n<i):n===a?(i-e)/s+2:(e-n)/s+4,s/=c<.5?a+r:2-a-r,o*=60):s=0<c&&c<1?0:o,new Xi(o,s,c,t.opacity)}(t):new Xi(t,e,n,null==i?1:i)},Si(Ri,{brighter:function(t){return t=null==t?zi:Math.pow(zi,t),new Xi(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new Xi(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new Ui(Zi(240<=t?t-240:t+120,r,i),Zi(t,r,i),Zi(t<120?t+240:t-120,r,i),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1}}));var Ji=Math.PI/180,Gi=180/Math.PI,Qi=.96422,Ki=1,tr=.82521,er=4/29,nr=6/29,ir=3*nr*nr,rr=nr*nr*nr;function ar(t){if(t instanceof or)return new or(t.l,t.a,t.b,t.opacity);if(t instanceof hr){if(isNaN(t.h))return new or(t.l,0,0,t.opacity);var e=t.h*Ji;return new or(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}t instanceof Ui||(t=Vi(t));var n,i,r=ur(t.r),a=ur(t.g),o=ur(t.b),s=sr((.2225045*r+.7168786*a+.0606169*o)/Ki);return r===a&&a===o?n=i=s:(n=sr((.4360747*r+.3850649*a+.1430804*o)/Qi),i=sr((.0139322*r+.0971045*a+.7141733*o)/tr)),new or(116*s-16,500*(n-s),200*(s-i),t.opacity)}function or(t,e,n,i){this.l=+t,this.a=+e,this.b=+n,this.opacity=+i}function sr(t){return rr<t?Math.pow(t,1/3):t/ir+er}function cr(t){return nr<t?t*t*t:ir*(t-er)}function lr(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function ur(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function hr(t,e,n,i){this.h=+t,this.c=+e,this.l=+n,this.opacity=+i}_i(or,function(t,e,n,i){return 1===arguments.length?ar(t):new or(t,e,n,null==i?1:i)},Si(Ri,{brighter:function(t){return new or(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker:function(t){return new or(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb:function(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new Ui(lr(3.1338561*(e=Qi*cr(e))-1.6168667*(t=Ki*cr(t))-.4906146*(n=tr*cr(n))),lr(-.9787684*e+1.9161415*t+.033454*n),lr(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),_i(hr,function(t,e,n,i){return 1===arguments.length?function(t){if(t instanceof hr)return new hr(t.h,t.c,t.l,t.opacity);if(t instanceof or||(t=ar(t)),0===t.a&&0===t.b)return new hr(NaN,0,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Gi;return new hr(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new hr(t,e,n,null==i?1:i)},Si(Ri,{brighter:function(t){return new hr(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker:function(t){return new hr(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb:function(){return ar(this).rgb()}}));var fr=1.78277,dr=-.29227,gr=-.90649,pr=1.97294,yr=pr*gr,vr=pr*fr,mr=fr*dr- -.14861*gr;function xr(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}function br(t){return function(){return t}}function wr(a){return 1==(a=+a)?kr:function(t,e){return e-t?(n=t,i=e,r=a,n=Math.pow(n,r),i=Math.pow(i,r)-n,r=1/r,function(t){return Math.pow(n+t*i,r)}):br(isNaN(t)?e:t);var n,i,r}}function kr(t,e){var n,i,r=e-t;return r?(n=t,i=r,function(t){return n+t*i}):br(isNaN(t)?e:t)}_i(xr,function(t,e,n,i){return 1===arguments.length?function(t){if(t instanceof xr)return new xr(t.h,t.s,t.l,t.opacity);t instanceof Ui||(t=Vi(t));var e=t.r/255,n=t.g/255,i=t.b/255,r=(mr*i+yr*e-vr*n)/(mr+yr-vr),a=i-r,o=(pr*(n-r)-dr*a)/gr,s=Math.sqrt(o*o+a*a)/(pr*r*(1-r)),c=s?Math.atan2(o,a)*Gi-120:NaN;return new xr(c<0?c+360:c,s,r,t.opacity)}(t):new xr(t,e,n,null==i?1:i)},Si(Ri,{brighter:function(t){return t=null==t?zi:Math.pow(zi,t),new xr(this.h,this.s,this.l*t,this.opacity)},darker:function(t){return t=null==t?.7:Math.pow(.7,t),new xr(this.h,this.s,this.l*t,this.opacity)},rgb:function(){var t=isNaN(this.h)?0:(this.h+120)*Ji,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),i=Math.cos(t),r=Math.sin(t);return new Ui(255*(e+n*(-.14861*i+fr*r)),255*(e+n*(dr*i+gr*r)),255*(e+n*(pr*i)),this.opacity)}}));var Mr=function t(e){var o=wr(e);function n(e,t){var n=o((e=qi(e)).r,(t=qi(t)).r),i=o(e.g,t.g),r=o(e.b,t.b),a=kr(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=i(t),e.b=r(t),e.opacity=a(t),e+""}}return n.gamma=t,n}(1);function _r(e,n){return n-=e=+e,function(t){return e+n*t}}function Sr(t,e){var n,i={},r={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?i[n]=Nr(t[n],e[n]):r[n]=e[n];return function(t){for(n in i)r[n]=i[n](t);return r}}var Rr=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zr=new RegExp(Rr.source,"g");function Nr(t,e){var n,i=typeof e;return null==e||"boolean"===i?br(e):("number"===i?_r:"string"===i?(n=Wi(e))?(e=n,Mr):function(t,i){var e,n,r,a,o,s=Rr.lastIndex=zr.lastIndex=0,c=-1,l=[],u=[];for(t+="",i+="";(e=Rr.exec(t))&&(n=zr.exec(i));)(r=n.index)>s&&(r=i.slice(s,r),l[c]?l[c]+=r:l[++c]=r),(e=e[0])===(n=n[0])?l[c]?l[c]+=n:l[++c]=n:(l[++c]=null,u.push({i:c,x:_r(e,n)})),s=zr.lastIndex;return s<i.length&&(r=i.slice(s),l[c]?l[c]+=r:l[++c]=r),l.length<2?u[0]?(o=u[0].x,function(t){return o(t)+""}):(a=i,function(){return a}):(i=u.length,function(t){for(var e,n=0;n<i;++n)l[(e=u[n]).i]=e.x(t);return l.join("")})}:e instanceof Wi?Mr:e instanceof Date?function(e,n){var i=new Date;return n-=e=+e,function(t){return i.setTime(e+n*t),i}}:Array.isArray(e)?function(t,e){var n,i=e?e.length:0,r=t?Math.min(i,t.length):0,a=new Array(r),o=new Array(i);for(n=0;n<r;++n)a[n]=Nr(t[n],e[n]);for(;n<i;++n)o[n]=e[n];return function(t){for(n=0;n<r;++n)o[n]=a[n](t);return o}}:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?Sr:_r)(t,e)}function Cr(e,n){return n-=e=+e,function(t){return Math.round(e+n*t)}}Math.PI,Math.SQRT2;function Ar(t){return+t}var Tr=[0,1];function Er(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:(t=n,function(){return t});var t}function Or(t,e,n,i){var r=t[0],a=t[1],o=e[0],s=e[1];return o=a<r?(r=n(a,r),i(s,o)):(r=n(r,a),i(o,s)),function(t){return o(r(t))}}function jr(n,t,e,i){var r=Math.min(n.length,t.length)-1,a=new Array(r),o=new Array(r),s=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++s<r;)a[s]=e(n[s],n[s+1]),o[s]=i(t[s],t[s+1]);return function(t){var e=ci(n,t,1,r)-1;return o[e](a[e](t))}}function Pr(t,e,n){var i,r,a,o,s,c,l,u,h,f,d,g,p=t[0],y=t[t.length-1],v=(r=p,a=y,o=null==e?10:e,s=Math.abs(a-r)/Math.max(0,o),c=Math.pow(10,Math.floor(Math.log(s)/Math.LN10)),li<=(l=s/c)?c*=10:ui<=l?c*=5:hi<=l&&(c*=2),a<r?-c:c);switch((n=re(null==n?",f":n)).type){case"s":var m=Math.max(Math.abs(p),Math.abs(y));return null!=n.precision||isNaN((d=v,g=m,i=Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(ee(g)/3)))-ee(Math.abs(d)))))||(n.precision=i),he(n,m);case"":case"e":case"g":case"p":case"r":null!=n.precision||isNaN((h=v,f=Math.max(Math.abs(p),Math.abs(y)),h=Math.abs(h),f=Math.abs(f)-h,i=Math.max(0,ee(f)-ee(h))+1))||(n.precision=i-("e"===n.type));break;case"f":case"%":null!=n.precision||isNaN((u=v,i=Math.max(0,-ee(Math.abs(u)))))||(n.precision=i-2*("%"===n.type))}return ue(n)}function Fr(s){var c=s.domain;return s.ticks=function(t){var e=c();return function(t,e,n){var i,r,a,o,s=-1;if(n=+n,(t=+t)==(e=+e)&&0<n)return[t];if((i=e<t)&&(r=t,t=e,e=r),0===(o=fi(t,e,n))||!isFinite(o))return[];if(0<o)for(t=Math.ceil(t/o),e=Math.floor(e/o),a=new Array(r=Math.ceil(e-t+1));++s<r;)a[s]=(t+s)*o;else for(t=Math.floor(t*o),e=Math.ceil(e*o),a=new Array(r=Math.ceil(t-e+1));++s<r;)a[s]=(t-s)/o;return i&&a.reverse(),a}(e[0],e[e.length-1],null==t?10:t)},s.tickFormat=function(t,e){return Pr(c(),t,e)},s.nice=function(t){null==t&&(t=10);var e,n=c(),i=0,r=n.length-1,a=n[i],o=n[r];return o<a&&(e=a,a=o,o=e,e=i,i=r,r=e),0<(e=fi(a,o,t))?e=fi(a=Math.floor(a/e)*e,o=Math.ceil(o/e)*e,t):e<0&&(e=fi(a=Math.ceil(a*e)/e,o=Math.floor(o*e)/e,t)),0<e?(n[i]=Math.floor(a/e)*e,n[r]=Math.ceil(o/e)*e,c(n)):e<0&&(n[i]=Math.ceil(a*e)/e,n[r]=Math.floor(o*e)/e,c(n)),s},s}function Dr(){var e=function(e,n){var i,a,o,s=Tr,c=Tr,l=Nr,u=!1;function r(){return i=2<Math.min(s.length,c.length)?jr:Or,a=o=null,t}function t(t){return(a||(a=i(s,c,u?(r=e,function(e,n){var i=r(e=+e,n=+n);return function(t){return t<=e?0:n<=t?1:i(t)}}):e,l)))(+t);var r}return t.invert=function(t){return(o||(o=i(c,s,Er,u?(r=n,function(e,n){var i=r(e=+e,n=+n);return function(t){return t<=0?e:1<=t?n:i(t)}}):n)))(+t);var r},t.domain=function(t){return arguments.length?(s=xi.call(t,Ar),r()):s.slice()},t.range=function(t){return arguments.length?(c=bi.call(t),r()):c.slice()},t.rangeRound=function(t){return c=bi.call(t),l=Cr,r()},t.clamp=function(t){return arguments.length?(u=!!t,r()):u},t.interpolate=function(t){return arguments.length?(l=t,r()):l},r()}(Er,_r);return e.copy=function(){return t=e,Dr().domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp());var t},Fr(e)}function Lr(e){return void 0===e?function(t){return t}:function(t){return e(t)}}function Br(t){return Math.max(0,Math.min(1,t))}function Wr(t){return"object"===Q(t)}function Ir(t,e,n){for(var i=Math.abs(e-n)/(t+1),r=[],a=1;a<=t;a++){var o=a*i;r.push(e<n?e+o:e-o)}return r}function $r(t,e,n){if(1===t.length)return t;for(var i=t.concat([]),r=0;r<t.length;r++){var a=t[r],o=t[r+1];0===r&&a!==n.start()?(i.push.apply(i,K(Ir(e,a,o))),a-=o-a,o=t[r]):r===t.length-1&&o!==n.end()&&(o=a+(a-t[r-1])),i.push.apply(i,K(Ir(e,a,o)))}return i.filter(function(t){return t>=n.min()&&t<=n.max()})}function Vr(t){var e=t.distance,i=t.scale,n=t.minorCount,r=void 0===n?0:n,a=t.unitDivider,o=void 0===a?100:a,s=t.formatter,c=void 0===s?void 0:s,l=j(o)||j(e)?2:Math.max(e/o,2),u=Math.min(1e3,Math.round(l)),h=i.ticks(u);h.length<=1&&(h=i.ticks(u+1));var f=0<r?$r(h,r,i):h;f.sort(function(t,e){return t-e});var d=f.map(Lr(c));return f.map(function(t,e){var n=i(t);return{position:n,start:n,end:n,label:d[e],value:t,isMinor:-1===h.indexOf(t)}})}function qr(t){var e=t.distance,i=t.scale,n=t.minorCount,r=void 0===n?0:n,a=t.unitDivider,o=void 0===a?100:a,s=t.formatter,c=void 0===s?void 0:s,l=j(o)||j(e)?2:Math.max(e/o,2),u=Math.min(1e3,Math.round(l)),h=10<u?10:u;i.nice(h);var f=i.ticks(u),d=0<r?$r(f,r,i):f;d.sort(function(t,e){return t-e});var g=d.map(Lr(c));return d.map(function(t,e){var n=i(t);return{position:n,start:n,end:n,label:g[e],value:t,isMinor:-1===f.indexOf(t)}})}function Ur(t){var e,n,i,r,a,o,s,c,l,u,h,f=t.settings,d=t.scale,g=t.distance,p=t.formatter,y=f.minorTicks&&!j(f.minorTicks.count)?Math.min(100,f.minorTicks.count):0;if(Array.isArray(f.ticks.values)){var v=f.ticks.values.filter(function(t){return"object"===Q(t)?!j(t.value):!j(t)});s={values:v,scale:d.copy(),formatter:p},c=s.values,l=s.scale,u=s.formatter,h=void 0===u?function(t){return t}:u,e=c.sort(function(t,e){return(Wr(t)?t.value:t)-(Wr(e)?e.value:e)}).filter(function(t,e,n){var i=Wr(t)?t.value:t;return i<=l.max()&&i>=l.min()&&n.indexOf(t)===e}).map(function(t){var e=Wr(t)?t.value:t,n=l(e);return{position:n,value:e,label:Wr(t)&&void 0!==t.label?t.label:h(e),isMinor:!1,start:Wr(t)&&!isNaN(t.start)?Br(l(t.start)):n,end:Wr(t)&&!isNaN(t.end)?Br(l(t.end)):n}})}else if(j(f.ticks.count)){e=(f.ticks.tight?qr:Vr)({distance:g,minorCount:y,unitDivider:f.ticks.distance,scale:d,formatter:p}),f.ticks.forceBounds&&function(t,e,n){var i=t.map(function(t){return t.position}),r=e.range();-1===i.indexOf(r[0])?t.splice(0,0,{position:r[0],start:r[0],end:r[0],label:n(e.start()),isMinor:!1,value:e.start()}):t[0]&&t[0].isMinor&&(t[0].isMinor=!1);var a=t[t.length-1];-1===i.indexOf(r[1])?t.push({position:r[1],start:r[1],end:r[1],label:n(e.end()),isMinor:!1,value:e.end()}):a&&a.isMinor&&(a.isMinor=!1)}(e,d,p)}else{var m=Math.min(1e3,f.ticks.count);n={count:m,minorCount:y,scale:d.copy(),formatter:p},i=n.count,r=n.minorCount,a=n.scale,o=n.formatter,e=a.ticks((i-1)*r+i).map(function(t,e){var n=a(t);return{position:n,start:n,end:n,label:o(t),isMinor:e%(r+1)!=0,value:t}})}return e}function Hr(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a={};return Object.keys(i).forEach(function(t){var e=Q(n[t]);a[t]="function"===e?n[t](r):"undefined"===e?i[t]:n[t]}),a}var Yr={min:NaN,max:NaN,expand:NaN,include:[],invert:!1},Xr={tight:!1,forceBounds:!1,values:void 0,count:NaN,distance:100},Zr={count:NaN};function Jr(t,e){t.instance||(t.instance=e.copy(),t.instance.domain([e.start(),e.end()]),t.instance.clamp(!0),t.instance.range(t.invert?[1,0]:[0,1]))}function Gr(){var e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},a=Dr(),o={instance:null,invert:!1},t={data:i,resources:r},s=Hr(n,Yr,t);function l(t){return j(t)?NaN:a(t)}s.ticks=Hr(n.ticks,Xr,t),s.minorTicks=Hr(n.minorTicks,Zr,t),l.data=function(){return i},l.invert=function(t){return a.invert(t)},l.rangeRound=function(t){return a.rangeRound(t),l},l.clamp=function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return a.clamp(t),l},l.cachedTicks=function(){return e},l.clearTicksCache=function(){return e=void 0,this},l.ticks=function(t){return e=null!==t&&"object"===Q(t)?(t.settings=t.settings||{},t.settings=G(!0,{},s,t.settings),t.scale=l,Ur(t)):a.ticks(t)},l.nice=function(t){return a.nice(t),l},l.tickFormat=function(t,e){return a.tickFormat(t,e)},l.interpolate=function(t){return a.interpolate(t),l},l.domain=function(t){return arguments.length?(a.domain(t),o.instance&&o.instance.domain([l.start(),l.end()]),l):a.domain()},l.range=function(t){return arguments.length?(a.range(t),l):a.range()},l.start=function(){return l.domain()[0]},l.end=function(){return l.domain()[this.domain().length-1]},l.min=function(){return Math.min(this.start(),this.end())},l.max=function(){return Math.max(this.start(),this.end())},l.classify=function(t){for(var e=(l.start()-l.end())/t,n=[l.end()],i=[],r=e/2,a=0;a<t;a++){var o=n[n.length-1]||0,s=o+e,c=l(o+r);n.push.apply(n,[s,s]),i.push.apply(i,[c,c])}return n.pop(),l.domain(n),l.range(i),l},l.copy=function(){var t=Gr(n,i,r);return t.domain(l.domain()),t.range(l.range()),t.clamp(a.clamp()),t},l.norm=function(t){return Jr(o,l),o.instance(t)},l.normInvert=function(t){return Jr(o,l),o.instance.invert(t)};var c=function(t,e){var n=+t.min,i=+t.max,r=0,a=1;if(e&&e[0]){var o=e.map(function(t){return t.min()}).filter(function(t){return!isNaN(t)}),s=e.map(function(t){return t.max()}).filter(function(t){return!isNaN(t)});if(r=o.length?Math.min.apply(Math,K(o)):Number.NaN,a=s.length?Math.max.apply(Math,K(s)):Number.NaN,isNaN(r)||isNaN(a))r=-1,a=1;else if(r===a&&0===r)r=-1,a=1;else if(r===a&&r)r-=Math.abs(.1*r),a+=Math.abs(.1*a);else if(!isNaN(t.expand)){var c=a-r;r-=c*t.expand,a+=c*t.expand}if(Array.isArray(t.include)){var l=t.include.filter(function(t){return!isNaN(t)});r=Math.min.apply(Math,K(l).concat([r])),a=Math.max.apply(Math,K(l).concat([a]))}}return{mini:isNaN(n)?r:n,maxi:isNaN(i)?a:i}}(s,i?i.fields:[]),u=c.mini,h=c.maxi;return l.domain([u,h]),l.range(s.invert?[1,0]:[0,1]),o.invert=s.invert,l}var Qr={padding:0,paddingInner:NaN,paddingOuter:NaN,align:.5,invert:!1,maxPxStep:NaN,range:[0,1]};function Kr(){var s=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},e=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},c=Mi(),n={data:t,resources:e},l=Hr(s,Qr,n),i=t.items||[],r={},a=[],o=[];function u(s,c){s.data=function(){return t},s.datum=function(t){return i[r[t]]},s.start=function(){return s.domain()[0]},s.end=function(){return s.domain()[s.domain().length-1]},s.labels=function(){return o},s.ticks=function(){var t,i,e,r,a,o,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return n.scale=s,t=n,c.trackBy,i=t.scale,e=i.domain(),r=i.data().items,a=i.labels?i.labels():e,o=i.bandwidth(),e.map(function(t,e){var n=i(t);return{position:n+o/2,label:"".concat(a[e]),data:r?r[e]:void 0,start:n,end:n+o}})}}u(c,s),c.pxScale=function(t){var e=l.maxPxStep;if(isNaN(e))return c;var n=c.domain().length,i=Math.max(1,n-c.paddingInner()+2*c.paddingOuter());if(t<=i*e)return c;var r=c.copy();r.type=c.type,u(r,s);var a=i*e/t,o=(1-a)*c.align();return r.range(l.invert?[a+o,o]:[o,a+o]),r};for(var h="function"==typeof s.value?s.value:function(t){return t.datum.value},f="function"==typeof s.label?s.label:function(t){return t.datum.label},d=0;d<i.length;d++){var g=G({datum:i[d]},n),p=h(g,d);-1===a.indexOf(p)&&(a.push(p),o.push(f(g,d)),r[p]=d)}return c.domain(a),c.range(l.invert?l.range.slice().reverse():l.range),c.padding(isNaN(l.padding)?0:l.padding),isNaN(l.paddingInner)||c.paddingInner(l.paddingInner),isNaN(l.paddingOuter)||c.paddingOuter(l.paddingOuter),c.align(isNaN(l.align)?.5:l.align),c}var ta={depth:0};function ea(t,e,n){return t.ancestors().map(function(t){return e(G({datum:t.data},n))}).reverse().slice(1).toString()}var na=function(t){return t.min()},ia=function(t){return t.max()};function ra(t,e){var n=t&&!isNaN(t.min),i=t&&!isNaN(t.max),r=n?+t.min:0,a=i?+t.max:1;if(e&&e.length){if(!n){var o=e.map(na).filter(O);r=o.length?Math.min.apply(Math,K(o)):r}if(!i){var s=e.map(ia).filter(O);a=s.length?Math.max.apply(Math,K(s)):a}}return[r,a]}var aa={domain:[],range:[],invert:!1,min:NaN,max:NaN};function oa(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=Gr(t,e,n).clamp(!0).interpolate(Mr),r=Hr(t,aa,{data:e,resources:n}),a=Array.isArray(r.domain)&&r.domain.length,o=Array.isArray(r.range)&&r.range.length,s=i;G(!0,s,i);var c=C(ra(r,e?e.fields:[]),2),l=c[0],u=c[1],h=a?r.domain.length:-1,f=n.theme?n.theme.palette("sequential",0<h?h:2):[],d=o?r.range:f;return s.range(r.invert?d.slice().reverse():d.slice()),s.domain(a?r.domain:function(t,e,n){var i=t.length;if(2===i)return[e,n];var r=[],a=(n-e)/(i-1);r.push(e);for(var o=1;o<i-1;o++)r.push(e+a*o);return r.push(n),r}(s.range(),l,u)),s}var sa={domain:[],range:[],invert:!1,min:NaN,max:NaN,nice:!1};var ca={domain:[],range:[]};var la={domain:[],range:[],unknown:void 0},ua={domain:[],range:[],override:!1};var ha=Kt();function fa(t,e,n){var i=t.data;t.source&&(n.logger.warn("Deprecated: Scale data source configuration"),i={extract:[]},(Array.isArray(t.source)?t.source:[t.source]).forEach(function(t){i.extract.push({field:t})}));var r,a,o=ii(i,e,n),s=t.type||((r=o).root?"h-band":r.fields&&r.fields[0]?-1!==r.fields.map(function(t){return"dimension"===t.type()?"band":"linear"}).indexOf("linear")?"linear":"band":"linear");return"color"===s&&(s=o.fields&&o.fields[0]&&"dimension"===o.fields[0].type()?"categorical-color":"sequential-color"),n.scale.has(s)&&((a=(a=n.scale.get(s))(t,o,{theme:n.theme,logger:n.logger})).type=s),a}ha("linear",Gr),ha("band",Kr),ha("h-band",function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r={data:n,resources:i},a=Hr(e,Qr,r);a.ticks=Hr(e.ticks,ta,r),a.value="function"==typeof e.value?e.value:function(t){return t.datum.value},a.label="function"==typeof e.label?e.label:function(t){return t.datum.value};var o=Kr(a),s=function(t,e,s){var c=e.ticks.depth,l=e.value,u=e.label,h=[],f=[],d={},g=[],p=0;if(!t)return{values:h,labels:f,items:d,ticks:g};t.eachAfter(function(t){if(0<t.depth){var e=ea(t,l,s),n=t.leaves()||[t],i=l(G({datum:t.data},s)),r=u(G({datum:t.data},s)),a=Array.isArray(t.children),o={key:e,count:n.length,value:i,label:r,leftEdge:ea(n[0],l,s),rightEdge:ea(n[Math.max(n.length-1,0)],l,s),node:t};a?(h.push("SPACER_".concat(p,"_SPACER")),p++):(h.push(e),f.push(r)),(c<=0&&!a||t.depth===c)&&g.push(o),d[e]=o}});var n=t.height-1;return 0<n&&h.splice(-n),{values:h,labels:f,items:d,ticks:g}}(n.root,a,r),c=s.values,l=s.labels,u=s.items,h=s.ticks,f=function(t){var e=String(t),n=u[e];return o(n?a.invert?n.rightEdge:n.leftEdge:e)};G(!0,f,o),f.bandwidth=function(t){var e=u[String(t)],n=o.bandwidth();if(!e||e.isLeaf)return n;var i=f(e.leftEdge),r=f(e.rightEdge);return Math.abs(i-r)+n},f.step=function(t){var e=u[String(t)],n=e?e.count:1,i=o.step();return i*=n},f.data=function(){return n},f.datum=function(t){var e=u[String(t)];return e?e.node.data:null},f.copy=function(){return t(e,n,i)},f.labels=function(){return l},f.ticks=function(){return h.map(function(t){var e=f(t.key),n=f.bandwidth(t.key);return{position:e+n/2,label:t.label,data:t.node.data,start:e,end:e+n}})};var d=o.pxScale;return f.pxScale=function(t){return o=d(t),f},f.domain(c),f}),ha("sequential-color",oa),ha("threshold-color",function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=function t(){var n=[.5],i=[0,1],e=1;function r(t){if(t<=t)return i[ci(n,t,0,e)]}return r.domain=function(t){return arguments.length?(n=bi.call(t),e=Math.min(n.length,i.length-1),r):n.slice()},r.range=function(t){return arguments.length?(i=bi.call(t),e=Math.min(n.length,i.length-1),r):i.slice()},r.invertExtent=function(t){var e=i.indexOf(t);return[n[e-1],n[e]]},r.copy=function(){return t().domain(n).range(i)},r}(),r=Hr(t,sa,{data:e,resources:n}),a=Array.isArray(r.domain)&&r.domain.length,o=Array.isArray(r.range)&&r.range.length;function s(t){return j(t)?NaN:i(t)}Object.keys(i).forEach(function(t){return s[t]=i[t]});var c=C(ra(r,e.fields),2),l=c[0],u=c[1],h=a?r.domain.length:-1,f=n.theme?n.theme.palette("sequential",0<h?h:2):[],d=o?r.range:f,g=[];return g=a?r.domain:r.nice?function(t,e,n){var i=2===t.length?10:Math.max(1,t.length),r=Dr().domain([e,n]).nice(i).ticks(i);if(!t||!t.length)return r;for(var a=Math.max(0,t.length-1);r.length>a;)r[0]-e<=n-r[r.length-1]?r.shift():r.pop();return r}(d,l,u):[l+(u-l)/2],d.length>g.length+1?g=function(t,e,n){var i=t.length;if(2===i)return[e+(n-e)/2];for(var r=[],a=(n-e)/i,o=1;o<i;o++)r.push(e+a*o);return r}(d,l,u):d.length<g.length+1&&(d=function(t,e,n,i){n=t[0],i=t&&2<=t.length?t[t.length-1]:i;var r=oa().domain([n,i]).range(e);return[n].concat(K(function(t){for(var e=[],n=0;n<t.length-1;n++)e.push((t[n]+t[n+1])/2);return e}(t)),[i]).map(function(t){return r(t)})}(g,d,l,u)),s.data=function(){return e},s.range(r.invert?d.slice().reverse():d),s.domain(g),s}),ha("categorical-color",function(){var n,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},r=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=ki(),r={data:e,resources:n},a=Hr(t,ca,r),o="function"==typeof t.value?t.value:function(t){return t.datum.value},s="function"==typeof t.label?t.label:function(t){return t.datum.label},c=e.items||[],l={},u=[],h=[],f=0;f<c.length;f++){var d=G({datum:c[f]},r),g=o(d,f);-1===u.indexOf(g)&&(u.push(g),h.push(s(d,f)),l[g]=f)}return i.data=function(){return e},i.labels=function(){return h},i.label=function(t){return h[u.indexOf(t)]},i.datum=function(t){return c[l[t]]},i.range(a.range),Array.isArray(a.domain)&&a.domain.length?i.domain(a.domain):i.domain(u),i}(t,e,i),a=i.theme,o=Hr(t,la,{data:e,resources:i});if(o.explicit=Hr(t.explicit,ua,{data:e,resources:i}),n=Array.isArray(o.range)&&0!==o.range.length?o.range.slice():a?a.palette("categorical",r.domain().length).slice():[],o.unknown)r.unknown(o.unknown);else if(a&&a.palette("unknown")){var s=a.palette("unknown");r.unknown(s[0])}if(Array.isArray(o.explicit.domain)&&o.explicit.domain.length){for(var c=r.domain().slice(),l=o.explicit.domain,u=Array.isArray(o.explicit.range)?o.explicit.range:[],h=Math.floor(c.length/n.length),f=1;f<h+1;f*=2)n=n.concat(n);if(o.explicit.override)for(var d=0;d<l.length;d++){var g=c.indexOf(l[d]);-1<g&&(n[g]=u[d])}else l.map(function(t,e){return[c.indexOf(t),t,u[e]]}).sort(function(t,e){return t[0]-e[0]}).forEach(function(t){var e=c.indexOf(t[1]);-1!==e&&n.splice(e,0,t[2])});n.length=c.length}return r.range(n),r});var da={};function ga(){ga.init.call(this)}da.isObject=function(t){return"object"==typeof t&&null!==t},da.isNumber=function(t){return"number"==typeof t},da.isUndefined=function(t){return void 0===t},da.isFunction=function(t){return"function"==typeof t};var pa=ga;(ga.EventEmitter=ga).prototype._events=void 0,ga.prototype._maxListeners=void 0,ga.defaultMaxListeners=10,ga.init=function(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0},ga.prototype.setMaxListeners=function(t){if(!da.isNumber(t)||t<0||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},ga.prototype.emit=function(t){var e,n,i,r,a,o;if(this._events||(this._events={}),"error"===t&&!this._events.error)throw(e=arguments[1])instanceof Error?e:Error('Uncaught, unspecified "error" event.');if(n=this._events[t],da.isUndefined(n))return!1;if(da.isFunction(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(i=arguments.length,r=new Array(i-1),a=1;a<i;a++)r[a-1]=arguments[a];n.apply(this,r)}else if(da.isObject(n)){for(i=arguments.length,r=new Array(i-1),a=1;a<i;a++)r[a-1]=arguments[a];for(i=(o=n.slice()).length,a=0;a<i;a++)o[a].apply(this,r)}return!0},ga.prototype.on=ga.prototype.addListener=function(t,e){var n;if(!da.isFunction(e))throw TypeError("listener must be a function");(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,da.isFunction(e.listener)?e.listener:e),this._events[t]?da.isObject(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,da.isObject(this._events[t])&&!this._events[t].warned)&&((n=da.isUndefined(this._maxListeners)?ga.defaultMaxListeners:this._maxListeners)&&0<n&&this._events[t].length>n&&(this._events[t].warned=!0,da.isFunction(console.error)&&console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),da.isFunction(console.trace)&&console.trace()));return this},ga.prototype.once=function(t,e){if(!da.isFunction(e))throw TypeError("listener must be a function");var n=!1;function i(){this.removeListener(t,i),n||(n=!0,e.apply(this,arguments))}return i.listener=e,this.on(t,i),this},ga.prototype.removeListener=function(t,e){var n,i,r,a;if(!da.isFunction(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=(n=this._events[t]).length,i=-1,n===e||da.isFunction(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(da.isObject(n)){for(a=r;0<a--;)if(n[a]===e||n[a].listener&&n[a].listener===e){i=a;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},ga.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],da.isFunction(n))this.removeListener(t,n);else if(Array.isArray(n))for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},ga.prototype.listeners=function(t){return this._events&&this._events[t]?da.isFunction(this._events[t])?[this._events[t]]:this._events[t].slice():[]},ga.listenerCount=function(t,e){return t._events&&t._events[e]?da.isFunction(t._events[e])?1:t._events[e].length:0};var ya={mixin:function(e){return Object.keys(pa.prototype).forEach(function(t){e[t]=pa.prototype[t]}),pa.init(e),e}};function va(){var a=0,o=0,s=0,c=0;s=s||a;var l={move:function(t){this.moveTo(s+t)},moveTo:function(t){var e=Math.max(a,Math.min(o-c,t));s!==e&&(s=e,l.emit("update"))},update:function(t){var e=!1,n=t.min;a=void 0===n?a:n;var i=t.max;o=void 0===i?o:i,void 0!==t.viewSize&&t.viewSize!==c&&(c=t.viewSize,e=!0);var r=Math.max(a,Math.min(o-c,s));s!==r&&(s=r,e=!0),e&&l.emit("update")},getState:function(){return{min:a,max:o,start:s,viewSize:c}}};return ya.mixin(l),l}function ma(t,e,n){for(var i=0;i<t.length&&e>t[i];)++i;return t[i]===e&&n&&++i,i}function xa(){var c=[];function n(){}return n.add=function(t){var e,n=t.min,i=t.max,r=ma(c,n),a=ma(c,i,!0),o=[r,a-r];r%2==0&&o.push(n),a%2==0&&o.push(i);var s=c.join(",");return(e=c).splice.apply(e,o),s!==c.join(",")},n.remove=function(t){var e,n=t.min,i=t.max,r=ma(c,n),a=ma(c,i,!0),o=[r,a-r];r%2==1&&o.push(n),a%2==1&&o.push(i);var s=c.join(",");return(e=c).splice.apply(e,o),s!==c.join(",")},n.set=function(t){var e=c.join(",");return c=[],Array.isArray(t)?t.forEach(n.add):n.add(t),e!==c.join(",")},n.clear=function(){var t=0<c.length;return c=[],t},n.containsValue=function(t){return function(t,e){for(var n=t.length,i=1;i<n;i+=2)if(t[i-1]<=e&&e<=t[i])return!0;return!1}(c,t)},n.containsRange=function(t){var e=t.min,n=t.max,i=ma(c,e,!0),r=ma(c,n);return i===r&&r%2==1},n.toggle=function(t){return n.containsRange(t)?n.remove(t):n.add(t)},n.ranges=function(){for(var t=[],e=1;e<c.length;e+=2)t.push({min:c[e-1],max:c[e]});return t},n}function ba(){var n=[];function t(){}return t.add=function(t){return-1===n.indexOf(t)&&(n.push(t),!0)},t.remove=function(t){var e=n.indexOf(t);return-1!==e&&(n.splice(e,1),!0)},t.contains=function(t){return-1!==n.indexOf(t)},t.values=function(){return n.slice()},t.clear=function(){return n=[]},t.toString=function(){return n.join(";")},t}function wa(t){for(var e,n,i=t.items,r=t.collection,a=t.vc,o={},s=[],c=0,l=i.length;c<l;c++){r[e=i[c].key]||(r[e]=a()),n=i[c].values||[i[c].value];for(var u=0;u<n.length;u++)r[e].add(n[u])&&(o[e]=o[e]||[],o[e].push(n[u]))}for(var h=Object.keys(o),f=0,d=h.length;f<d;f++)e=h[f],s.push({id:e,values:o[e]});return s}function ka(t){for(var e,n,i=t.items,r=t.collection,a={},o=[],s=0,c=i.length;s<c;s++)if(r[e=i[s].key]){n=i[s].values||[i[s].value];for(var l=0;l<n.length;l++)r[e].remove(n[l])&&(a[e]=a[e]||[],a[e].push(n[l]))}for(var u=Object.keys(a),h=0,f=u.length;h<f;h++)e=u[h],o.push({id:e,values:a[e]});return o}function Ma(t){for(var e,n,i={},r=0,a=t.length;r<a;r++){e=t[r].key,n=t[r].values||[t[r].value],i[e]||(i[e]=[]);for(var o=0;o<n.length;o++){-1===i[e].indexOf(n[o])&&i[e].push(n[o])}}return i}function _a(t){var e=t.key,n=t.collection,i=t.obj,r=t.fn,a=t.value;n[e]||(n[e]=r()),i[e]=i[e]||[],i[e].push(a),n[e].add(a)}function Sa(t,e){for(var n,i,r=[],a=Object.keys(t),o=function(t){return-1===e[n].indexOf(t)},s=0,c=a.length;s<c;s++)n=a[s],e[n]?(i=t[n].filter(o)).length&&r.push({id:n,values:i}):r.push({id:n,values:t[n]});return r}function Ra(t,e,n){var i=function(t,e){if(!Object.keys(e).length)return t;for(var n=t.length,i=Array(n),r=0;r<n;r++)i[r]=t[r].key in e?G({},t[r],{key:e[t[r].key]}):t[r];return i}(e,n);return t&&t.length?t.reduce(function(t,e){return e(t)},i):i}function za(t){return t.replace(/(-[a-z])/g,function(t){return t.toUpperCase().replace("-","")})}function Na(t,r,e){var a=e.ranges,n=e.interceptors,o=e.rc,i=e.aliases,s=Ra(n["".concat(r,"Ranges")],t,i),c=!1;return s.forEach(function(t){var e=t.key;if(a[e]||(a[e]=o()),"set"===r)c=a[e][r](t.ranges||t.range)||c;else for(var n=t.ranges||[t.range],i=0;i<n.length;i++)c=a[e][r](n[i])||c}),c}function Ca(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.vc,o=void 0===e?ba:e,n=t.rc,i=void 0===n?xa:n,s=!1,h={},f={},d={},c={addValues:[],removeValues:[],toggleValues:[],setValues:[],addRanges:[],setRanges:[],removeRanges:[],toggleRanges:[]},r=function(){var e={values:{},ranges:{}};return Object.keys(f).forEach(function(t){e.values[t]=f[t].values()}),Object.keys(h).forEach(function(t){e.ranges[t]=h[t].ranges()}),e},l={ls:[],clear:function(){this.ls.forEach(function(t){return t.clear()})},start:function(){this.ls.forEach(function(t){return t.start()})},end:function(){this.ls.forEach(function(t){return t.end()})},update:function(){var e=r();this.ls.forEach(function(t){return t._state(e)})},updateValues:function(){var e=r();this.ls.forEach(function(t){return t._state({values:e.values})})},updateRanges:function(){var e=r();this.ls.forEach(function(t){return t._state({ranges:e.ranges})})}},u={link:function(t){if(u===t)throw new Error("Can't link to self");l.ls.push(t),t._state(r())},_state:function(e){if(!e)return r();if(e.values){var n=[];Object.keys(e.values).forEach(function(t){f[t]&&e.values[t].join(";")===f[t].toString()||n.push({key:t,values:e.values[t]})}),Object.keys(f).forEach(function(t){e.values[t]||n.push({key:t,values:[]})}),n.length&&u.setValues(n)}if(e.ranges){var i=[];Object.keys(e.ranges).forEach(function(t){h[t]&&e.ranges[t].join(";")===h[t].toString()||i.push({key:t,ranges:e.ranges[t]})}),Object.keys(h).forEach(function(t){e.ranges[t]||i.push({key:t,ranges:[]})}),i.length&&u.setRanges(i)}},start:function(){s||(s=!0,u.emit("start"),l.start())},end:function(){s&&(s=!1,h={},f={},u.emit("end"),l.end())},isActive:function(){return s},clear:function(){var t=u.brushes().filter(function(t){return"value"===t.type&&t.brush.values().length}).map(function(t){return{id:t.id,values:t.brush.values()}}),e=0<Object.keys(h).length||t.length;h={},f={},e&&(u.emit("update",[],t),l.clear())},brushes:function(){var t=[];return t=(t=t.concat(Object.keys(h).map(function(t){return{type:"range",id:t,brush:h[t]}}))).concat(Object.keys(f).map(function(t){return{type:"value",id:t,brush:f[t]}}))},addValue:function(t,e){u.addValues([{key:t,value:e}])},addValues:function(t){var e=Ra(c.addValues,t,d),n=wa({vc:o,collection:f,items:e});u.emit("add-values",e),n.length&&(s||(s=!0,u.emit("start")),u.emit("update",n,[]),l.updateValues())}};return u.setValues=function(t){var e=Ra(c.setValues,t,d),n=function(t){for(var e,n,i=t.items,r=t.vCollection,a=t.vc,o={},s=Ma(i),c={},l=Object.keys(r),u=0,h=l.length;u<h;u++)c[n=l[u]]=r[n].values().slice(),delete r[n];for(var f=function(t){r[n]&&r[n].contains(t)||_a({key:n,value:t,collection:r,obj:o,fn:a})},d=Object.keys(s),g=0,p=d.length;g<p;g++)s[n=d[g]].forEach(f);return e=Sa(c,o),[Sa(o,c),e]}({items:e,vCollection:f,vc:o});u.emit("set-values",e),(0<n[0].length||0<n[1].length)&&(s||(s=!0,u.emit("start")),u.emit("update",n[0],n[1]),l.updateValues())},u.removeValue=function(t,e){u.removeValues([{key:t,value:e}])},u.removeValues=function(t){var e=Ra(c.removeValues,t,d),n=ka({collection:f,items:e});u.emit("remove-values",e),n.length&&(u.emit("update",[],n),l.updateValues())},u.addAndRemoveValues=function(t,e){var n=Ra(c.addValues,t,d),i=Ra(c.removeValues,e,d),r=wa({vc:o,collection:f,items:n}),a=ka({collection:f,items:i});u.emit("add-values",n),u.emit("remove-values",i),(r.length||a.length)&&(s||(s=!0,u.emit("start")),u.emit("update",r,a),l.updateValues())},u.toggleValue=function(t,e){u.toggleValues([{key:t,value:e}])},u.toggleValues=function(t){var e=Ra(c.toggleValues,t,d),n=function(t){for(var e,n,i,r=t.items,a=t.values,o=t.vc,s={},c={},l=[],u=[],h=Ma(r),f=Object.keys(h),d=0,g=f.length;d<g;d++)for(var p=0,y=(i=h[e=f[d]]).length;p<y;p++)n=i[p],a[e]&&a[e].contains(n)?a[e]&&a[e].contains(n)&&(c[e]=c[e]||[],c[e].push(n),a[e].remove(n)):_a({key:e,value:n,collection:a,obj:s,fn:o});for(var v=Object.keys(s),m=0,x=v.length;m<x;m++)e=v[m],l.push({id:e,values:s[e]});for(var b=Object.keys(c),w=0,k=b.length;w<k;w++)e=b[w],u.push({id:e,values:c[e]});return[l,u]}({items:e,values:f,vc:o});u.emit("toggle-values",e),(0<n[0].length||0<n[1].length)&&(s||(s=!0,u.emit("start")),u.emit("update",n[0],n[1]),l.updateValues())},u.containsValue=function(t,e){var n=d[t]||t;return!!f[n]&&f[n].contains(e)},u.addRange=function(t,e){u.addRanges([{key:t,range:e}])},u.addRanges=function(t){Na(t,"add",{ranges:h,rc:i,interceptors:c,aliases:d})&&(s||(s=!0,u.emit("start")),u.emit("update",[],[]),l.updateRanges())},u.removeRange=function(t,e){u.removeRanges([{key:t,range:e}])},u.removeRanges=function(t){Na(t,"remove",{ranges:h,rc:i,interceptors:c,aliases:d})&&(s||(s=!0,u.emit("start")),u.emit("update",[],[]),l.updateRanges())},u.setRange=function(t,e){u.setRanges([{key:t,range:e}])},u.setRanges=function(t){Na(t,"set",{ranges:h,rc:i,interceptors:c,aliases:d})&&(s||(s=!0,u.emit("start")),u.emit("update",[],[]),l.updateRanges())},u.toggleRange=function(t,e){u.toggleRanges([{key:t,range:e}])},u.toggleRanges=function(t){Na(t,"toggle",{ranges:h,rc:i,interceptors:c,aliases:d})&&(s||(s=!0,u.emit("start")),u.emit("update",[],[]),l.updateRanges())},u.containsRangeValue=function(t,e){var n=d[t]||t;return!!h[n]&&h[n].containsValue(e)},u.containsRange=function(t,e){var n=d[t]||t;return!!h[n]&&h[n].containsRange(e)},u.containsMappedData=function(t,e,n){for(var i,r,a,o,s=[],c=Object.keys(t),l=0,u=c.length;l<u;l++){if("value"===(i=c[l]))r=t,s[l]={key:"",i:l,bool:!1};else{if("source"===i)continue;r=t[i],s[l]={key:i,i:l,bool:!1}}void 0!==(a=r.source&&r.source.field)&&(void 0!==r.source.key&&(a="".concat(r.source.key,"/").concat(a)),a in d&&(a=d[a]),o=r.value,h[a]?s[l].bool=Array.isArray(o)?h[a].containsRange({min:o[0],max:o[1]}):h[a].containsValue(o):f[a]&&f[a].contains(o)&&(s[l].bool=!0))}return e?(s=s.filter(function(t){return-1!==e.indexOf(t.key)}),"and"===n?!!s.length&&!s.some(function(t){return!1===t.bool}):"xor"===n?!!s.length&&s.some(function(t){return t.bool})&&s.some(function(t){return!1===t.bool}):s.some(function(t){return t.bool})):s.some(function(t){return t.bool})},u.intercept=function(t,e){var n=za(t);c[n]&&c[n].push(e)},u.removeInterceptor=function(t,e){var n=za(t);if(c[n]){var i=c[n].indexOf(e);-1!==i&&c[n].splice(i,1)}},u.removeAllInterceptors=function(t){var n=[];if(t){var e=za(t);c[e]&&c[e].length&&n.push({name:t,handlers:c[e]})}else Object.keys(c).forEach(function(t){var e;c[t].length&&n.push({name:(e=t,e.replace(/([A-Z])/g,function(t){return"-".concat(t.toLowerCase())})),handlers:c[t]})});n.forEach(function(e){e.handlers.slice().forEach(function(t){return u.removeInterceptor(e.name,t)})})},u.addKeyAlias=function(t,e){d[t]=e},u.removeKeyAlias=function(t){delete d[t]},ya.mixin(u),u}Kt();function Aa(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}Math.PI;var Ta=2*Math.PI,Ea=function e(n,i){var r=Math.asin(1/(n=Math.max(1,n)))*(i/=Ta);function t(t){return 1-n*Math.pow(2,-10*(t=+t))*Math.sin((t+r)/i)}return t.amplitude=function(t){return e(t,i*Ta)},t.period=function(t){return e(n,t)},t}(1,.3);function Oa(t,e){return t.data?t.data.value:"text"===t.type?t.text:e}var ja={fontFamily:"Arial",fontSize:"13px",color:"#595959",backgroundColor:"#ffffff",stroke:"#000000",strokeWidth:0,$fill:"#333333"},Pa=/^\$/;function Fa(t){var e=Q(t);return"object"!==e&&"function"!==e&&"undefined"!==e}function Da(t,e,n){var i=t[e];i&&i.scale&&i.scale.pxScale?i.scale=i.scale.pxScale(n):i&&i.pxScale&&(t[e]=i.pxScale(n))}function La(t,e){return t.pxScale?t.pxScale(e):t}var Ba={normalizeSettings:function(t,a,o){var s=G({},t),c=G({},a);return Object.keys(s).forEach(function(t){c[t]={};var e=s[t],n=Q(e);if("function"==typeof e)c[t].fn=e;else if(Fa(e)){var i=a[t];"string"==typeof i&&Pa.test(i)&&(i=ja[i]);var r=Q(i);c[t]="undefined"===r?e:r===n?e:i}else e&&"object"===Q(e)&&("function"==typeof e.fn&&(c[t].fn=e.fn),void 0!==e.scale&&(c[t].scale=o.scale(e.scale)),"string"==typeof e.ref&&(c[t].ref=e.ref))}),Object.keys(a).forEach(function(t){if(!(t in s)){var e=a[t];"string"===Q(e)&&Pa.test(e)?c[t]=ja[e]:c[t]=e}}),c},resolveForItem:function(t,e){for(var n={},i=Object.keys(e),r=i.length,a=t.datum,o=t.datum,s=t.data&&t.data.items,c=s?s.indexOf(o):-1,l=0;l<r;l++){var u=i[l],h=e[u],f="object"===Q(o)&&void 0!==h,d=f&&"string"==typeof h.ref,g=f&&u in o,p=d?o[h.ref]:g?o[u]:a;Fa(h)?n[u]=h:f&&h.fn?(h.scale&&(t.scale=h.scale),n[u]=h.fn.call(null,t,c)):f&&h.scale&&p?(n[u]=h.scale(p.value),h.scale.bandwidth&&(n[u]+=h.scale.bandwidth()/2)):d&&p?n[u]=p.value:h.fn?n[u]=h.fn.call(null,t,c):n[u]=h}return n},updateScaleSize:Da};function Wa(r,t){var e=t.context,n=t.data,i=t.style,a=t.filter,c=r.chart.brush(e),l=n,u=i.active||{},h=i.inactive||{},f=[];Object.keys(u).forEach(function(t){f.push(t)}),Object.keys(h).forEach(function(t){-1===f.indexOf(t)&&f.push(t)});var d=[],g=!1,p=function(){var t=function n(){return(0<arguments.length&&void 0!==arguments[0]?arguments[0]:[]).reduce(function(t,e){return Array.isArray(e.children)?t.concat(n(e.children)):(t.push(e),t)},[])}(r.nodes);return"function"==typeof a&&(t=t.filter(a)),t},o=function(){for(var a,o=p(),t=o.length,s=!1,e=function(e){if(!(a=o[e].data))return"continue";o[e].__style||(o[e].__style={},f.forEach(function(t){o[e].__style[t]=o[e][t]}));var n=c.containsMappedData(a,l),t=d.indexOf(o[e]),i=!1;if(n&&-1===t?(d.push(o[e]),i=!0):n||-1===t||(d.splice(t,1),i=!0),i||g){var r=G({},o[e],o[e].__style);f.forEach(function(t){o[e][t]=n&&t in u?"function"==typeof u[t]?u[t].call(null,r):u[t]:!n&&t in h?"function"==typeof h[t]?h[t].call(null,r):h[t]:o[e].__style[t]}),s=!0}},n=0;n<t;n++)e(n);return g=!1,s},s=function(){for(var n=p(),t=n.length,e=function(e){n[e].__style=n[e].__style||{},f.forEach(function(t){n[e].__style[t]=n[e][t],t in h&&(n[e][t]="function"==typeof h[t]?h[t].call(null,n[e]):h[t])})},i=0;i<t;i++)e(i);g=!0,d.length=0,r.renderer.render(r.nodes)},y=function(){for(var n=p(),t=n.length,e=function(e){n[e].__style&&(Object.keys(n[e].__style).forEach(function(t){n[e][t]=n[e].__style[t]}),n[e].__style=void 0)},i=0;i<t;i++)e(i);d.length=0,r.renderer.render(r.nodes)},v=function(){o()&&r.renderer.render(r.nodes)};return c.on("start",s),c.on("end",y),c.on("update",v),{isActive:function(){return c.isActive()},update:function(){d.length=0,g=!0,o()},cleanUp:function(){c.removeListener("start",s),c.removeListener("end",y),c.removeListener("update",v)}}}function Ia(t){for(var e=t.nodes,n=t.action,i=t.chart,r=t.trigger,a=[],o=0;o<e.length;o++){var s=e[o].data;null!==s&&a.push(s)}!function(t){var e=t.dataPoints,n=t.action,i=t.chart,r=t.trigger;if(r){var a=r.data||[""],o={items:[],actionFn:"toggleRanges"},s={items:[],actionFn:"toggleValues"};-1!==["add","remove","set","toggle"].indexOf(n)&&(o.actionFn="".concat(n,"Ranges"),s.actionFn="".concat(n,"Values"));for(var c=function(t){var i=e[t];if(!i)return"continue";a.forEach(function(t){var e=i&&!t?i:i[t];if(e){var n={key:e.source.field};void 0!==e.source.key&&(n.key="".concat(e.source.key,"/").concat(e.source.field)),Array.isArray(e.value)?(n.range={min:e.value[0],max:e.value[1]},o.items.push(n)):(n.value=e.value,s.items.push(n))}})},l=0;l<e.length;l++)c(l);r.contexts.forEach(function(t){o.items.length?i.brush(t)[o.actionFn](o.items):i.brush(t)[s.actionFn](s.items)})}}({dataPoints:a,action:n,chart:i,trigger:r})}function $a(t){var e=t.collisions,n=t.t,i=t.config,r=t.action,a=[],o=!1;return 0<e.length&&(a=e,o=!0,"stop"===n.propagation&&(a=[e[e.length-1]])),Ia({nodes:a.map(function(t){return t.node}),action:r,chart:i.chart,data:i.data,trigger:n}),o}function Va(t,e,n){var i,r,a,o,s=n.element().getBoundingClientRect(),c=Z(t)?(o=s,1!==(a=t).changedTouches.length?null:{x:a.changedTouches[0].clientX-o.left,y:a.changedTouches[0].clientY-o.top}):(r=s,{x:(i=t).clientX-r.left,y:i.clientY-r.top});return null===c||c.x<0||c.y<0||c.x>s.width||c.y>s.height?[]:(0<e.touchRadius&&Z(t)&&(c={cx:c.x,cy:c.y,r:e.touchRadius}),n.itemsAt(c))}function qa(t,e,n){return t?"function"==typeof t?t(e):t:n}var Ua=function(e){return["on","preferredSize","created","beforeMount","mounted","resize","beforeUpdate","updated","beforeRender","render","beforeUnmount","beforeDestroy","destroyed","defaultSettings","data","settings","formatter","scale","chart","dockConfig","mediator","style","resolver","registries","_DO_NOT_USE_getInfo"].some(function(t){return t===e})};function Ha(e,n,t){var i=n.require,r=void 0===i?[]:i,a=n.mediator||{},o=t.settings,s=t.formatter,c=t.scale,l=t.data,u=t.renderer,h=t.chart,f=t.dockConfig,d=t.mediator,g=t.instance,p=t.style,y=t.registries,v=t.resolver,m=t.update,x=t._DO_NOT_USE_getInfo;Object.defineProperty(e,"settings",{get:o}),Object.defineProperty(e,"data",{get:l}),Object.defineProperty(e,"formatter",{get:s}),Object.defineProperty(e,"scale",{get:c}),Object.defineProperty(e,"mediator",{get:d}),Object.defineProperty(e,"style",{get:p}),Object.defineProperty(e,"registries",{get:y}),x&&(e._DO_NOT_USE_getInfo=x),Object.keys(n).forEach(function(t){Ua(t)||("function"==typeof n[t]?e[t]=n[t].bind(e):e[t]=n[t])}),r.forEach(function(t){"renderer"===t?Object.defineProperty(e,"renderer",{get:u}):"chart"===t?Object.defineProperty(e,"chart",{get:h}):"dockConfig"===t?Object.defineProperty(e,"dockConfig",{get:f}):"instance"===t?Object.defineProperty(e,"instance",{get:g}):"update"===t&&m?Object.defineProperty(e,"update",{get:m}):"resolver"===t&&Object.defineProperty(e,"resolver",{get:v})}),Object.keys(a).forEach(function(t){e.mediator.on(t,a[t].bind(e))})}function Ya(t,e){return t.displayOrder=e.displayOrder,t.dock=e.dock,t.prioOrder=e.prioOrder,t.minimumLayoutMode=e.minimumLayoutMode,t.show=e.show,t}function Xa(n,r,i){Object.keys(i.on||{}).forEach(function(t){n.eventListeners=n.eventListeners||[];var e=i.on[t].bind(n);n.eventListeners.push({event:t,listener:e}),r.on(t,e)}),n.emit=function(t){for(var e=arguments.length,n=new Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return r.emit.apply(r,[t].concat(n))}}function Za(u){var e,n,t,i,r,a=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},o=u.defaultSettings,s=void 0===o?{}:o,c=u._DO_NOT_USE_getInfo,l=void 0===c?function(){return{}}:c,h=a.chart,f=a.container,d=a.mediator,g=a.registries,p=a.theme,y=a.renderer,v=a.settings||{},m=ya.mixin({}),x=G(!0,{},s,v),b=[],w=function(p){var y=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Ba,v={};return{resolve:function(t){var e=t.data,n=t.settings,i=t.defaults,r=void 0===i?{}:i,a=t.scaled,o=v.norm=y.normalizeSettings(n,r,p.chart),s={scale:p.chart.scale,formatter:p.chart.formatter};a&&Object.keys(a).forEach(function(t){o[t]&&y.updateScaleSize(o,t,a[t])});var c=[];if(!e||!Array.isArray(e.items)){var l={data:e,resources:s},u=y.resolveForItem(l,v.norm);return{settings:v.norm,item:u}}for(var h=0,f=e.items.length;h<f;h++){var d={datum:e.items[h],data:e,resources:s},g=y.resolveForItem(d,v.norm);g.data=e.items[h],c.push(g)}return{settings:v.norm,items:c}}}}({chart:h}),k={nodes:[],chart:h,config:x.brush||{},renderer:null},M={tap:[],over:[]},_=[],S={},R=G({},v);function z(c){var l=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var t,e,n,i="function"==typeof u[c],r="function"==typeof v[c],a=arguments.length,o=new Array(a),s=0;s<a;s++)o[s]=arguments[s];i&&(t=(e=u[c]).call.apply(e,[S].concat(o)));"function"==typeof v[c]&&(t=(n=v[c]).call.apply(n,[R].concat(o)));return i||r||(t=l.call.apply(l,[S].concat(o))),t}}var N=z("preferredSize",function(){return 0}),C=z("resize",function(t){return t.inner}),A=z("created"),T=z("beforeMount"),E=z("mounted"),O=z("beforeUnmount"),j=z("beforeUpdate"),P=z("updated"),F=z("beforeRender"),D=z("beforeDestroy"),L=z("destroyed"),B=u.render,W=function(){x.brush&&(x.brush.consume||[]).forEach(function(t){t.context&&t.style&&_.push(Wa(k,t))})},I=function(){x.brush&&(x.brush.trigger||[]).forEach(function(t){"over"===t.on?M.over.push(t):M.tap.push(t)})};Object.defineProperty(k,"data",{get:function(){return b}});var $=x.renderer||u.renderer,V=$?y||g.renderer($)():y||g.renderer()();k.renderer=V;var q={requiredSize:function(t,e){return N({inner:t,outer:e,dock:q.dock})}};Ya(q,x);var U=function(t){t.key=x.key,t.element=V.element()},H=function(){};H.dockConfig=q,H.set=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};t.settings&&(x=G(!0,{},s,t.settings),Ya(q,x)),x.scale&&(e=h.scale(x.scale)),b=x.data?ii(x.data,{dataset:h.dataset,collection:h.dataCollection},{logger:h.logger()},h.dataCollection):e?e.data():[],"string"==typeof x.formatter?n=h.formatter(x.formatter):"object"===Q(x.formatter)?n=h.formatter(x.formatter):e&&e.data().fields&&(n=e.data().fields[0].formatter()),r=p.style(x.style||{})},H.resize=function(t,e){var n=C({inner:t,outer:e});i=n?(V.size(n),n):(V.size(t),t),R.rect=t},H.getRect=function(){return R.rect};var Y,X,Z=function(){var t=V.renderArgs?V.renderArgs.slice(0):[];return t.push({data:b}),t};H.beforeMount=T,H.beforeRender=function(){F({size:i})},H.render=function(){var t=k.nodes=B.call.apply(B,[S].concat(K(Z())));V.render(t),Y=t},H.hide=function(){H.unmount(),V.size({x:0,y:0,width:0,height:0}),V.clear()},H.beforeUpdate=function(){j({settings:x,data:b})},H.update=function(){X&&X.stop();var t,e,n,r,a,o,s,c,l,u,h,f,d,g,i=k.nodes=B.call.apply(B,[S].concat(K(Z())));_.forEach(function(t){return t.cleanUp()}),_.length=0,M.tap=[],M.over=[],x.brush&&(W(),I()),_.forEach(function(t){t.isActive()&&t.update()}),Y&&x.animations&&x.animations.enabled?(t={old:Y,current:i},e={renderer:V},n=x.animations,a=t.old,o=t.current,s=e.renderer,c=[],l={nodes:[],ips:[]},u={nodes:[],ips:[]},h={nodes:[],ips:[]},f=[],d=n.trackBy||Oa,(X=g={start:function(){var i={};a.forEach(function(t,e){var n=d(t,e);i[n]=t}),o.forEach(function(t,e){var n=d(t,e);i[n]?(h.ips.push(Sr(i[n],t)),h.nodes.push(t),c.push(i[n]),i[n]=!1):(l.nodes.push(t),l.ips.push(Sr({r:.001,opacity:0},t)))}),Object.keys(i).forEach(function(t){i[t]&&(u.nodes.push(i[t]),u.ips.push(Sr(i[t],G({},i[t],{r:1e-4,opacity:0}))))}),u.ips.length&&f.push({easing:Aa,duration:200,tweens:u.ips,nodes:c.concat()}),h.ips.length&&f.push({easing:Aa,duration:400,tweens:h.ips,nodes:[]}),l.ips.length&&f.push({easing:Ea,duration:1200,tweens:l.ips,nodes:K(h.nodes)}),f.length&&(f[0].started=Date.now(),"undefined"!=typeof window&&(r=window.requestAnimationFrame(g.tick)))},tick:function(){var e=f[0];e||g.stop(),e.started||(e.started=Date.now());var n=(Date.now()-e.started)/e.duration,t=[],i=e.tweens.map(function(t){return t(e.easing(Math.min(1,n)))});t.push.apply(t,K(i)),t.push.apply(t,K(e.nodes)),s.render(t),1<=n&&(f.shift(),f.length||g.stop()),r&&(r=window.requestAnimationFrame(g.tick))},stop:function(){r&&(window.cancelAnimationFrame(r),r=!1)}}).start()):V.render(i),Y=i},H.updated=P,H.destroy=function(){H.unmount(),D(t),V.destroy(),L(),t=null};var J=function(t){k.nodes=t,_.forEach(function(t){t.isActive()&&t.update()}),V.render(t)};return Ha(S,u,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return V},chart:function(){return h},dockConfig:function(){return q},mediator:function(){return d},instance:function(){return R},style:function(){return r},update:function(){return J},registries:function(){return g},resolver:function(){return w}}),Ha(R,v,{settings:function(){return x},data:function(){return b},scale:function(){return e},formatter:function(){return n},renderer:function(){return V},chart:function(){return h},dockConfig:function(){return q},mediator:function(){return d},style:function(){return r},_DO_NOT_USE_getInfo:l.bind(S)}),H.getBrushedShapes=function(e,i,r){var a=[];if(x.brush&&x.brush.consume){var o=h.brush(e),s=V.findShapes("*");x.brush.consume.filter(function(t){return t.context===e}).forEach(function(t){for(var e=0;e<s.length;e++){var n=s[e];n.data&&o.containsMappedData(n.data,r||t.data,i)&&(U(n),a.push(n),s.splice(e,1),e--)}})}return a},H.findShapes=function(t){for(var e=V.findShapes(t),n=0,i=e.length;n<i;n++)U(e[n]);return e},H.shapesAt=function(t){for(var e,n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=V.itemsAt(t),r=0,a=(e=n&&"stop"===n.propagation&&0<i.length?[i.pop().node]:i.map(function(t){return t.node})).length;r<a;r++)U(e[r]);return e},H.brushFromShapes=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};e.contexts=Array.isArray(e.contexts)?e.contexts:[],Ia({nodes:t,action:e.action||"toggle",trigger:e,chart:h,data:k.data})},H.mount=function(){t=V.element&&V.element()?t:V.appendTo(f),x.brush&&(W(),I()),Xa(R,m,v),Xa(S,m,u)},H.mounted=function(){return E(t)},H.unmount=function(){[R,S].forEach(function(t){(t.eventListeners||[]).forEach(function(t){var e=t.event,n=t.listener;m.removeListener(e,n)})}),M.tap=[],M.over=[],_.forEach(function(t){t.cleanUp()}),_.length=0,O()},H.onBrushTap=function(a){M.tap.forEach(function(t){var e,n,i,r;n=(e={e:a,t:t,config:k}).e,i=e.t,r=e.config,$a({collisions:Va(n,i,r.renderer),t:i,config:r,action:qa(i.action,n,"toggle")})&&"stop"===t.globalPropagation&&h.toggleBrushing(!0)})},H.onBrushOver=function(a){M.over.forEach(function(t){var e,n,i,r;n=(e={e:a,t:t,config:k}).e,i=e.t,r=e.config,$a({collisions:Va(n,i,r.renderer),t:i,config:r,action:qa(i.action,n,"set")})&&"stop"===t.globalPropagation&&h.toggleBrushing(!0)})},H.def=S,H.ctx=R,H.renderer=function(){return V},H.set({settings:v}),A(),H}function Ja(t,e){return{x:t.x+e.x,y:t.y+e.y}}function Ga(t,e){return{x:t.x-e.x,y:t.y-e.y}}function Qa(t,e){return{x:t.x*e,y:t.y*e}}function Ka(t,e){return t.x-e.x}function to(t,e){return t.y-e.y}function eo(t,e){return Math.pow(Ka(t,e),2)+Math.pow(to(t,e),2)}function no(t,e){return Math.sqrt(eo(t,e))}function io(t,e){return t.x*e.x+t.y*e.y}function ro(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{x:0,y:0},i=Math.cos(e),r=Math.sin(e),a=Ga(t,n);return Ja({x:i*a.x-r*a.y,y:r*a.x+i*a.y},n)}var ao=1e-12;function oo(t,e,n){var i,r,a=Ga(n,t),o=Ga(e,t);return Ja((r=io(a,i=o)/io(i,i)||1,{x:i.x*r,y:i.y*r}),t)}function so(t,e,n){return no(t,n)+no(e,n)-no(t,e)<ao}function co(t){return t.x1===t.x2&&t.y1===t.y2}function lo(t){return t.width<=0||t.height<=0}function uo(t){return t.r<=0}function ho(t){return t.edges.length<=2}function fo(t,e){return!uo(t)&&eo({x:t.cx,y:t.cy},e)<=Math.pow(t.r,2)}function go(t,e){if(lo(e)||uo(t))return!1;var n=e.width/2,i=e.height/2,r=e.x+n,a=e.y+i,o=t.r,s=t.cx,c=t.cy,l=Math.abs(s-r),u=Math.abs(c-a);return!(n+o<l||i+o<u)&&(l<=n||u<=i||Math.pow(l-n,2)+Math.pow(u-i,2)<=Math.pow(o,2))}function po(t,e){if(uo(t)||co(e))return!1;var n=C(F(e),2),i=n[0],r=n[1];if(fo(t,i)||fo(t,r))return!0;var a={x:t.cx,y:t.cy},o=oo(i,r,a);return eo(o,a)<=Math.pow(t.r,2)&&so(i,r,o)}function yo(t,e){if(ho(e)||uo(t))return!1;if(vo(e,{x:t.cx,y:t.cy}))return!0;for(var n=e.edges.length,i=0;i<n;i++){if(po(t,B(e.edges[i])))return!0}return!1}function vo(t,e){if(ho(t)||!wo(t.boundingRect(),e))return!1;for(var n=!0,i=t.vertices.length,r={x:t.xMin-1,y:e.y},a=0;a<i-1;a++){var o=B(t.edges[a]);o.y1<e.y&&o.y2<e.y||o.y1>e.y&&o.y2>e.y||(n=Mo(o,B([r,e]))?!n:n)}return!n}function mo(t,e){if(ho(t))return!1;for(var n=0,i=t.edges.length;n<i;n++){if(Mo(e,B(t.edges[n])))return!0}var r=C(F(e),2),a=r[0],o=r[1];return vo(t,a)||vo(t,o)}function xo(t,e){if(ho(t))return!1;for(var n=0,i=t.edges.length;n<i;n++){if(ko(e,B(t.edges[n])))return!0}var r=C(D(e),4),a=r[0],o=r[1],s=r[2],c=r[3];return vo(t,a)||vo(t,o)||vo(t,s)||vo(t,c)}function bo(t,e){return!lo(t)&&!lo(e)&&(t.x<=e.x+e.width&&e.x<=t.x+t.width&&t.y<=e.y+e.height&&e.y<=t.y+t.height)}function wo(t,e){return!lo(t)&&(e.x>=t.x&&e.x<=t.x+t.width&&e.y>=t.y&&e.y<=t.y+t.height)}function ko(t,e){if(co(e)||lo(t))return!1;var n=C(F(e),2),i=n[0],r=n[1];if(wo(t,i)||wo(t,r))return!0;for(var a=D(t),o=a.length,s=0;s<o;s++){if(Mo(B([a[s],a[3!==s?s+1:0]]),e))return!0}return!1}function Mo(t,e){var n,i,r=C(F(t),2),a=r[0],o=r[1],s=C(F(e),2),c=s[0],l=s[1],u=Ka(o,a),h=to(o,a),f=Ka(l,c),d=to(l,c),g=Ka(a,c),p=to(a,c),y=d*u-f*h,v=f*p-d*g,m=u*p-h*g;if(0===u&&0===h)return!1;if(0===f&&0===d)return!1;if(0===y){if(0!==v||0!==m)return!1;if(0===u){if(0===h)return a.x===o.x&&a.y===o.y;n=to(c,a)/h,i=to(l,a)/h}else n=(c.x-a.x)/u,i=(l.x-a.x)/u;return!(n<0&&i<0||1<n&&1<i)}var x=v/y;return y=m/y,0<=x&&x<=1&&0<=y&&y<=1}function _o(t,e){if(co(t))return!1;var n=C(F(t),2);return so(n[0],n[1],e)}var So=/^\$/,Ro="@extend";function zo(t){throw new Error('Cyclical reference for "'.concat(t,'"'))}function No(t,e){return function i(t,e,r){if("string"==typeof t){var n=e[t];return-1!==r.indexOf(t)&&zo(t),So.test(n)?(r.push(t),i(n,e,r)):n}var a=t,o=G(!0,{},e,t),s={};if(t[Ro]){var c=t[Ro];-1!==r.indexOf(c)&&zo(c);var l=r.slice();l.push(c),a=G(!0,{},i(o[c],e,l),t)}return Object.keys(a).forEach(function(t){var e=r.slice();if(t!==Ro&&!So.test(t)){s[t]=a[t];var n=s[t];So.test(n)&&n in o?(-1!==r.indexOf(n)&&zo(n),e.push(n),"object"===Q(n=o[n])?s[t]=i(n,o,e):So.test(n)&&n in o?s[t]=i(n,o,e):s[t]=n):"object"===Q(n)&&(s[t]=i(n,o,e))}}),s}(t,e,[])}function Co(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],a={},n=function(t){t.forEach(function(t){var e=Array.isArray(t.colors[0])?t.colors:[t.colors];a[t.key]={colors:e,sizes:e.map(function(t){return t?t.length:0})}})},i={palette:function(t,e){return function(t,e){var n=a[t];if(!n)return[];for(var i=n.sizes,r=0;r<i.length;r++)if(e<=i[r])return n.colors[r];return n.colors[i.length-1]}(t,e)},setPalettes:n,style:function(t){return No(t,e)}};return n(t),i}function Ao(t,e,n){var i=e.left-n.left,r=e.top-n.top,a=W(t),o=G(!0,{},t);switch(a){case"circle":o.cx+=i,o.cy+=r;break;case"polygon":for(var s=0,c=o.vertices.length;s<c;s++){var l=o.vertices[s];l.x+=i,l.y+=r}break;case"line":o.x1+=i,o.y1+=r,o.x2+=i,o.y2+=r;break;case"point":case"rect":o.x+=i,o.y+=r}return o}function To(c,t){var e,p=c.element,n=c.data,y=void 0===n?[]:n,i=c.settings,v=void 0===i?{}:i,r=c.on,a=void 0===r?{}:r,m=t.registries,x=t.logger,b=Co(t.style,t.palettes),o=[],l=G({},c),s=(e={},ya.mixin(e),e),w=[],k=[],M=null,_=null,S=null,u=[],R=function(){},z=function(){},N={},h=!1,C=function(t,e){return m.component.has(t.type)?{instance:Za(m.component(t.type),{settings:t,chart:l,mediator:s,registries:m,theme:b,container:e}),settings:G(!0,{},t),key:t.key,hasKey:void 0!==t.key}:(x.warn("Unknown component: ".concat(t.type)),!1)};function f(o){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:function(){};return function(){for(var t,e,n="function"==typeof c[o],i=arguments.length,r=new Array(i),a=0;a<i;a++)r[a]=arguments[a];n?t=(e=c[o]).call.apply(e,[l].concat(r)):t=s.call.apply(s,[l].concat(r));return t}}var d=function(t){for(var e=0;e<w.length;e++)if(w[e].instance===t)return w[e];return null},A=function(t){for(var e=0;e<w.length;e++){var n=w[e];if(n.hasKey&&n.key===t)return e}return-1},T=function(t){var e=X(v.dockLayout);t.forEach(function(t){e.addComponent(t.instance,t.key)});var n=e.layout(p),i=n.visible,r=n.hidden;return{visible:i.map(function(t){return d(t)}),hidden:r.map(function(t){return d(t)})}},g=f("created"),E=f("beforeMount"),O=f("mounted"),j=f("beforeUpdate"),P=f("updated"),F=f("beforeRender"),D=f("beforeDestroy"),L=f("destroyed"),B=function(t,e){var n,i,r,a,o,s,c=(2<arguments.length&&void 0!==arguments[2]?arguments[2]:{}).partialData,l=e.formatters,u=void 0===l?{}:l,h=e.scales,f=void 0===h?{}:h,d=e.scroll,g=void 0===d?{}:d;n=t,i={logger:x,types:m.data},r=i.types,a=i.logger,o={},s=[],Array.isArray(n)?s.push.apply(s,K(n)):(a.warn('Deprecated: "data-source" configuration"'),s.push(n)),s.forEach(function(t,e){var n=r(t.type);if(n){var i=n({key:t.key||e,data:t.data,config:t.config});o[t.key||e]=i}}),R=function(t){return t?o[t]:o[Object.keys(o)[0]]},c||Object.keys(N).forEach(function(t){return N[t].clear()}),e.palettes&&b.setPalettes(e.palettes),z=function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:ii,a={};return(t||[]).forEach(function(t){if(!t.key)throw new Error('Data collection is missing "key" property');if("object"===Q(t.data)&&"collection"in t.data)throw new Error("Data config for collections may not reference other collections");a[t.key]=i(t.data,e,n)}),function(t){var e,n;if("string"==typeof t?e=t:"object"===Q(t)&&(e=t.key,n=t),!(e in a))throw new Error("Unknown data collection: ".concat(e));var i=a[e];if(n&&n.fields&&n.fields.filter){var r=i.fields.filter(n.fields.filter);i.fields.length!==r.length&&(i=G(i,{fields:r}))}return i}}(e.collections,{dataset:R},{logger:x}),M=function(t,e,n){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=fa(t[r],e,n));return i}(f,{dataset:R,collection:z},{scale:m.scale,theme:b,logger:x}),_=function(t,e,n){var i={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=ri(t[r],e,n));return i}(u,{dataset:R,collection:z},{formatter:m.formatter,theme:b,logger:x}),S=function(t,e){var n,i,r,a,o,s,c={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(c[l]=(n=t[l],i=e?e[l]:null,s=void 0,r=n.min||0,a=n.max||0,o=n.viewSize||0,(s=i||va()).update({min:r,max:a,viewSize:o}),s));return c}(g,S)};function W(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],n={},e=t.filter(function(t){return!!t.key}).map(function(t){return t.key});u.forEach(function(t){t.key&&-1!==e.indexOf(t.key)?n[t.key]=t:t.destroy()}),u=t.map(function(t){var e=t.key&&n[t.key]?n[t.key]:m.interaction(t.type)(l,s,p);return e.set(t),e})}var I=function(t){var e=p.getBoundingClientRect(),n="clientX"in t?t.clientX:t.x,i="clientY"in t?t.clientY:t.y,r={x:n-e.left,y:i-e.top},a=[];return k.forEach(function(t){var e=t.instance.getRect();wo({x:e.margin.left+e.x*e.scaleRatio.x,y:e.margin.top+e.y*e.scaleRatio.y,width:e.width*e.scaleRatio.x,height:e.height*e.scaleRatio.y},r)&&a.push(t)}),a};return l.update=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.partialData;t.data&&(y=t.data),t.settings&&(v=t.settings,W(t.settings.interactions)),j(),B(y,v,{partialData:e});for(var n=v,i=n.formatters,r=n.scales,a=n.components,o=void 0===a?[]:a,s=function(t){var e=w[t];o.some(function(t){return e.hasKey&&e.key===t.key})||(w.splice(t,1),e.instance.destroy())},c=w.length-1;0<=c;c--)s(c);(w=o.map(function(t){var e=A(t.key);return-1===e?C(t,p):(w[e].updateWith={formatters:i,scales:r,data:y,settings:t},w[e])}).filter(function(t){return!!t})).forEach(function(t){t.updateWith&&t.instance.set(t.updateWith)}),w.forEach(function(t){t.updateWith&&t.instance.beforeUpdate()});var l,u=[],h=[];if(e)w.forEach(function(t){t.updateWith&&t.visible&&u.push(t)}),l=u;else{var f=T(w),d=f.visible,g=f.hidden;(l=k=d).forEach(function(t){t.updateWith&&t.visible?u.push(t):h.push(t)}),g.forEach(function(t){t.instance.hide(),t.visible=!1,delete t.updateWith})}h.forEach(function(t){return t.instance.beforeMount()}),h.forEach(function(t){return t.instance.mount()}),l.forEach(function(t){return t.instance.beforeRender()}),l.forEach(function(t){t.updateWith&&t.visible?t.instance.update():t.instance.render()}),e||k.forEach(function(t,e){return function(t,e){var n=t.instance.renderer().element();if(!isNaN(e)&&n&&p&&p.childNodes){var i=p.childNodes,r=Math.min(i.length-1,Math.max(e,0)),a=i[r];p.insertBefore&&void 0!==a&&p.insertBefore(n,i[r])}}(t,e)}),h.forEach(function(t){return t.instance.mounted()}),u.forEach(function(t){return t.instance.updated()}),k.forEach(function(t){delete t.updateWith,t.visible=!0}),P()},l.destroy=function(){D(),w.forEach(function(t){return t.instance.destroy()}),w=[],o.forEach(function(t){var e=t.key,n=t.listener;return p.removeEventListener(e,n)}),W(),delete l.update,delete l.destroy,L()},l.getAffectedShapes=function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"and",i=2<arguments.length?arguments[2]:void 0,r=3<arguments.length?arguments[3]:void 0,a=[];return w.filter(function(t){return null==r||t.key===r}).forEach(function(t){a.push.apply(a,K(t.instance.getBrushedShapes(e,n,i)))}),a},l.findShapes=function(e){var n=[];return k.forEach(function(t){n.push.apply(n,K(t.instance.findShapes(e)))}),n},l.componentsFromPoint=function(t){return I(t).map(function(t){return t.instance.ctx})},l.shapesAt=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=[],i=p.getBoundingClientRect(),r=k;if(Array.isArray(e.components)&&0<e.components.length){var a=e.components.map(function(t){return t.key});r=k.filter(function(t){return-1!==a.indexOf(t.key)}).map(function(t){return{instance:t.instance,opts:e.components[a.indexOf(t.key)]}})}for(var o=r.length-1;0<=o;o--){var s=r[o],c=Ao(t,i,s.instance.renderer().element().getBoundingClientRect()),l=s.instance.shapesAt(c,s.opts),u=0<l.length&&"stop"===e.propagation;if(n.push.apply(n,K(l)),0<n.length&&u)return n}return n},l.brushFromShapes=function(o){var s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{components:[]},c=s.components.map(function(t){return t.key});k.forEach(function(t){var e=c.indexOf(t.key);if(-1!==e){for(var n=[],i=0,r=o.length;i<r;i++){var a=o[i];a.key===t.key&&n.push(a)}t.instance.brushFromShapes(n,s.components[e])}})},l.scroll=function(){var t,e,n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default";return(e=S)[t=n]||(e[t]=va()),e[t]},l.dataset=function(t){return R(t)},l.dataCollection=function(t){return z(t)},l.scales=function(){return M},l.formatters=function(){return _},l.brush=function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"default";return N[t]||(N[t]=Ca()),N[t]},l.scale=function(t){return e=t,n=M,i={dataset:R,collection:z},r={scale:m.scale,theme:b,logger:x},"string"==typeof e&&n[e]?a=n[e]:"object"===Q(e)&&"scale"in e&&n[e.scale]&&(a=n[e.scale]),a||fa(e,i,r);var e,n,i,r,a},l.formatter=function(t){return e=t,n=_,i={dataset:R,collection:z},r={formatter:m.formatter,theme:b,logger:x},"string"==typeof e&&n[e]?a=n[e]:"object"===Q(e)&&"formatter"in e&&n[e.formatter]?a=n[e.formatter]:"object"===Q(e)&&"type"in e&&n[e.type]&&(a=n[e.type]),a||ri(e,i,r);var e,n,i,r,a},l.toggleBrushing=function(t){h=void 0!==t?t:!h},l.component=function(t){var e=A(t);if(-1!==e)return w[e].instance.ctx},l.logger=function(){return x},l.theme=function(){return b},Object.defineProperty(l,"interactions",{get:function(){return{instances:u,on:function(){u.forEach(function(t){return t.on()})},off:function(){u.forEach(function(t){return t.off()})}}}}),g(),p&&(E(),function(){p.innerHTML="",function(){var t=v.components,e=void 0===t?[]:t;F(),B(y,v),w=e.map(function(t){return C(t,p)}).filter(function(t){return!!t});var n=T(w),i=n.visible,r=n.hidden;k=i,r.forEach(function(t){t.instance.hide(),t.visible=!1}),i.forEach(function(t){return t.instance.beforeMount()}),i.forEach(function(t){return t.instance.mount()}),i.forEach(function(t){return t.instance.beforeRender()}),i.forEach(function(t){return t.instance.render()}),i.forEach(function(t){return t.instance.mounted()}),i.forEach(function(t){t.visible=!0})}(),Object.keys(a).forEach(function(t){var e=a[t].bind(l);p.addEventListener(t,e),o.push({key:t,listener:e})});var t,u={},e=function(t){t.touches?(u.x=t.touches[0].clientX,u.y=t.touches[0].clientY,u.multiTouch=1<t.touches.length):(u.x=t.clientX,u.y=t.clientY,u.multiTouch=!1),u.time=Date.now(),u.comps=I(u)},n=function(t){var e=u.comps||I(t);if(!e.every(function(t){return t.instance.def.disableTriggers})&&("touchend"===t.type&&t.preventDefault(),i=u,r=Z(n=t),a=r?n.changedTouches[0]:n,o=Date.now()-i.time,s=isNaN(i.x)?0:Math.abs(a.clientX-i.x),c=isNaN(i.y)?0:Math.abs(a.clientY-i.y),(0===n.button||r)&&!i.multiTouch&&s<=12&&c<=12&&o<=300))for(var n,i,r,a,o,s,c,l=e.length-1;0<=l;l--)if(e[l].instance.onBrushTap(t),h){h=!1;break}},i=[];i.push({key:"mousedown",listener:e}),i.push({key:"mouseup",listener:n}),"ontouchstart"in(t=p)&&"ontouchend"in t&&(i.push({key:"touchstart",listener:e}),i.push({key:"touchend",listener:n})),i.push({key:"mousemove",listener:function(t){for(var e=I(t),n=e.length-1;0<=n;n--)if(e[n].instance.onBrushOver(t),h){h=!1;break}}}),i.forEach(function(t){p.addEventListener(t.key,t.listener),o.push(t)}),W(v.interactions)}(),O(p),l.element=p),l}var Eo=function(t){var e=Kt(t);return e.prio=function(t){return t?e.default(t[0]):[e.default()]},e.types=function(){return e.getKeys()},e},Oo=Kt();var jo=function(t){return t.filter(function(t){return"number"==typeof t&&!isNaN(t)})},Po=function(t){return t.reduce(function(t,e){return t+e},0)},Fo={first:function(t){return t[0]},last:function(t){return t[t.length-1]},min:function(t){var e=jo(t);return e.length?Math.min.apply(null,e):NaN},max:function(t){var e=jo(t);return e.length?Math.max.apply(null,e):NaN},sum:function(t){var e=jo(t);return e.length?e.reduce(function(t,e){return t+e},0):NaN},avg:function(t){var e=jo(t),n=e.length;return n?Po(e)/n:NaN}};function Do(i,r,a,o){var s={},c=o.field||(void 0!==i.field?r.field(i.field):null);return Object.keys(a).forEach(function(t){var e=a[t],n=s[t]={};-1!==["number","string","boolean"].indexOf(Q(e))?(n.type="primitive",n.value=e):"function"==typeof e?(n.type="function",n.value=e,n.label=e,n.field=c):"object"===Q(e)&&(e.fields?n.fields=e.fields.map(function(t){return Do(i,r,{main:t},o).main}):void 0!==e.field?(n.type="field",n.field=r.field(e.field),n.value=n.field.value,n.label=n.field.label):c&&(n.value=c.value,n.label=c.label,n.field=c),"function"==typeof e.filter&&(n.filter=e.filter),void 0!==e.value&&(n.value=e.value),void 0!==e.label&&(n.label=e.label),"function"==typeof e.reduce?n.reduce=e.reduce:e.reduce?n.reduce=Fo[e.reduce]:n.field&&n.field.reduce&&(n.reduce="string"==typeof n.field.reduce?Fo[n.field.reduce]:n.field.reduce))}),s}function Lo(t,e){var n=Do(t,e,{main:{value:t.value,label:t.label,reduce:t.reduce,filter:t.filter}},{}).main;return{props:Do(t,e,t.props||{},n),main:n}}function Bo(t,e){var n=e.main,a=e.propsArr,o=e.props,i=[],s=n.field.formatter()||function(t){return t},c={};return a.forEach(function(t){c[t]=o[t].field?o[t].field.formatter():function(t){return t}}),i.push.apply(i,K(t.map(function(i){var t=i.items.map(function(t){return t.value}),e=n.reduce,r={value:e?e(t):t,source:i.items[0].source};return r.label=s(r.value),a.forEach(function(e){var t;t=i.items.map(function(t){return t[e].value});var n=o[e].reduce;r[e]={value:n?n(t):t},r[e].label=String(c[e](r[e].value)),i.items[0][e].source&&(r[e].source=i.items[0][e].source)}),r}))),i}function Wo(t){var e=t.cfg,n=t.itemData,i=t.obj,r=t.target,a=t.tracker,o="function"===t.trackType?e.trackBy(n):n[e.trackBy],s=a[o];s||(s=a[o]={items:[],id:o},r.push(s)),s.items.push(i)}function Io(t,e,n){var i=n.key,r={value:"function"==typeof t.value?t.value(e):void 0!==t.value?t.value:e};return r.label="function"==typeof t.label?t.label(e):void 0!==t.label?String(t.label):String(r.value),t.field&&(r.source={key:i,field:t.field.key()}),r}var $o=function(t){return t.filter(function(t){return"number"==typeof t&&!isNaN(t)})};var Vo=function(t){var e=t.source,n=t.data,i=t.cache,r=t.config;if(n){var a=n;"string"==typeof a&&(a=function(t){var e=t.data,n=t.config,i=e.split("\n"),r=i[0],a=i[1],o=",";if(n&&n.parse&&n.parse.delimiter)o=n.parse.delimiter;else if(r)for(var s=[/,/,/\t/,/;/],c=0;c<s.length;c++){var l=s[c];if(r&&a){if(l.test(r)&&l.test(a)&&r.split(l).length===a.split(l).length){o=l;break}}else l.test(r)&&(o=l)}return i.map(function(t){return t.split(o)})}({data:n,config:r})),Array.isArray(a)&&function(t){var e,n=t.source,i=t.data,r=t.cache,a=t.config,o=i,s=a&&a.parse;Array.isArray(i[0])?s&&!1===s.headers?e=i[0].map(function(t,e){return e}):(e=i[0],o=i.slice(1)):e=Object.keys(i[0]);var c,l=!!s&&"function"==typeof s.row&&s.row,u=e;u=s&&"function"==typeof s.fields?s.fields(u.slice()):e.map(function(t){return{key:t,title:t}}),Array.isArray(i[0])?c=u.map(function(){return[]}):(c={},u.forEach(function(t){c[t.key]=[]}));for(var h=0;h<o.length;h++){var f=l?l(o[h],h,u):o[h];if(f)if(Array.isArray(f))for(var d=0;d<u.length;d++)c[d].push(f[d]);else for(var g=0;g<u.length;g++)c[u[g].key].push(f[u[g].key])}for(var p=Array.isArray(c)?function(t){return c[t]}:function(t){return c[u[t].key]},y=0;y<u.length;y++){var v=p(y),m=$o(v),x=0<m.length,b=x?"measure":"dimension",w=x?Math.min.apply(Math,K(m)):NaN,k=x?Math.max.apply(Math,K(m)):NaN;r.fields.push(Kn(G({source:n,key:y,title:u[y].title,values:v,min:w,max:k,type:b},u[y]),{value:u[y].value,label:u[y].label}))}}({data:a,cache:i,source:e,config:r})}};function qo(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.key,n=t.data,i=t.config,r={fields:[]},o={key:function(){return e},raw:function(){return n},field:function(t){return function(t,e){var n=e.cache;if("number"==typeof t)return n.fields[t];for(var i=0;i<n.fields.length;i++)if(n.fields[i].key()===t)return n.fields[i];for(var r=0;r<n.fields.length;r++)if(n.fields[r].title()===t)return n.fields[r];return null}(t,{cache:r,matrix:n})},fields:function(){return r.fields.slice()},extract:function(t){return e=t,a=o,n=Array.isArray(e)?e:[e],y=[],n.forEach(function(p){void 0!==p.field&&function(){var t=a.field(p.field),o=a.key();if(!t)throw Error("Field '".concat(p.field,"' not found"));for(var e=Lo(p,a),s=e.props,n=e.main,c=Object.keys(s),l=!!p.trackBy,u=Q(p.trackBy),h={},f=[],d=t.items(),g=[],i=function(i){var r=d[i];if(n.filter&&!n.filter(r))return"continue";var a=Io(n,r,{key:o});c.forEach(function(t){var e=s[t],n=e.field?e.field.items()[i]:r;a[t]=Io(e,n,{key:o})}),l&&Wo({cfg:p,itemData:r,obj:a,target:f,tracker:h,trackType:u}),g.push(a)},r=0;r<d.length;r++)i(r);l?y.push.apply(y,K(Bo(f,{main:n,propsArr:c,props:s}))):y.push.apply(y,g)}()}),y;var e,a,n,y},hierarchy:function(){return null}};return Vo({key:e,data:n,config:i,cache:r}),o}qo.util={normalizeConfig:Lo,collect:Bo,track:Wo};var Uo=Kt();Uo.default("matrix"),Uo("matrix",qo),Uo("default",qo);var Ho=Kt();function Yo(t,e,n){return Math.max(t,Math.min(e,n))}function Xo(t){var e,n=t.item,i=t.boxWidth,r=t.boxPadding,a=t.rendwidth,o=t.rendheight,s="x",c="y",l="width",u="height",h=a,f=o;t.flipXY&&(s="y",c="x",l="height",u="width",h=o,f=a);var d,g,p,y,v,m,x,b,w,k,M,_,S,R,z=(d={start:n.start,end:n.end,minPx:n.box.minHeightPx,maxPx:f},g=d.start,p=d.end,y=d.minPx,v=void 0===y?.1:y,m=d.maxPx,x=void 0===m?1:m,b=Math.max(g,p),w=Math.min(g,p),k=Yo(-.1,1.2,b),M=Yo(-.1,1.2,w),_=k*x-M*x,{actualDiff:S=Math.max(v,_),startModifier:R=(S-_)/2,actualLow:M*x-R}),N=z.actualDiff,C=z.actualLow;return G({},n.box,(A(e={type:"rect"},s,(r+n.major)*h),A(e,c,C),A(e,u,N),A(e,l,i*h),A(e,"data",n.data||{}),A(e,"collider",{type:null}),e))}function Zo(t){var e,n=t.item,i=t.from,r=t.to,a=t.boxCenter,o=t.rendwidth,s=t.rendheight,c="x1",l="y1",u="x2",h="y2",f=o,d=s;return t.flipXY&&(c="y1",l="x1",u="y2",h="x2",f=s,d=o),G({},n.line,(A(e={type:"line"},h,Math.floor(i*d)),A(e,c,a*f),A(e,l,Math.floor(r*d)),A(e,u,a*f),A(e,"data",n.data||{}),A(e,"collider",{type:null}),e))}function Jo(t){var e,n=t.item,i=t.key,r=t.position,a=t.width,o=t.boxCenter,s=t.rendwidth,c=t.rendheight,l="x1",u="y1",h="x2",f="y2",d=s,g=c;t.flipXY&&(l="y1",u="x1",h="y2",f="x2",d=c,g=s);var p=a/2;return G({type:"line"},n[i],(A(e={},u,Math.floor(r*g)),A(e,l,(o-p)*d),A(e,f,Math.floor(r*g)),A(e,h,(o+p)*d),A(e,"r",p*d),A(e,"cx",o*d),A(e,"cy",r*g),A(e,"width",a*d),A(e,"data",n.data||{}),A(e,"collider",{type:null}),e))}function Go(t){for(var x=t.width,b=t.height,w=t.flipXY,k=t.resolved,M=t.keys,_=[],S=null,R=k.major.items,e=function(e,t){var n=R[e].data,i=[],r=null,a=null;void 0!==k.major.settings.binStart?(r=k.major.items[e].binStart,a=k.major.items[e].binEnd,S=k.major.settings.binStart.scale):r=(S=k.major.settings.major.scale)?k.major.items[e].major:0;var o=0;S?S.bandwidth?r-=(o=S.bandwidth())/2:o=a-r:o=1;var s=G({},{major:r,majorEnd:a},k.minor.items[e]);M.forEach(function(t){return s[t]=k[t].items[e]});var c,l,u,h,f=(c=o,l=s,u=w?b:x,h=Math.min(c*l.box.width,isNaN(l.box.maxWidthPx)?u:l.box.maxWidthPx/u),isNaN(l.box.minWidthPx)?h:Math.max(l.box.minWidthPx/u,h)),d=(o-f)/2,g=d+s.major+f/2,p=x,y=b;if(s.box.show&&O(s.start)&&O(s.end)&&i.push(Xo({item:s,boxWidth:f,boxPadding:d,rendwidth:p,rendheight:y,flipXY:w})),s.line.show&&O(s.min)&&O(s.start)&&i.push(Zo({item:s,from:s.min,to:s.start,boxCenter:g,rendwidth:p,rendheight:y,flipXY:w})),s.line.show&&O(s.max)&&O(s.end)&&i.push(Zo({item:s,from:s.max,to:s.end,boxCenter:g,rendwidth:p,rendheight:y,flipXY:w})),s.median.show&&O(s.med)&&i.push(Jo({item:s,key:"median",position:s.med,width:f,boxCenter:g,rendwidth:p,rendheight:y,flipXY:w})),s.whisker.show){var v=f*s.whisker.width;O(s.min)&&i.push(Jo({item:s,key:"whisker",position:s.min,width:v,boxCenter:g,rendwidth:p,rendheight:y,flipXY:w})),O(s.max)&&i.push(Jo({item:s,key:"whisker",position:s.max,width:v,boxCenter:g,rendwidth:p,rendheight:y,flipXY:w}))}var m={type:"container",data:n,collider:{type:"bounds"},children:i};_.push(m)},n=0,i=R.length;n<i;n++)e(n);return _}Ho("native",function(t,e,i){var n,r,a={chart:t,mediator:e,element:i},o=[],s=!0;function c(){"function"==typeof n.enable&&(n.enable=n.enable.bind(a)()),n.enable&&Object.keys(n.events).forEach(function(t){var e=n.events[t].bind(a);i.addEventListener(t,e),o.push({key:t,listener:e})})}function l(){o.forEach(function(t){var e=t.key,n=t.listener;i.removeEventListener(e,n)}),o=[]}return{get key(){return r},set:function(t){var e;r=(e=t).key,(n=e).events=n.events||[],void 0===n.enable&&(n.enable=!0),l(),s&&c()},off:function(){s=!1,l()},on:function(){s=!0,0===o.length&&c()},destroy:function(){l(),n=a=null}}});var Qo={line:{show:!0,stroke:"#000",strokeWidth:1},median:{show:!0,stroke:"#000",strokeWidth:1},whisker:{show:!0,stroke:"#000",strokeWidth:1,fill:"",type:"line",width:1},box:{show:!0,fill:"#fff",stroke:"#000",strokeWidth:1,strokeLinejoin:"miter",width:1,maxWidthPx:void 0,minWidthPx:1,minHeightPx:1}},Ko=Object.keys(Qo),ts={require:["chart","resolver"],defaultSettings:{settings:{},data:{},style:{box:"$shape",line:"$shape-guide",whisker:"$shape-guide",median:"$shape-guide--inverted"}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={}},beforeRender:function(t){this.rect=t.size},render:function(t){var e=t.data,n=this.rect,i=n.width,r=n.height,a="horizontal"===this.settings.settings.orientation,o=this.style,s=this.resolver,c=function(t){var e,n=t.keys,i=t.data,r=t.defaultSettings,a=t.style,o=t.settings,s=t.width,c=t.height,l=t.resolver,u=G(!0,{},r||{},a||{}),h={major:"horizontal"===o.orientation?c:s,minor:"horizontal"===o.orientation?s:c},f=o.major;e="object"===Q(f)&&"object"===Q(f.ref)&&void 0!==f.ref.start&&void 0!==f.ref.end?l.resolve({data:i,defaults:{start:0,end:1},scaled:h,settings:G(!0,{},{binStart:{scale:o.major.scale,ref:o.major.ref.start},binEnd:{scale:o.major.scale,ref:o.major.ref.end}})}):"object"===Q(f)&&void 0!==f.binStart&&void 0!==f.binEnd?l.resolve({data:i,defaults:{start:0,end:1},scaled:h,settings:G(!0,{},{binStart:{scale:o.major.scale,ref:"binStart"},binEnd:{scale:o.major.scale,ref:"binEnd"}},o.major)}):l.resolve({data:i,scaled:h,defaults:{major:.5},settings:{major:o.major}});for(var d,g=o.minor||{},p={major:e,minor:l.resolve({data:i,defaults:{start:0,end:1},scaled:h,settings:G(!0,{},{start:{scale:g.scale,ref:"start"},end:{scale:g.scale,ref:"end"},min:{scale:g.scale,ref:"min"},max:{scale:g.scale,ref:"max"},med:{scale:g.scale,ref:"med"}},g)})},y=0,v=n.length;y<v;y++)p[d=n[y]]=l.resolve({data:i,defaults:u[d],settings:o[d],scaled:h});return p}({keys:Ko,data:e,defaultSettings:Qo,style:o,settings:this.settings.settings,width:i,height:r,resolver:s}),l=c.settings;return Go({items:c.items,settings:l,width:i,height:r,flipXY:a,resolved:c,keys:Ko})}};var es={fill:"fill",stroke:"stroke",opacity:"opacity",strokeWidth:"stroke-width",strokeLinejoin:"stroke-linejoin",fontFamily:"font-family",fontSize:"font-size",baseline:"dominant-baseline",dominantBaseline:"dominant-baseline",anchor:"text-anchor",textAnchor:"text-anchor",maxWidth:"maxWidth",transform:"transform",strokeDasharray:"stroke-dasharray",id:"id"};function ns(t){for(var e=!(1<arguments.length&&void 0!==arguments[1])||arguments[1],n="",i=0;i<t.length;i++){var r=t[i];n+=0===i?"M".concat(r.x," ").concat(r.y):"L".concat(r.x," ").concat(r.y),n+=" "}return e&&(n+="Z"),n}function is(t,e,n,i){var r=n/2,a=t-i/2,o=e-i/2,s=t-r,c=e-r;return[{x:a,y:o},{x:a,y:c},{x:a+i,y:c},{x:a+i,y:o},{x:s+n,y:o},{x:s+n,y:o+i},{x:a+i,y:o+i},{x:a+i,y:c+n},{x:a,y:c+n},{x:a,y:o+i},{x:s,y:o+i},{x:s,y:o}]}function rs(t){return-t/180*Math.PI}function as(t){return e=rs(t),n=(.5*(Math.floor(e/Math.PI*2)+2)+.25)*Math.PI,i=Math.cos(Math.abs(n-e))*Math.sqrt(2),r=i*Math.cos(e),a=i*Math.sin(e),{x1:r<0?1:0,y1:a<0?1:0,x2:0<=r?r:r+1,y2:0<=a?a:a+1};var e,n,i,r,a}var os={up:0,down:180,left:90,right:-90};var ss=Kt();function cs(){var t,e,n,i,r,a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=ss.get(a.type);if(o){var s=o(a);return s.collider||(s.collider=(e=(t=a).x,n=t.y,i=t.size,{type:"rect",x:e-(r=i/2),y:n-r,width:i,height:i})),function(e){var n=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};Object.keys(n).forEach(function(t){void 0!==es[t]&&"transform"!==t&&(e[t]=n[t])})}(s,a),void 0!==a.data&&(s.data=a.data),s}return o}ss.add("circle",function(t){return{type:"circle",fill:"black",cx:t.x,cy:t.y,r:t.size/2,collider:{type:"circle"}}}),ss.add("diamond",function(t){var e=t.size,n=t.x-e/2,i=t.y-e/2;return{type:"path",fill:"black",d:ns([{x:n,y:i+e/2},{x:n+e/2,y:i},{x:n+e,y:i+e/2},{x:n+e/2,y:i+e},{x:n,y:i+e/2}])}}),ss.add("saltire",function(t){var e=rs(45),n=t.size/2,i=isNaN(t.width)?n/2:t.width,r=Math.min(i,n),a=t.size,o=Math.sin(Math.asin(-e))*(r/2);a+=2*(n/Math.sin(-e)-n),a-=2*o;var s={x:t.x,y:t.y};return{type:"path",fill:"black",d:ns(is(t.x,t.y,a,r).map(function(t){return ro(t,e,s)}))}}),ss.add("square",function(t){var e=t.size;return{type:"rect",fill:"black",x:t.x-e/2,y:t.y-e/2,width:e,height:e}}),ss.add("triangle",function(t){var e=t.size,n={x:t.x,y:t.y},i=os[t.direction]||0,r=e/2,a=t.x-r,o=t.y-r,s=[{x:a,y:o+e},{x:a+r,y:o},{x:a+e,y:o+e},{x:a,y:o+e}],c=rs(i);return{type:"path",fill:"black",d:ns(s=s.map(function(t){return ro(t,c,n)}))}}),ss.add("line",function(t){var e="vertical"===t.direction,n=t.size/2,i=t.x,r=t.y;return{type:"line",stroke:"black",strokeWidth:1,x1:i-(e?0:n),y1:r-(e?n:0),x2:i+(e?0:n),y2:r+(e?n:0)}}),ss.add("star",function(t){for(var e=t.size,n=[],i=e/2,r=t.points||5,a=Math.min(t.innerRadius||e/2,e)/2,o=isNaN(t.startAngle)?90:t.startAngle,s=360/r,c=1;c<=r;c++){var l=s*c+o,u=rs(l),h=rs(l+s/2),f=Math.sin(u),d=Math.cos(u),g=Math.sin(h),p=Math.cos(h);n.push({x:t.x+d*i,y:t.y+f*i}),n.push({x:t.x+p*a,y:t.y+g*a})}return{type:"path",fill:"black",d:ns(n)}}),ss.add("n-polygon",function(t){for(var e=[],n=t.size/2,i=Math.max(isNaN(t.sides)?6:t.sides,3),r=360/i,a=isNaN(t.startAngle)?0:t.startAngle,o=1;o<=i;o++){var s=rs(r*o+a),c=Math.sin(s),l=Math.cos(s);e.push({x:t.x+l*n,y:t.y+c*n})}return{type:"path",fill:"black",d:ns(e)}}),ss.add("cross",function(t){var e=t.x,n=t.y,i=t.size/2,r=isNaN(t.width)?i/2:t.width,a=Math.min(r,i);return{type:"path",fill:"black",d:ns(is(e,n,t.size,a))}}),ss.add("bar",function(t){var e={x:t.x,y:t.y},n="vertical"===t.direction,i=t.size/2,r=i/2/2,a=[{x:e.x-i,y:e.y+r},{x:e.x-i,y:e.y-r},{x:e.x+i,y:e.y-r},{x:e.x+i,y:e.y+r}];if(n){var o=rs(90);a=a.map(function(t){return ro(t,o,e)})}var s=L(a);return s.type="rect",s.fill="black",s.collider={type:"rect"},s});var ls={errorShape:{shape:"saltire",width:2,size:.5,fill:"#333",stroke:"#333",strokeWidth:0}},us={shape:"circle",label:"",fill:"#333",stroke:"#ccc",strokeWidth:0,strokeLinejoin:"miter",opacity:1,x:.5,y:.5,size:1,strokeDasharray:""},hs={maxPx:1e4,minPx:1,maxRelExtent:.1,minRelExtent:.01,maxRelDiscrete:1,minRelDiscrete:.1};function fs(t,e){return t&&"function"==typeof t.bandwidth?{isBandwidth:!0,value:Math.max(1,t.bandwidth()*e)}:{isBandwidth:!1,value:Math.max(1,e)}}var ds={require:["chart","resolver"],defaultSettings:{settings:{},data:{},animations:{enabled:!1,trackBy:function(t){return t.data.value}},style:{item:"$shape"}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(t){var e,n,i,r,a,o,s,c,l,u,h,f,d,g,p,y=t.data,v=this.resolver.resolve({data:y,defaults:G({},us,this.style.item),settings:this.settings.settings,scaled:{x:this.rect.width,y:this.rect.height}}),m=this.rect,x=m.width,b=m.height,w=G({},hs,this.settings.settings.sizeLimits),k=v.items,M=(e=v.settings.x,n=v.settings.y,i=x,r=b,a=w,o=fs(e?e.scale:void 0,i),s=fs(n?n.scale:void 0,r),c=Math.min(o.value*a[o.isBandwidth?"maxRelDiscrete":"maxRelExtent"],s.value*a[s.isBandwidth?"maxRelDiscrete":"maxRelExtent"]),l=Math.min(o.value*a[o.isBandwidth?"minRelDiscrete":"minRelExtent"],s.value*a[s.isBandwidth?"minRelDiscrete":"minRelExtent"]),{min:Math.max(1,Math.floor(l)),max:Math.max(1,Math.floor(c)),maxGlobal:a.maxPx,minGlobal:a.minPx});return u=k,h=this.rect,f=M,d=this.settings.shapeFn||cs,g=h.width,p=h.height,u.filter(function(t){return!isNaN(t.x+t.y)}).map(function(t){var e=j(t.size)?ls.errorShape:t,n=f.min+e.size*(f.max-f.min),i={type:"rect"===e.shape?"square":e.shape,label:t.label,x:t.x*g,y:t.y*p,fill:e.fill,size:Math.min(f.maxGlobal,Math.max(f.minGlobal,n)),stroke:e.stroke,strokeWidth:e.strokeWidth,strokeDasharray:e.strokeDasharray,opacity:e.opacity};e===t.errorShape&&(i.width=e.width);var r=d(i);return r.data=t.data,r})}};Math.PI;var gs={label:"",arc:1,show:!0,fill:"#333",stroke:"#ccc",strokeWidth:1,strokeLinejoin:"round",opacity:1,innerRadius:0,outerRadius:.8,cornerRadius:0,offset:0};function ps(t,e,y,v){var n=e.x,i=e.y,r=e.width,a=e.height,m=Mt(),x={x:n+r/2,y:i+a/2},b=Math.min(r,a)/2,w=Math.min(r,a)/2,k=w/100;return t.map(function(t,e){var n=y[e];n.type="path";var i=w*n.outerRadius,r=b*n.innerRadius;m.innerRadius(r),m.outerRadius(i),m.cornerRadius(k*n.cornerRadius),n.d=m(t);var a,o,s,c,l,u,h,f,d,g=m.centroid(t),p=n.offset?(a=g,o=n.offset,s=i,c=r,l=C(a,2),u=l[0],h=l[1],f=Math.sqrt(u*u+h*h),{x:(u/=f)*o*(d=s-c),y:(h/=f)*o*d}):{x:0,y:0};return n.transform="translate(".concat(p.x,", ").concat(p.y,") translate(").concat(x.x,", ").concat(x.y,")"),n.desc={share:t.value/v,slice:{start:t.startAngle,end:t.endAngle,innerRadius:r,outerRadius:i,offset:{x:x.x+p.x,y:x.y+p.y}}},n})}var ys={require:["chart","resolver"],defaultSettings:{settings:{startAngle:0,endAngle:2*Math.PI,padAngle:0,slice:{}},style:{slice:"$shape"},data:{}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(t){for(var e,n,i=t.data,r=[],a=[],o=this.settings.settings,s=this.resolver.resolve({data:i,defaults:G({},gs,this.style.slice),settings:o.slice}).items,c=0,l=0,u=s.length;l<u;l++){var h=(e=o,n=s[l],e.slice&&"arc"in e.slice?n.arc:n.data.value);0<h&&s[l].outerRadius>=s[l].innerRadius&&(r.push(h),a.push(s[l]),c+=h)}var f=function(){var g=At,p=Ct,y=null,v=rt(0),m=rt(pt),x=rt(0);function e(n){var t,e,i,r,a,o=n.length,s=0,c=new Array(o),l=new Array(o),u=+v.apply(this,arguments),h=Math.min(pt,Math.max(-pt,m.apply(this,arguments)-u)),f=Math.min(Math.abs(h)/o,x.apply(this,arguments)),d=f*(h<0?-1:1);for(t=0;t<o;++t)0<(a=l[c[t]=t]=+g(n[t],t,n))&&(s+=a);for(null!=p?c.sort(function(t,e){return p(l[t],l[e])}):null!=y&&c.sort(function(t,e){return y(n[t],n[e])}),t=0,i=s?(h-o*d)/s:0;t<o;++t,u=r)e=c[t],r=u+(0<(a=l[e])?a*i:0)+d,l[e]={data:n[e],index:t,value:a,startAngle:u,endAngle:r,padAngle:f};return l}return e.value=function(t){return arguments.length?(g="function"==typeof t?t:rt(+t),e):g},e.sortValues=function(t){return arguments.length?(p=t,y=null,e):p},e.sort=function(t){return arguments.length?(y=t,p=null,e):y},e.startAngle=function(t){return arguments.length?(v="function"==typeof t?t:rt(+t),e):v},e.endAngle=function(t){return arguments.length?(m="function"==typeof t?t:rt(+t),e):m},e.padAngle=function(t){return arguments.length?(x="function"==typeof t?t:rt(+t),e):x},e}().sortValues(null);return f.startAngle(o.startAngle),f.endAngle(o.endAngle),f.padAngle(o.padAngle),ps(f(r),G({},this.rect,{x:0,y:0}),a,c)}};var vs=function(n){function e(i){if(n[i.type]&&n[i.type].condition(i)){var t=n[i.type],r=void 0===t.conditionAppend||t.conditionAppend(i);t.items.forEach(function(t){var e=Math.round(i[t.key]),n=i[t.key]-e;i[t.key]=e,r&&"append"===t.type&&(0<n?i[t.key]+=.5:i[t.key]-=.5)})}}return void 0===n&&(n={line:{append:["x1","x2","y1","y2"],round:[],condition:function(t){return t.x1===t.x2||t.y1===t.y2},conditionAppend:function(t){return t.strokeWidth%2!=0}},rect:{append:["x","y"],round:["width","height"],condition:function(){return!0},conditionAppend:function(t){return t.strokeWidth%2!=0}}}),Object.keys(n).forEach(function(t){var e=n[t];e.items=[],e.append.forEach(function(t){e.items.push({key:t,type:"append"})}),e.round.forEach(function(t){e.items.push({key:t,type:"round"})})}),e.multiple=function(t){return t.forEach(function(t){return e(t)})},e}(),ms=function(){function y(){v(this,y),this.reset(),this.push.apply(this,arguments)}return x(y,[{key:"transposeCoordinate",value:function(t,e,n){if("number"==typeof e&&isFinite(e)){var i=t.substring(0,1);if("x"===i||"cx"===t)return e*this.width;if("width"===t)return e*this.width;if("r"===t)return e*(n?this.height:this.width);if("y"===i||"cy"===t)return e*this.height;if("height"===t)return e*this.height}return e}},{key:"push",value:function(){var t;return(t=this.storage).push.apply(t,arguments),this}},{key:"processItem",value:function(t){var e={},n=void 0!==t.flipXY?t.flipXY:this.flipXY,i=void 0!==t.crisp?t.crisp:this.crisp;if(t.fn&&"function"==typeof t.fn){var r=n?this.height:this.width,a=n?this.width:this.height;t=t.fn({width:r,height:a,flipXY:n});for(var o=Object.keys(t),s=0,c=o.length;s<c;s++){var l=o[s];e[y.evaluateKey(l,n)]=t[l]}}else for(var u=Object.keys(t),h=0,f=u.length;h<f;h++){var d=u[h],g=y.evaluateKey(d,n),p=this.transposeCoordinate(g,t[d],n);e[g]=p}return i&&vs(e),e}},{key:"output",value:function(){for(var t=[],e=0,n=this.storage.length;e<n;e++){var i=this.processItem(this.storage[e]);t.push(i)}return t}},{key:"reset",value:function(){this.storage=[],this.flipXY=!1,this.crisp=!1,this.width=0,this.height=0}}],[{key:"evaluateKey",value:function(t,e){if(e){var n=t.substring(0,1),i=t.substring(1);if("x"===n)return"y".concat(i);if("y"===n)return"x".concat(i);if("cx"===t)return"cy";if("cy"===t)return"cx";if("width"===t)return"height";if("height"===t)return"width"}return t}}]),y}();function xs(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(ms,e)}function bs(t,e){return t&&e?t.cachedTicks&&t.cachedTicks()||t.ticks({distance:e}):[]}var ws={created:function(){},require:["chart","renderer"],defaultSettings:{displayOrder:0,style:{ticks:"$guide-line",minorTicks:"$guide-line--minor"}},beforeRender:function(t){this.rect=t.size,this.blueprint=xs(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var e=this;if(this.x=this.settings.x?this.chart.scale(this.settings.x):null,this.y=this.settings.y?this.chart.scale(this.settings.y):null,Da(this,"x",this.rect.width),Da(this,"y",this.rect.height),!this.x&&!this.y)return[];this.settings.ticks=G({show:!0},this.style.ticks,this.settings.ticks||{}),this.settings.minorTicks=G({show:!1},this.style.minorTicks,this.settings.minorTicks||{}),this.lines={x:[],y:[]},this.lines.x=bs(this.x,this.rect.width),this.lines.y=bs(this.y,this.rect.height),this.lines.y=this.lines.y.map(function(t){return G(t,{flipXY:!0})});var n={};return K(this.lines.x).concat(K(this.lines.y)).forEach(function(t){(n=t.isMinor?e.settings.minorTicks:e.settings.ticks).show&&e.blueprint.push({type:"line",x1:t.position,y1:0,x2:t.position,y2:1,stroke:n.stroke||"black",strokeWidth:void 0!==n.strokeWidth?n.strokeWidth:1,strokeDasharray:void 0!==n.strokeDasharray?n.strokeDasharray:void 0,flipXY:t.flipXY||!1})}),this.blueprint.output()}};function ks(t){if(void 0===t)return 0;if("number"==typeof t&&isFinite(t))return t;if("string"==typeof t)switch(t){case"center":case"middle":return.5;case"bottom":case"right":return 1;case"top":case"left":default:return 0}return 0}function Ms(t){var e={value:t.value};return t.label&&(e.label=t.label.text),e}function _s(t){return void 0!==t.value}var Ss={require:["chart","renderer","dockConfig"],defaultSettings:{displayOrder:0,style:{oob:{show:!0,width:10,fill:"#1A1A1A",stroke:"transparent",strokeWidth:0,opacity:1,text:{fontFamily:"Arial",stroke:"transparent",fill:"#fff",strokeWidth:0,opacity:1},triangle:{fill:"#4D4D4D",stroke:"transparent",strokeWidth:0,opacity:1},padding:{x:28,y:5}},line:{stroke:"#000"},label:{strokeWidth:0}}},preferredSize:function(){return 30},beforeRender:function(t){this.rect=t.size,this.blueprint=xs(),this.blueprint.width=this.rect.width,this.blueprint.height=this.rect.height,this.blueprint.x=this.rect.x,this.blueprint.y=this.rect.y,this.blueprint.crisp=!0},render:function(){var n=this,e=this.settings;if(this.lines={x:[],y:[]},this.lines.x=e.lines&&e.lines.x||[],this.lines.y=e.lines&&e.lines.y||[],0===this.lines.x.length&&0===this.lines.y.length)return[];var i={x0:[],x1:[],y0:[],y1:[]};this.lines.x=this.lines.x.filter(_s).map(function(t){if(t.scale){var e=n.chart.scale(t.scale);return G(t,{scale:e,position:e(t.value)})}return G(t,{position:t.value})}),this.lines.y=this.lines.y.filter(_s).map(function(t){if(t.scale){var e=n.chart.scale(t.scale);return G(t,{scale:e,position:e(t.value),flipXY:!0})}return G(t,{position:t.value,flipXY:!0})}),this.lines.x=this.lines.x.filter(function(t){return!(t.position<0||1<t.position)||(i["x".concat(1<t.position?1:0)].push(Ms(t)),!1)}),this.lines.y=this.lines.y.filter(function(t){return!(t.position<0||1<t.position)||(i["y".concat(1<t.position?1:0)].push(Ms(t)),!1)});var r=[];return K(this.lines.x).concat(K(this.lines.y)).forEach(function(t){(!0===t.show||void 0===t.show)&&function(t){var e,n=t.chart,r=t.blueprint,i=t.renderer,a=t.p,o=t.settings,s=t.items,c=!0,l=!1,u=!1,h=!1,f=G(!0,{},o.style.line,a.line||{});if(e=r.processItem({type:"line",x1:a.position,y1:0,x2:a.position,y2:1,stroke:f.stroke||"black",strokeWidth:f.strokeWidth||1,flipXY:a.flipXY||!1}),a.label){var d,g=G(!0,{fill:"#000",fontFamily:"Arial",fontSize:"12px",opacity:1,maxWidth:1,maxWidthPx:9999,padding:5,background:{fill:"#fff",stroke:"transparent",strokeWidth:0,opacity:.5}},o.style.label||{},{fill:f.stroke},a.label),p={width:0,height:0},y="";if("string"==typeof a.formatter)d=n.formatter(a.formatter);else if("object"===Q(a.formatter))d=n.formatter(a.formatter);else if(void 0!==a.scale&&a.scale.data){var v=a.scale.data()&&a.scale.data().fields;d=v&&v[0]?v[0].formatter():null}d?y=" (".concat(d(a.value),")"):a.scale&&(y=" (".concat(a.value,")")),y&&(p=i.measureText({text:y,fontFamily:g.fontFamily,fontSize:g.fontSize}));var m=i.measureText({text:g.text||"",fontFamily:g.fontFamily,fontSize:g.fontSize}),x=m.width+p.width,b=Math.max(m.height,p.height),w=g.padding,k=ks(a.flipXY?g.vAlign:g.align),M=ks(a.flipXY?g.align:g.vAlign),_=Math.min(1+x+2*w,g.maxWidth*r.width,g.maxWidthPx),S=b+2*w,R=a.flipXY?S:_,z=a.flipXY?_:S;if((l=r.processItem({fn:function(t){var e=t.width,n=t.height,i=a.position*e-(a.flipXY?S:_)*(1-k);return{type:"rect",x:i=a.flipXY?i:Math.max(i,0),y:Math.max(Math.abs(M*n-z*M),0),width:a.flipXY?R:Math.min(R,r.width-i),height:z,stroke:g.background.stroke,strokeWidth:g.background.strokeWidth,fill:g.background.fill,opacity:g.background.opacity}},flipXY:a.flipXY||!1})).x<-1||l.x+l.width>r.width+1||l.y<-1||l.y+l.height>r.height+1)l=void 0;else{u={type:"text",text:g.text||"",fill:g.fill,opacity:g.opacity,fontFamily:g.fontFamily,fontSize:g.fontSize,x:l.x+w,y:l.y+l.height/2+b/3,maxWidth:l.width-2*w-p.width,anchor:"start"},y&&(h={type:"text",text:y||"",fill:g.fill,opacity:g.opacity,fontFamily:g.fontFamily,fontSize:g.fontSize,x:u.x+3+(l.width-(p.width+2*w)),y:u.y});for(var N=0,C=s.length;N<C;N++){var A=s[N];"rect"===A.type?bo(l,A)&&(c=!1):"line"===A.type&&a.flipXY===A.flipXY&&ko(l,A)&&(c=!1)}}}s.push(e),c&&l&&u&&(s.push(l,u),h&&s.push(h))}({chart:n.chart,blueprint:n.blueprint,renderer:n.renderer,p:t,settings:e,items:r})}),e.style.oob.show&&function(t){for(var g=t.blueprint,p=t.oob,e=t.settings,y=t.items,v=Object.keys(p),m=e.style.oob||{},n=function(t,e){var n=v[t],a=p[n];if(0<a.length){var o=n.charAt(1),s="y"===n.charAt(0),c=m.padding.x+m.width,l=m.padding.y+m.width,u="bottom";u=s?"1"===o?"bottom":"top":"1"===o?"right":"left";var i=g.processItem({fn:function(t){var e=t.width,n=t.height,i=o*e+("1"===o?-c:c),r=s?l:n-l;return"arc"===m.type?{type:"path",d:function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.8,"left"===i||"right"===i){var r="right"===i;return"\n      M ".concat(t," ").concat(e-n,"\n      A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(r?0:1,", ").concat(t," ").concat(e+n,"\n      L ").concat(r?t+n:t-n," ").concat(e," Z\n    ")}var a="bottom"===i;return"\n    M ".concat(t-n," ").concat(e,"\n    A ").concat(1.25*n," ").concat(1.25*n,", 0, 1, ").concat(a?1:0,", ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(a?e+n:e-n," Z\n  ")}(s?r:i,s?i:r,m.width,u),x:i,y:r,stroke:m.stroke,fill:m.fill,strokeWidth:m.strokeWidth||0}:{type:"circle",cx:i,cy:r,r:m.width,stroke:m.stroke,fill:m.fill,strokeWidth:m.strokeWidth||0,opacity:m.opacity,data:a}},flipXY:s}),r=i.cx||i.x,h=i.cy||i.y,f={type:"text",text:a.length||"",x:r-.4*m.width,y:h+.4*m.width,fontFamily:m.text.fontFamily,fontSize:"".concat(1.3*m.width,"px"),stroke:m.text.stroke,fill:m.text.fill,strokeWidth:m.text.strokeWidth||0,opacity:m.text.opacity},d={type:"path",d:function(t,e,n){var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:"bottom";if(n*=.75,"left"===i||"right"===i){var r="right"===i;return"\n      M ".concat(t+=r?1.5*n:-1.5*n," ").concat(e-n,"\n      L ").concat(t," ").concat(e+n,"\n      L ").concat(r?t+n:t-n," ").concat(e," Z\n    ")}var a="bottom"===i;return e+=a?1.5*n:-1.5*n,"\n    M ".concat(t-n," ").concat(e,"\n    L ").concat(t+n," ").concat(e,"\n    L ").concat(t," ").concat(a?e+n:e-n," Z\n  ")}(r,h,m.width,u),x:r,y:h,stroke:m.triangle.stroke,fill:m.triangle.fill,strokeWidth:m.triangle.strokeWidth||0,opacity:m.triangle.opacity};y.push(i,f,d)}},i=0,r=v.length;i<r;i++)n(i)}({blueprint:this.blueprint,oob:i,settings:e,items:r}),r}};function Rs(t){var e={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===t.align||"bottom"===t.align?(e.x1=t.innerRect.x-t.outerRect.x,e.x2=t.innerRect.width+t.innerRect.x,e.y1=e.y2="top"===t.align?t.innerRect.height-t.padding:t.padding):(e.x1=e.x2="left"===t.align?t.innerRect.width-t.padding:t.padding,e.y1=t.innerRect.y-t.outerRect.y,e.y2=t.innerRect.height+t.innerRect.y),function(t,e){G(t,e.style);var n=t.strokeWidth/2;"top"===e.align?(t.y1-=n,t.y2-=n):"bottom"===e.align?(t.y1+=n,t.y2+=n):"left"===e.align?(t.x1-=n,t.x2-=n):"right"===e.align&&(t.x1+=n,t.x2+=n)}(e,t),e}function zs(t,e,n){var i,r,a,o,s,c,l,u,h,f,d,g,p;n.layered||!n.stepSize?(p=e).collider={type:"polygon",vertices:[{x:p.boundingRect.x,y:p.boundingRect.y},{x:p.boundingRect.x+p.boundingRect.width,y:p.boundingRect.y},{x:p.boundingRect.x+p.boundingRect.width,y:p.boundingRect.y+p.boundingRect.height},{x:p.boundingRect.x,y:p.boundingRect.y+p.boundingRect.height}]}:n.tilted?(i=e,a=(r=n).angle*(Math.PI/180),o=Math.max(r.stepSize/2,i.boundingRect.height/2),s="start"===i.anchor,c="end"===i.anchor&&a<0,l="start"===i.anchor&&0<=a,u=i.boundingRect.y+(l||c?i.boundingRect.height:0),h=[{x:i.x-o,y:u},{x:i.x+o,y:u}].map(function(t){return ro(t,a,{x:i.x,y:i.y})}),f={x:s?i.boundingRect.x+i.boundingRect.width+10:i.boundingRect.x-10,y:i.boundingRect.y+i.boundingRect.height},d={x:s?i.boundingRect.x+i.boundingRect.width+10:i.boundingRect.x-10,y:i.boundingRect.y},g=0<=a?[f,d]:[d,f],h.push.apply(h,g),i.collider={type:"polygon",vertices:h}):function(t,e,n){if("bottom"===n.align||"top"===n.align){var i=t.position*n.innerRect.width+(n.innerRect.x-n.outerRect.x-n.stepSize/2);e.collider={type:"rect",x:i,y:0,width:i<0?n.stepSize+i:n.stepSize,height:n.innerRect.height}}else{var r=t.position*n.innerRect.height+(n.innerRect.y-n.outerRect.y-n.stepSize/2);e.collider={type:"rect",x:0,y:r,width:n.innerRect.width,height:r<0?n.stepSize+r:n.stepSize}}var a=e.collider;a.x=Math.max(a.x,0),a.y=Math.max(a.y,0);var o=a.x+a.width-(n.outerRect.x+n.outerRect.width);a.width=0<o?a.width-o:a.width;var s=a.y+a.height-(n.outerRect.y+n.outerRect.height);a.height=0<s?a.height-s:a.height}(t,e,n)}function Ns(t,e){var n=isNaN(t.style.align)?.5:Math.min(Math.max(t.style.align,0),1),i=0;if(t.tilted)i=t.stepSize*n;else{var r=e?t.textRect.height:t.textRect.width;i=Math.max(0,t.stepSize-r)*n}return i}function Cs(t,e){var n,i,r,a,o,s,c,l={type:"text",text:(n=t.label,"string"==typeof n||"number"==typeof n?n:"-"),x:0,y:0,maxWidth:e.maxWidth,maxHeight:e.maxHeight};return"top"===e.align||"bottom"===e.align?(l.x=t.start*e.innerRect.width+(e.innerRect.x-e.outerRect.x)+Ns(e,!1),l.y="top"===e.align?e.innerRect.height:0,l.anchor=e.stepSize?"start":"middle",l.x+=isNaN(e.style.offset)?0:+e.style.offset):(l.y=t.start*e.innerRect.height+(e.innerRect.y-e.outerRect.y)+Ns(e,!0),l.x="left"===e.align?e.innerRect.width:0,l.anchor="left"===e.align?"end":"start",l.baseline=e.stepSize?"text-before-edge":"central",l.y+=isNaN(e.style.offset)?0:+e.style.offset),i=l,r=e,["fill","fontSize","fontFamily"].forEach(function(t){i[t]=r.style[t]}),function(t,e){if(!e.tilted&&!e.stepSize)if("top"===e.align||"bottom"===e.align){var n=e.outerRect.width,i=Math.min(.75*e.maxWidth/2,e.textRect.width/2),r=t.x-i,a=t.x+i;r<0?(t.anchor="start",t.x=e.innerRect.x-e.outerRect.x,t.maxWidth*=.75):n<a&&(t.anchor="end",t.x=e.innerRect.width+e.innerRect.x,t.maxWidth*=.75)}else{var o=e.outerRect.height,s=e.maxHeight/2,c=t.y-s,l=t.y+s;c<0?(t.y=e.innerRect.y-e.outerRect.y,t.baseline="text-before-edge"):o<l&&(t.y=e.innerRect.height+(e.innerRect.y-e.outerRect.y),t.baseline="text-after-edge")}}(l,e),a=l,"top"===(o=e).align?a.y-=o.padding:"bottom"===o.align?a.y+=o.padding+o.maxHeight:"left"===o.align?a.x-=o.padding:"right"===o.align&&(a.x+=o.padding),function(t,e){if(e.tilted){var n=-e.angle,i=n*(Math.PI/180);"bottom"===e.align?(t.x-=e.maxHeight*Math.sin(i)/2,t.y-=e.maxHeight,t.y+=e.maxHeight*Math.cos(i)/2):t.x-=e.maxHeight*Math.sin(i)/3,t.transform="rotate(".concat(n,", ").concat(t.x,", ").concat(t.y,")"),t.anchor="bottom"===e.align==e.angle<0?"start":"end";var r=Math.cos(i)*e.maxWidth;if("bottom"===e.align==e.angle<0){var a=e.outerRect.width-e.paddingEnd;a<t.x+r&&(t.maxWidth=(a-t.x-10)/Math.cos(i))}else{var o=e.paddingEnd;t.x-r<o&&(t.maxWidth=(t.x-o-10)/Math.cos(i))}}}(l,e),c=e,(s=l).boundingRect=c.textBounds(s),zs(t,l,e),l}function As(t,e){var n,i,r,a,o,s={type:"line",x1:0,x2:0,y1:0,y2:0,collider:{type:null}};return"top"===e.align||"bottom"===e.align?(s.x1=s.x2=t.position*e.innerRect.width+(e.innerRect.x-e.outerRect.x),s.y1="top"===e.align?e.innerRect.height:0,s.y2="top"===e.align?s.y1-e.tickSize:s.y1+e.tickSize):(s.y1=s.y2=t.position*e.innerRect.height+(e.innerRect.y-e.outerRect.y),s.x1="left"===e.align?e.innerRect.width:0,s.x2="left"===e.align?s.x1-e.tickSize:s.x1+e.tickSize),G(s,e.style),n=s,"top"===(i=e).align?(n.y1-=i.padding,n.y2-=i.padding):"bottom"===i.align?(n.y1+=i.padding,n.y2+=i.padding):"left"===i.align?(n.x1-=i.padding,n.x2-=i.padding):"right"===i.align&&(n.x1+=i.padding,n.x2+=i.padding),a=e,o=(r=s).strokeWidth/2,r.x1===a.innerRect.width?(r.x1-=o,r.x2-=o):0===r.x1?(r.x1+=o,r.x2+=o):r.y1===a.innerRect.height?(r.y1-=o,r.y2-=o):0===r.y1&&(r.y1+=o,r.y2+=o),s}function Ts(t){return!t.isMinor}function Es(t){var e,n,i,r,a,o=t.rect,s=t.state,c=t.majorTicks,l=t.measure;return t.horizontal?function(t){for(var e=t.majorTicks,n=t.measureText,i=t.rect,r="layered"===t.state.labels.activeMode?2:1,a=i.width,o=e.map(function(t){return t.label}).map(function(t){return"".concat(t.slice(0,1)).concat(1<t.length?"…":"")}).map(n).map(function(t){return t.width}),s=0;s<e.length;++s){var c=e[s];if(r*a*Math.abs(c.start-c.end)<o[s])return!0}return!1}({majorTicks:c,measureText:l,rect:o,state:s}):(n=(e={majorTicks:c,measureText:l,rect:o,state:s}).majorTicks,i=e.measureText,r=e.rect.height,a=i("M").height,!(n.length<2)&&r*Math.abs(n[0].position-n[1].position)<a)}function Os(t){var e=t.value,n=t.maxValue,i=t.minValue,r=t.range,a=t.modifier;return isNaN(r)||isNaN(a)||(e=r*a),n<e&&(e=n),e<i&&(e=i),e}function js(t){var e=t.isDiscrete,i=t.rect,n=t.formatter,r=t.measureText,a=t.scale,o=t.settings,s=t.state,c=0,l={left:0,top:0,right:0,bottom:0},u=o.labels,h=u.maxLengthPx,f=u.minLengthPx;if(o.labels.show){var d,g,p=o.align,y="top"===p||"bottom"===p,v=y?i.width:i.height,m=a.ticks({settings:o,distance:v,formatter:n}).filter(Ts),x=function(t){var e=r({text:t,fontSize:o.labels.fontSize,fontFamily:o.labels.fontFamily});return e.width=Os({value:e.width,maxValue:h,minValue:f}),e};if(e&&y&&"auto"===o.labels.mode&&(!function(t){var e=t.majorTicks,n=t.measure,i=t.rect,r=t.state,a=t.settings.labels.maxGlyphCount,o="layered"===r.labels.activeMode?2:1,s=n("…").width,c=i.width;if(isNaN(a))for(var l=0;l<e.length;l++){var u=e[l],h=u.label,f=n(h).width*(1<h.length?.7:1);if(o*c*Math.abs(u.start-u.end)<f+s)return!0}else if(o*c*e.reduce(function(t,e){return Math.min(Math.abs(e.start-e.end),t)},1/0)<.7*n("M").width*a+s)return!0;return!1}({majorTicks:m,measure:x,rect:i,state:s,settings:o})?s.labels.activeMode="horizontal":s.labels.activeMode="tilted"),e&&"tilted"!==s.labels.activeMode&&Es({rect:i,state:s,majorTicks:m,measure:x,horizontal:y}))return{size:Math.max(i.width,i.height),isToLarge:!0};if("tilted"===s.labels.activeMode){var b=Math.abs(o.labels.tiltAngle)*(Math.PI/180);d=function(t){return Os({value:t.width,maxValue:h,minValue:f})*Math.sin(b)+t.height*Math.cos(b)}}else d=y?function(t){return t.height}:function(t){return Os({value:t.width,maxValue:h,minValue:f})};if(y&&"tilted"!==s.labels.activeMode)g=["M"];else if(isNaN(o.labels.maxGlyphCount))g=m.map(function(t){return t.label});else{for(var w="",k=0;k<o.labels.maxGlyphCount;k++)w+="M";g=[w]}var M=g.map(x),_=M.map(d),S=Math.max.apply(Math,K(_).concat([0]));if(c+=S,c+=o.labels.margin,"layered"===s.labels.activeMode&&(c*=2),"tilted"===s.labels.activeMode){var R="bottom"===o.align==0<=o.labels.tiltAngle,z=Math.abs(o.labels.tiltAngle)*(Math.PI/180),N=(S-r("M").height*Math.cos(z))/Math.sin(z),C=Math.min(o.labels.maxEdgeBleed,Math.max.apply(Math,K(M.map(function(t){return Math.min(N,t.width)*Math.cos(z)+t.height}).map(function(t,e){var n=m[e]?m[e].position:0;return R?t-n*i.width:t-(1-n)*i.width})).concat([0])))+o.paddingEnd;if(l[R?"left":"right"]=C,e&&function(t){var e=t.majorTicks,n=t.measureText,i=t.rect,r=t.bleedSize,a=t.angle;if(e.length<2)return!1;if(0===a)return!0;var o=Math.abs(a),s=(i.width-r)*Math.abs(e[0].position-e[1].position),c=n("M").height,l=1/s;return Math.sin(o*(Math.PI/180))/l<c}({majorTicks:m,measureText:r,rect:i,bleedSize:C,angle:o.labels.tiltAngle}))return{size:Math.max(i.width,i.height),isToLarge:!0}}}return{size:c,edgeBleed:l}}function Ps(t){var e=0;return e+=t.paddingStart,e+=t.line.show?t.line.strokeWidth:0,e+=t.ticks.show?t.ticks.margin:0}function Fs(t){var e=0;return e+=t.ticks.show?t.ticks.tickSize:0,e+=Ps(t)+t.labels.margin}function Ds(t){return t.filter(function(t){return!t.isMinor})}function Ls(t,e){return t.map(function(t){return As(t,e)})}function Bs(t,e){return e?Math.abs(e.end-e.start):t.bandwidth()}function Ws(t){var e=t.measureText,n=t.settings,i=t.innerRect,r=t.scale,a=t.tilted,o=t.layered,s=t.tick,c=e({text:"M",fontSize:n.labels.fontSize,fontFamily:n.labels.fontFamily}).height,l=Bs(r,s),u={width:0,height:c};if("left"===n.align||"right"===n.align)u.width=i.width-Fs(n)-n.paddingEnd;else if(o)u.width=l*i.width*2;else if(a){var h=Math.abs(n.labels.tiltAngle)*(Math.PI/180);u.width=(i.height-Fs(n)-n.paddingEnd-c*Math.cos(h))/Math.sin(h)}else u.width=l*i.width;return u.width=Os({value:u.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),u}function Is(t){var e=t.measureText,n=t.settings,i=t.innerRect,r=t.ticks,a=t.tilted,o=t.layered,s=e({text:"M",fontSize:n.labels.fontSize,fontFamily:n.labels.fontFamily}).height,c={width:0,height:s};if("left"===n.align||"right"===n.align)c.width=i.width-Fs(n)-n.paddingEnd;else if(o)c.width=i.width/Ds(r).length*.75*2;else if(a){var l=Math.abs(n.labels.tiltAngle)*(Math.PI/180);c.width=(i.height-Fs(n)-n.paddingEnd-s*Math.cos(l))/Math.sin(l)}else c.width=i.width/Ds(r).length*.75;return c.width=Os({value:c.width,maxValue:n.labels.maxLengthPx,minValue:n.labels.minLengthPx}),c}function $s(t){var N,C=!1;function e(){return N=Is,C=!0,e}function n(){return N=Ws,n}function i(t){var e,n,i,r,a,o,s,c,l,u,h=t.settings,f=t.scale,d=t.innerRect,g=t.outerRect,p=t.measureText,y=t.ticks,v=t.state,m=t.textBounds,x=[],b=Ds(y),w=y.filter(function(t){return t.isMinor}),k={innerRect:d,align:h.align,outerRect:g},M="tilted"===v.labels.activeMode,_="layered"===v.labels.activeMode;if(h.line.show&&(k.style=h.line,k.padding=h.paddingStart,x.push(Rs(k))),h.ticks.show&&(k.style=h.ticks,k.tickSize=h.ticks.tickSize,k.padding=Ps(h),e=Ls(b,k)),h.labels.show){var S=Fs(h);k.style=h.labels,k.padding=S,k.tilted=M,k.layered=_,k.angle=h.labels.tiltAngle,k.paddingEnd=h.paddingEnd,k.textBounds=m;var R=function(t){var e,n,i,r,a,o,s,c=N({measureText:p,settings:h,innerRect:d,ticks:y,scale:f,tilted:M,layered:_,tick:t});k.maxWidth=c.width,k.maxHeight=c.height,k.textRect=(e={tick:t,measureText:p,style:k.style},n=e.style,(0,e.measureText)({text:e.tick.label,fontSize:n.fontSize,fontFamily:n.fontFamily})),k.stepSize=(r=(i={innerRect:d,scale:f,ticks:y,settings:h,tick:t}).innerRect,a=i.scale,o=i.settings,s=i.tick,("top"===o.align||"bottom"===o.align?r.width:r.height)*Bs(a,s))},z=[];z=!_||"top"!==h.align&&"bottom"!==h.align?(n=k,i=R,b.map(function(t){i(t);var e=Cs(t,n);return e.data=t.data,e})):(r=b,o=h,s=R,c=(a=k).padding,l=Fs(o),r.map(function(t,e){s(t);var n=l+a.maxHeight+o.labels.margin;a.layer=e%2,a.padding=e%2==0?c:n;var i=Cs(t,a);return i.data=t.data,i})),C&&!k.tilted&&function(t,e){for(var n,i,r=0;r<=t.length-1;r++)for(var a=r+1;a<=Math.min(r+5,r+(t.length-1));a++)t[r]&&t[a]&&(n=t[r],i=t[a],bo(n.boundingRect,i.boundingRect))&&(a===t.length-1?(t.splice(r,1),e&&e.splice(r,1)):(t.splice(a,1),e&&e.splice(a,1)),a--,r--)}(z,e),x.push.apply(x,K(z))}return h.minorTicks&&h.minorTicks.show&&0<w.length&&(k.style=h.minorTicks,k.tickSize=h.minorTicks.tickSize,k.padding=(u=h).line.strokeWidth+u.minorTicks.margin,x.push.apply(x,K(Ls(w,k)))),e&&x.push.apply(x,K(e)),x}return n.build=e.build=i,t?n():e()}var Vs={labels:{show:!0,tiltAngle:40,maxEdgeBleed:1/0,margin:4,maxLengthPx:150,minLengthPx:0,mode:"auto",maxGlyphCount:NaN,align:.5,offset:0},ticks:{show:!1,margin:0,tickSize:4},line:{show:!1},paddingStart:0,paddingEnd:10,align:"auto"},qs={labels:{show:!0,margin:4,maxLengthPx:150,minLengthPx:0,align:.5,offset:0},ticks:{show:!0,margin:0,tickSize:8},minorTicks:{show:!1,tickSize:3,margin:0},line:{show:!0},paddingStart:0,paddingEnd:10,align:"auto"};var Us={require:["chart","renderer","dockConfig"],defaultSettings:{displayOrder:0,prioOrder:0,settings:{},style:{labels:"$label",ticks:"$guide-line",minorTicks:"$guide-line--minor",line:"$guide-line"}},created:function(){this.state={isDiscrete:!!this.scale.bandwidth,isHorizontal:!1,labels:{activeMode:"horizontal"},ticks:[],innerRect:{width:0,height:0,x:0,y:0},outerRect:{width:0,height:0,x:0,y:0},defaultDock:void 0,concreteNodeBuilder:void 0,settings:void 0},this.state.isDiscrete?this.state.defaultDock="bottom":this.state.defaultDock="left",this.setState(this.settings)},setState:function(){var t,e,n,i,r,a,o,s,c,l,u,h,f,d,g;this.state.isDiscrete=!!this.scale.bandwidth,this.state.settings=(a=(t=this).state,o=t.style,s=t.settings,c=G(!0,{},a.isDiscrete?Vs:qs,o),l=G(!0,{},c,s.settings),u=s.dock||a.defaultDock,l.dock=u,l.align=(e=s.settings.align,n=u,r=["left","right"],-1!==(i=["top","bottom"]).indexOf(e)&&-1===r.indexOf(n)?e:-1!==r.indexOf(e)&&-1===i.indexOf(n)?e:n),l.labels.tiltAngle=Math.max(-90,Math.min(l.labels.tiltAngle,90)),l),this.state.concreteNodeBuilder=$s(this.state.isDiscrete),this.dockConfig.dock=this.state.settings.dock,this.state.isHorizontal="top"===this.state.settings.align||"bottom"===this.state.settings.align,this.state.labels.activeMode=(h=this.state,f=this.state.settings,d=this.state.isDiscrete,g=f.labels.mode,d&&h.isHorizontal?"auto"===g?h.labels.activeMode:-1!==["layered","tilted"].indexOf(f.labels.mode)&&-1!==["top","bottom"].indexOf(f.dock)?g:"horizontal":"horizontal")},preferredSize:function(t){var e=this.formatter,n=this.state,i=this.scale,r=this.state.isHorizontal?t.inner.width:t.inner.height;return this.state.pxScale=La(i,r),function(t){var e=t.isDiscrete,n=t.rect,i=t.formatter,r=t.measureText,a=t.scale,o=t.settings,s=0,c=js({isDiscrete:e,rect:n,formatter:i,measureText:r,scale:a,settings:o,state:t.state}),l=c.size,u=c.edgeBleed;if(s+=l,c.isToLarge)return{size:s};if(o.ticks.show&&(s+=o.ticks.margin,s+=o.ticks.tickSize),o.minorTicks&&o.minorTicks.show){var h=o.minorTicks.margin+o.minorTicks.tickSize;s<h&&(s=h)}return o.line.show&&(s+=o.line.strokeWidth),s+=o.paddingStart,{size:s+=o.paddingEnd,edgeBleed:u}}({isDiscrete:this.state.isDiscrete,rect:t.inner,formatter:e,measureText:this.renderer.measureText,scale:this.state.pxScale,settings:this.state.settings,state:n})},beforeUpdate:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).settings;this.setState(t)},resize:function(t){var e,n,i,r=t.inner,a=t.outer,o=G({},r,(e={align:this.state.settings.align,inner:r},n=e.align,i=e.inner,"left"===n?{x:i.width+i.x}:"right"===n||"bottom"===n?i:{y:i.y+i.height})),s=a||o;return G(this.state.innerRect,o),G(this.state.outerRect,s),a},beforeRender:function(){var t=this.scale,e=this.formatter,n=this.state.isHorizontal?this.state.innerRect.width:this.state.innerRect.height;this.state.pxScale=La(t,n),this.state.ticks=this.state.pxScale.ticks({distance:n,formatter:e})},render:function(){var t=this.state,e=[];return e.push.apply(e,K(this.state.concreteNodeBuilder.build({settings:this.state.settings,scale:this.state.pxScale,innerRect:this.state.innerRect,outerRect:this.state.outerRect,measureText:this.renderer.measureText,textBounds:this.renderer.textBounds,ticks:this.state.ticks,state:t}))),vs.multiple(e),e}};function Hs(t,e,n){var i="";if("function"==typeof t)i=t();else if("string"==typeof t)i=t;else if(n){i=(n.data().fields||[]).map(function(t){return t.title()}).join(e)}return i}var Ys={require:["renderer","chart"],defaultSettings:{dock:"bottom",displayOrder:0,prioOrder:0,settings:{paddingStart:5,paddingEnd:5,paddingLeft:0,paddingRight:0,anchor:"center",join:", ",maxLengthPx:NaN},style:{text:"$title"}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.definitionSettings=this.settings.settings;var t=this.settings.text,e=this.definitionSettings.join;this.title=Hs(t,e,this.scale)},preferredSize:function(){return this.renderer.measureText({text:this.title,fontSize:this.style.text.fontSize,fontFamily:this.style.text.fontFamily}).height+this.definitionSettings.paddingStart+this.definitionSettings.paddingEnd},beforeRender:function(t){G(this.rect,t.size)},render:function(){var t=this.title,e=this.definitionSettings,n=this.rect,i=[];return i.push(function(t){var e,n,i,r=t.title,a=t.definitionSettings,o=t.dock,s=t.rect,c=t.measureText,l=t.style,u={type:"text",text:r,x:0,y:0,dx:0,dy:0,anchor:(e=o,n=a.anchor,i="middle","left"===e?"top"===n?i="end":"bottom"===n&&(i="start"):"right"===e?"top"===n?i="start":"bottom"===n&&(i="end"):"left"===n?i="start":"right"===n&&(i="end"),i),baseline:"alphabetical"};G(u,l.text);var h=c(u);if("top"===o||"bottom"===o){var f=s.width/2;"left"===a.anchor?f=a.paddingLeft||0:"right"===a.anchor&&(f=s.width-(a.paddingRight||0)),u.x=f,u.y="top"===o?s.height-a.paddingStart:a.paddingStart+h.height,u.dy="top"===o?-h.height/6:-h.height/3,u.maxWidth=.8*s.width}else{var d=s.height/2;"top"===a.anchor?d=a.paddingStart:"bottom"===a.anchor&&(d=s.height-a.paddingStart),u.y=d,u.x="left"===o?s.width-a.paddingStart:a.paddingStart,u.dx="left"===o?-h.height/3:h.height/3;var g="left"===o?270:90;u.transform="rotate(".concat(g,", ").concat(u.x+u.dx,", ").concat(u.y+u.dy,")"),u.maxWidth=.8*s.height}return isNaN(a.maxLengthPx)||(u.maxWidth=Math.min(u.maxWidth,a.maxLengthPx)),u}({title:t,dock:this.settings.dock,definitionSettings:e,rect:n,measureText:this.renderer.measureText,style:this.style})),i},beforeUpdate:function(t){t.settings&&(G(this.settings,t.settings),this.definitionSettings=t.settings.settings);var e=this.settings.text,n=this.definitionSettings.join;this.title=Hs(e,n,this.scale)}};function Xs(t,e){var o,n=t.settings.dock,s=t.settings.settings.invert,c="top"===n||"bottom"===n,i=c?"width":"height",l=t.rect[i],u=t.chart.scroll(t.settings.scroll),r=e[c?"x":"y"];s&&(r=l-r);var a=u.getState();o={startOffset:r,startScroll:a.start,swipe:!1};var h=r/l*(a.max-a.min)+a.min;h<a.start?o.startScroll=h:h>a.start+a.viewSize&&(o.startScroll=h-a.viewSize);return{update:function(t){var e=t[c?"x":"y"];if(s&&(e=l-e),!o.swipe){if(Math.abs(o.startOffset-e)<=1)return;o.swipe=!0}var n=u.getState(),i=(e-o.startOffset)/l*(n.max-n.min),r=o.startScroll+i;u.moveTo(r)},end:function(t){var e=t[c?"x":"y"];s&&(e=l-e);var n=u.getState();if(o.swipe){var i=(e-o.startOffset)/l*(n.max-n.min),r=o.startScroll+i;u.moveTo(r)}else{var a=e/l*(n.max-n.min)+n.min-n.viewSize/2;u.moveTo(a)}}}}function Zs(t,e){var n=e.element().getBoundingClientRect();return{x:t.center.x-n.left,y:t.center.y-n.top}}var Js={require:["chart","renderer"],on:{panStart:function(t){var e=Zs(t,this.renderer),n={x:e.x-t.deltaX,y:e.y-t.deltaY};this.currentMove=Xs(this,n),this.currentMove.update(e)},panMove:function(t){if(this.currentMove){var e=Zs(t,this.renderer);this.currentMove.update(e)}},panEnd:function(t){if(this.currentMove){var e=Zs(t,this.renderer);this.currentMove.end(e),this.currentMove=null}},panCancel:function(){this.currentMove=null},tap:function(t){var e=Zs(t,this.renderer);Xs(this,e).end(e)}},defaultSettings:{settings:{backgroundColor:"#eee",thumbColor:"#ccc",width:16}},created:function(){this.rect={x:0,y:0,width:0,height:0}},preferredSize:function(t){var e=this.chart.scroll(this.settings.scroll).getState();return e.viewSize>=e.max-e.min?Math.max(t.width,t.height):this.settings.settings.width},resize:function(t){var e=t.inner;return this.rect=e},render:function(t){var e,n=this.settings.dock,i=this.settings.settings.invert,r="top"===n||"bottom"===n,a=r?"width":"height",o=this.rect[a],s=this.chart.scroll(this.settings.scroll).getState(),c=o*(s.start-s.min)/(s.max-s.min),l=o*s.viewSize/(s.max-s.min);return i&&(c=o-c-l),t("div",{style:{position:"relative",width:"100%",height:"100%",background:this.settings.settings.backgroundColor,pointerEvents:"auto"}},[].concat(t("div",{class:"scroller",style:(e={position:"absolute"},A(e,r?"left":"top","".concat(c,"px")),A(e,r?"top":"left","25%"),A(e,r?"height":"width","50%"),A(e,a,"".concat(Math.max(1,l),"px")),A(e,"background",this.settings.settings.thumbColor),e)})))},renderer:"dom"};var Gs=5,Qs=0;function Ks(t){var e=t.h,n=t.isVertical,i=t.value,r=t.pos,a=t.align,o=t.borderHit,s=t.state,c=t.idx,l="end"!==a,u=l?{left:"0",top:"0"}:{right:"0",bottom:"0"},h=0,f="100%",d="100%";return s.targetRect&&"start"===s.settings.bubbles.align?(f="".concat(s.targetRect.x+s.targetRect.width,"px"),d="".concat(s.targetRect.y+s.targetRect.height,"px")):s.targetRect&&"end"===s.settings.bubbles.align&&(h=n?s.targetRect.x:s.targetRect.y,f="".concat(s.rect.width-h,"px"),d="".concat(s.rect.height-h,"px")),l||(r-=o),e("div",{onmouseover:function(t){t.srcElement.children[0].style.backgroundColor="#000",t.srcElement.children[0].style[n?"height":"width"]="2px"},onmouseout:function(t){t.srcElement.children[0].style.backgroundColor=s.style.line.stroke,t.srcElement.children[0].style[n?"height":"width"]="1px"},"data-value":i,"data-key":[s.key,"edge",c].join("-"),style:{cursor:n?"ns-resize":"ew-resize",position:"absolute",left:"".concat(n?h:r,"px"),top:"".concat(n?r:h,"px"),height:n?"".concat(o,"px"):d,width:n?f:"".concat(o,"px"),pointerEvents:"auto"}},[e("div",{style:G({backgroundColor:s.style.line.stroke,position:"absolute",height:n?"".concat(1,"px"):"100%",width:n?"100%":"".concat(1,"px"),pointerEvents:"none"},u)})])}function tc(t){var e,n,i=t.h,r=t.isVertical,a=t.label,o=t.otherValue,s=t.idx,c=t.pos,l=t.align,u=t.state,h="end"!==l,f="outside"===u.settings.bubbles.placement,d="none";return r?(n=h?"left":"right",f&&(d=h?"translate(-100%,  0px)":"translate(100%,  0px)")):(n=h?"top":"bottom",f&&(d=h?"translate(0px, -100%)":"translate(0px,  100%)")),i("div",{style:(e={position:"absolute"},A(e,n,"0"),A(e,r?"top":"left","".concat(c,"px")),A(e,"transform",d),e)},[i("div",{"data-key":[u.key,"bubble",s].join("-"),"data-other-value":o,"data-idx":s,style:G({position:"relative",borderRadius:"".concat(u.style.bubble.borderRadius,"px"),border:"".concat(u.style.bubble.strokeWidth,"px solid ").concat(u.style.bubble.stroke),backgroundColor:u.style.bubble.fill,color:u.style.bubble.color,fontFamily:u.style.bubble.fontFamily,fontSize:u.style.bubble.fontSize,padding:"4px 8px",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"150px",minWidth:"50px",minHeight:"1em",pointerEvents:"auto",transform:r?"translate(0,-50%)":"translate(-50%,0)"})},[a])])}function ec(t){var e=t.borderHit,n=t.els,i=t.isVertical,r=t.state,a=t.vStart,o=t.vEnd,s=t.idx,c=0;r.targetRect&&(c=i?r.targetRect.y:r.targetRect.x);var l,u,h,f,d,g,p,y,v=!!r.scale,m=v?r.scale.norm(a)*r.size:a,x=v?r.scale.norm(o)*r.size:o,b=Math.abs(m-x),w=Math.min(m,x)+c,k=w+b;if(r.targetRect){var M=r.targetFillRect||r.targetRect,_=i?M.height:M.width,S=v?r.scale.norm(a)*_:a,R=v?r.scale.norm(o)*_:o,z=Math.abs(S-R),N=Math.min(S,R),C={h:r.h,isVertical:i,top:N,height:z,color:r.style.target.fill,opacity:r.style.target.opacity};r.style.target.opacity<.8&&(C.on={onmouseover:function(t){t.srcElement.style.opacity=r.style.target.opacity+.1},onmouseout:function(t){t.srcElement.style.opacity=r.style.target.opacity}}),n.push(r.h("div",{style:{position:"absolute",left:"".concat(M.x,"px"),top:"".concat(M.y,"px"),height:"".concat(M.height,"px"),width:"".concat(M.width,"px")}},[(l=C,u=l.h,h=l.isVertical,f=l.top,d=l.height,g=l.color,p=l.on,y=l.opacity,u("div",G({style:{backgroundColor:g,opacity:y,position:"absolute",left:h?0:"".concat(f,"px"),top:h?"".concat(f,"px"):0,height:h?"".concat(d,"px"):"100%",width:h?"100%":"".concat(d,"px"),pointerEvents:"auto"}},p),[]))]))}n.push(Ks({h:r.h,isVertical:i,borderHit:e,value:m<x?a:o,pos:w,align:"start",state:r,idx:s})),n.push(Ks({h:r.h,isVertical:i,borderHit:e,value:m<x?o:a,pos:k,align:"end",state:r,idx:s}));var A=r.settings.bubbles;if(A&&A.show){var T={fontSize:A.fontSize,fontFamily:A.fontFamily,color:A.fill},E=[a,o];n.push(tc({h:r.h,isVertical:i,align:A.align,style:T,idx:s,otherValue:m<x?o:a,label:"".concat(r.format(m<x?a:o,E)),pos:w,state:r})),n.push(tc({h:r.h,isVertical:i,align:A.align,style:T,idx:s,otherValue:m<x?a:o,label:"".concat(r.format(m<x?o:a,E)),pos:k,state:r}))}}function nc(t){var e=t.active.limitHigh-t.active.end,n=t.active.limitLow-t.active.start,i=t.current-t.start;return i=i<0?Math.max(i,n):Math.min(i,e)}function ic(n){if(!n.active)return[];var t=n.start,e=n.current;if(-1!==n.active.idx)if("foo"===n.active.mode)t=Math.min(n.active.start,n.active.end),e=Math.max(n.active.start,n.active.end);else if("modify"===n.active.mode)t=Math.min(n.start,n.current),e=Math.max(n.start,n.current);else{var i=nc(n);t=n.active.start+i,e=n.active.end+i}var r=[],a=n.direction===Qs;return n.ranges.forEach(function(t,e){e!==n.active.idx&&ec({borderHit:Gs,els:r,isVertical:a,state:n,vStart:Math.min(t.min,t.max),vEnd:Math.max(t.min,t.max),idx:e})}),ec({borderHit:Gs,els:r,isVertical:a,state:n,vStart:t,vEnd:e,idx:n.active.idx}),r}function rc(t){return{min:t.scale.min(),max:t.scale.max()}}function ac(t){return{min:0,max:t.direction?t.rect.width:t.rect.height}}function oc(t,e,n){var i,r,a=t.ranges,o=-1;for(i=0;i<a.length;i++){if(a[i].min<=e&&e<=a[i].max){o=i,n.min=i?a[i-1].max:n.min,n.max=i+1<a.length?a[i+1].min:n.max;break}if(e<a[i].min){n.max=a[i].min,n.min=i?a[i-1].max:n.min;break}}-1===o&&a.length&&i>=a.length&&(n.min=a[a.length-1].max),-1!==o&&(r={idx:o,start:a[o].min,end:a[o].max,limitLow:n.min,limitHigh:n.max,mode:"foo"}),t.active=r}function sc(t){t.renderer.render(ic(t))}function cc(t,e){if(!e||!e.isActive())return[];var n=t.scale.data(),i=(n&&n.fields||[]).map(function(t){return t.id()}),r=e.brushes().filter(function(t){return"range"===t.type&&-1!==i.indexOf(t.id)})[0];return r?r.brush.ranges():[]}function lc(t,e){for(var n,i=1/0,r=e.domain(),a=e.bandwidth()/2,o=0;o<r.length;++o){var s=Math.abs(t-a-e(r[o]));s<i&&(i=s,n=r[o])}return n}function uc(t,e){return Math.min.apply(Math,K(t))<=Math.max.apply(Math,K(e))&&Math.max.apply(Math,K(t))>=Math.min.apply(Math,K(e))}function hc(t){return L(t.reduce(function(t,e){return t.push.apply(t,K(D(e.bounds))),t},[]))}var fc={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{rangeStart:function(t){this.start(t)},rangeMove:function(t){this.move(t)},rangeEnd:function(t){this.end(t)},rangeClear:function(t){this.clear(t)}},created:function(){this.state={key:this.settings.key||"brush-range"}},beforeRender:function(t){this.state.rect=t.size},render:function(t){var e=this.settings.settings;this.state.direction="vertical"===e.direction?Qs:1;var n=this.renderer.element().getBoundingClientRect(),i=this.state.rect[this.state.direction===Qs?"height":"width"],s=La(this.chart.scale(e.scale),i),r=function(t){var e={targetRect:null,targetFillRect:null,scale:null,size:null},n=t.settings.settings,i=n.target?t.chart.component(n.target.component):null,r=n.target&&n.target.selector?t.chart.findShapes(n.target.selector):[],a=n.target&&n.target.fillSelector?t.chart.findShapes(n.target.fillSelector):[];if(0<r.length){var o=hc(r);if(e.size=o[t.state.direction===Qs?"height":"width"],e.scale=La(t.chart.scale(n.scale),e.size),e.targetRect=o,0<a.length){var s=hc(a);e.targetFillRect=s}}else i&&i.rect&&(e.targetRect={x:i.rect.x-t.state.rect.x,y:i.rect.y-t.state.rect.y,width:i.rect.width,height:i.rect.height});return e}(this);if(s=r.scale?r.scale:s,this.state.targetRect=r.targetRect,this.state.targetFillRect=r.targetFillRect,this.state.size=null===r.size?i:r.size,this.state.settings=e,this.state.style=this.style,this.state.offset=n,this.state.brush=e.brush,this.state.brushInstance=this.chart.brush(this.state.brush),this.state.renderer=this.renderer,this.state.multi=!!e.multiple,this.state.h=t,this.state.cssCoord={offset:this.state.direction===Qs?"top":"left",coord:this.state.direction===Qs?"y":"x",pos:this.state.direction===Qs?"deltaY":"deltaX"},{}.hasOwnProperty.call(s,"norm")){this.state.fauxBrushInstance=null,this.state.findValues=null,this.state.scale=s;var a=this.state.scale.data();a&&a.fields&&a.fields[0]&&(this.state.format=a.fields[0].formatter())}else this.state.scale=Gr(),this.state.scale.data=s.data,this.state.format=function(t,e){return uc(s.range(),e)?(n=t,r=(i=s).ticks(),-1!==(a=i.domain().indexOf(lc(n,i)))?r[a].label:"-"):"-";var n,i,r,a},this.state.fauxBrushInstance=Ca(),this.state.findValues=function(t){return e=t,r=(i=s).domain(),a=i.range(),o=[],e.forEach(function(t){if(uc(a,[t.min,t.max])){var e=r.indexOf(lc(t.min,i)),n=r.indexOf(lc(t.max,i));o.push.apply(o,r.slice(Math.min(e,n),Math.max(e,n)+1))}}),o;var e,i,r,a,o};return[]},start:function(t){!function(t){var e=t.state,n=t.e,i=t.renderer,r=t.ranges,a=t.targetSize;if(!e.started){var o=n.center.x-n.deltaX,s=n.center.y-n.deltaY,c=document.elementFromPoint(o,s);i.element().contains(c)||(c=null);var l={started:!0};e.offset=G({},i.element().getBoundingClientRect());var u=o-e.offset.left,h=s-e.offset.top;e.offset.left+=e.targetRect?e.targetRect.x:0,e.offset.top+=e.targetRect?e.targetRect.y:0,e.ranges=r(e,e.fauxBrushInstance||e.brushInstance);var f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset];l.current=e.scale.normInvert(d/e.size),l.start=e.scale.normInvert(f/e.size);var g,p,y=e.ranges,v=rc(e),m=-1;if(c&&c.hasAttribute("data-idx"))m=parseInt(c.getAttribute("data-idx"),10),v.min=0<m?y[m-1].max:v.min,v.max=m+1<y.length?y[m+1].min:v.max;else{for(g=0;g<y.length;g++){if(y[g].min<=l.start&&l.start<=y[g].max){m=g,v.min=g?y[g-1].max:v.min,v.max=g+1<y.length?y[g+1].min:v.max;break}if(l.start<y[g].min){v.max=y[g].min,v.min=g?y[g-1].max:v.min;break}}-1===m&&y.length&&g>=y.length&&(v.min=y[y.length-1].max)}if(-1!==m||e.multi||(l.ranges=[],v.min=e.scale.min(),v.max=e.scale.max()),-1!==m)if(p={idx:m,start:y[m].min,end:y[m].max,limitLow:v.min,limitHigh:v.max,mode:"move"},c&&c.hasAttribute("data-other-value"))l.start=parseFloat(c.getAttribute("data-other-value")),p.mode="modify";else{var x=e.scale.norm(p.start)*e.size,b=e.scale.norm(p.end)*e.size;Math.abs(f-x)<=a?(l.start=p.end,p.mode="modify"):Math.abs(f-b)<=a&&(l.start=p.start,p.mode="modify")}else p={idx:-1,start:l.start,end:l.current,limitLow:v.min,limitHigh:v.max,mode:"current"};"modify"!==(l.active=p).mode&&e.targetRect&&!wo(e.targetRect,{x:u,y:h})||Object.keys(l).forEach(function(t){return e[t]=l[t]})}}({e:t,state:this.state,renderer:this.renderer,ranges:cc,targetSize:Gs})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t,t.fauxBrushInstance||t.brushInstance);var n=rc(t);oc(t,t.current,n)}(this.state,cc),sc(this.state))},move:function(t){var e,n,i;this.state.started&&(e=this.state,n=(t.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset])/e.size,i=e.scale.normInvert(n),e.current=Math.max(Math.min(i,e.active.limitHigh),e.active.limitLow),function(c){var l=c.ranges.map(function(t){return{min:t.min,max:t.max}});if(-1!==c.active.idx)if("modify"===c.active.mode)l[c.active.idx].min=Math.min(c.start,c.current),l[c.active.idx].max=Math.max(c.start,c.current);else{var t=nc(c);l[c.active.idx].min+=t,l[c.active.idx].max+=t}else l.push({min:Math.min(c.start,c.current),max:Math.max(c.start,c.current)});var e=c.scale.data();e&&e.fields&&e.fields.forEach(function(e){if(c.fauxBrushInstance){var t=cc(c,c.fauxBrushInstance),n=c.findValues(t),i=c.findValues(l),r=i.filter(function(t){return-1===n.indexOf(t)}),a=n.filter(function(t){return-1===i.indexOf(t)}),o=r.map(function(t){return{key:e.id(),value:t}}),s=a.map(function(t){return{key:e.id(),value:t}});c.brushInstance.addAndRemoveValues(o,s),c.fauxBrushInstance.setRange(e.id(),l)}else c.brushInstance.setRange(e.id(),l)})}(this.state),sc(this.state))},clear:function(){this.state.fauxBrushInstance&&this.state.fauxBrushInstance.clear(),this.state.renderer.render([])}};function dc(t){t.renderer.render(ic(t))}function gc(t){return t.rc.ranges()}var pc={require:["chart","settings","renderer"],defaultSettings:{settings:{bubbles:{show:!0,align:"start"}},style:{bubble:"$label-overlay",line:"$shape-guide--inverted",target:"$selection-area-target"}},renderer:"dom",on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaClear:function(t){this.clear(t)}},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={key:this.settings.key||"brush-area-dir"}},beforeRender:function(t){this.rect=t.size},render:function(t){this.state.rect=this.rect;var e=this.settings.settings,n="vertical"===e.direction?Qs:1,i=this.state.rect[n===Qs?"height":"width"],r=this.renderer.element().getBoundingClientRect(),a=e.target?this.chart.component(e.target.component):null;return a&&a.rect?this.state.targetRect={x:a.rect.x-this.rect.x,y:a.rect.y-this.rect.y,width:a.rect.width,height:a.rect.height}:this.state.targetRect=null,this.state.style=this.style,this.state.chart=this.chart,this.state.direction=n,this.state.settings=e,this.state.offset=r,this.state.rc=xa(),this.state.renderer=this.renderer,this.state.multi=!!e.multiple,this.state.h=t,this.state.size=i,this.state.cssCoord={offset:this.state.direction===Qs?"top":"left",coord:this.state.direction===Qs?"y":"x",pos:this.state.direction===Qs?"deltaY":"deltaX",area:this.state.direction===Qs?"height":"width"},this.state.format=function(t,e){return function(r,a,t){var o=Math.min.apply(Math,K(t)),e=Math.max.apply(Math,K(t)),n={x:r.direction?o+r.rect.x:r.rect.x,y:r.direction?r.rect.y:o+r.rect.y,width:r.direction?e-o:r.rect.width+r.rect.x,height:r.direction?r.rect.height+r.rect.y:e-o},i=r.chart.shapesAt(n,r.settings.brush);if(0===i.length)return"-";var s=i.reduce(function(t,e){var n=t.bounds,i=e.bounds;return a===o?n[r.cssCoord.coord]<=i[r.cssCoord.coord]?t:e:n[r.cssCoord.coord]+n[r.cssCoord.area]>=i[r.cssCoord.coord]+i[r.cssCoord.area]?t:e}),c=r.settings.brush.components.reduce(function(t,e){return t.key===s.key?t:e});return"function"==typeof r.settings.bubbles.label?r.settings.bubbles.label(s.data):Array.isArray(c.data)&&c.data.length?s.data[c.data[0]].label:s.data&&s.data.label?s.data.label:"-"}(this,t,e)},[]},start:function(t){!function(t){var e=t.state,n=t.e,i=t.renderer,r=t.ranges,a=t.targetSize;if(!e.started){var o=n.center.x-n.deltaX,s=n.center.y-n.deltaY,c=document.elementFromPoint(o,s);i.element().contains(c)||(c=null);var l={started:!0};e.offset=i.element().getBoundingClientRect(),e.ranges=r(e);var u=o-e.offset.left,h=s-e.offset.top,f=n.center[e.cssCoord.coord]-n[e.cssCoord.pos]-e.offset[e.cssCoord.offset],d=n.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset],g=d,p=f;l.start=f,l.current=d;var y,v,m=e.ranges,x=ac(e),b=-1;if(c&&c.hasAttribute("data-idx"))b=parseInt(c.getAttribute("data-idx"),10),x.min=0<b?m[b-1].max:x.min,x.max=b+1<m.length?m[b+1].min:x.max;else{for(y=0;y<m.length;y++){if(m[y].min<=p&&p<=m[y].max){b=y,x.min=y?m[y-1].max:x.min,x.max=y+1<m.length?m[y+1].min:x.max;break}if(p<m[y].min){x.max=m[y].min,x.min=y?m[y-1].max:x.min;break}}-1===b&&m.length&&y>=m.length&&(x.min=m[m.length-1].max)}if(-1!==b||e.multi||(l.ranges=[],x.min=0,x.max=e.direction?e.rect.width:e.rect.height),-1!==b)if(v={idx:b,start:m[b].min,end:m[b].max,limitLow:x.min,limitHigh:x.max,mode:"move"},c&&c.hasAttribute("data-other-value"))l.start=parseFloat(c.getAttribute("data-other-value")),v.mode="modify";else{var w=v.start,k=v.end;Math.abs(f-w)<=a?(l.start=v.end,v.mode="modify"):Math.abs(f-k)<=a&&(l.start=v.start,v.mode="modify")}else v={idx:-1,start:p,end:g,limitLow:x.min,limitHigh:x.max,mode:"current"};"modify"!==(l.active=v).mode&&e.targetRect&&!wo(e.targetRect,{x:u,y:h})||Object.keys(l).forEach(function(t){return e[t]=l[t]})}}({e:t,state:this.state,renderer:this.renderer,ranges:gc,targetSize:Gs})},end:function(){this.state.started&&(!function(t,e){t.started=!1,t.ranges=e(t);var n=ac(t);oc(t,t.current,n)}(this.state,gc),dc(this.state))},move:function(t){var e,n;this.state.started&&(e=this.state,n=t.center[e.cssCoord.coord]-e.offset[e.cssCoord.offset],e.current=Math.max(Math.min(n,e.active.limitHigh),e.active.limitLow),function(r){var t=r.ranges.map(function(t){return{min:t.min,max:t.max}});if(-1!==r.active.idx)if("modify"===r.active.mode)t[r.active.idx].min=Math.min(r.start,r.current),t[r.active.idx].max=Math.max(r.start,r.current);else{var e=nc(r);t[r.active.idx].min=r.active.start+e,t[r.active.idx].max=r.active.end+e}else t.push({min:Math.min(r.start,r.current),max:Math.max(r.start,r.current)});r.rc.set(t);var n,i,a=[];t.forEach(function(t){var e,n,i;a.push.apply(a,K((n=t,i={x:(e=r).direction?n.min+e.rect.x:e.rect.x,y:e.direction?e.rect.y:n.min+e.rect.y,width:e.direction?n.max-n.min:e.rect.width+e.rect.x,height:e.direction?e.rect.height+e.rect.y:n.max-n.min},e.chart.shapesAt(i,e.settings.brush))))}),i=a,(n=r).chart.brushFromShapes(i,n.settings.brush)}(this.state),dc(this.state))},clear:function(){this.state.rc&&this.state.rc.clear(),this.state.renderer.render([])}};function yc(a){var o="vertical"===a.direction,s=a.rect[o?"height":"width"],c=a.rect[o?"width":"height"];return function(t){var e=t.brush;if(!e||!e.isActive())return[];var n=t.scale.data(),i=(n&&n.fields||[]).map(function(t){return t.id()}),r=e.brushes().filter(function(t){return"range"===t.type&&-1!==i.indexOf(t.id)})[0];return r?r.brush.ranges():[]}(a).map(function(t){var e=a.scale(t.min)*s,n=a.scale(t.max)*s,i=Math.min(e,n),r=Math.abs(e-n);return{type:"rect",fill:a.fill,opacity:a.opacity,x:o?0:i,width:o?c:r,y:o?i:0,height:o?r:c}})}function vc(e,t,n,i){function r(){var t;(t=e).renderer.render(yc(t))}function a(){var t;(t=e).renderer.render(yc(t))}function o(){var t;(t=e).renderer.render(yc(t))}(e.brush=t)&&(t.on("start",r),t.on("update",a),t.on("end",o),e.start=r,e.update=a,e.end=o,e.brush=t,e.scale=n,e.renderer=i)}function mc(t){t.brush&&(t.brush.removeListener("start",t.start),t.brush.removeListener("update",t.update),t.brush.removeListener("end",t.end)),t.start=void 0,t.update=void 0,t.end=void 0,t.brush=void 0,t.scale=void 0,t.renderer=void 0}var xc={require:["chart","settings","renderer"],defaultSettings:{settings:{}},preferredSize:function(){return 50},created:function(){this.rect={x:0,y:0,width:0,height:0},this.state={}},beforeRender:function(t){this.rect=t.size},render:function(){var t=this.settings.settings,e=this.chart.brush(t.brush),n=t.direction||"horizontal",i="horizontal"===n?this.rect.width:this.rect.height,r=La(this.chart.scale(t.scale),i);return mc(this.state),vc(this.state,e,r,this.renderer),this.state.rect=this.rect,this.state.fill=t.fill||"#ccc",this.state.opacity=void 0!==t.opacity?t.opacity:1,this.state.direction=n,yc(this.state)},beforeDestroy:function(){mc(this.state)}};function bc(t,e){var n=e.center.x,i=e.center.y;return{x:n-t.left,y:i-t.top}}function wc(t,e,n){return eo(t,e.points[0])<Math.pow(n.settings.snapIndicator.threshold,2)}function kc(t,e){null==t.path.d?t.path.d="M".concat(e.x," ").concat(e.y," "):t.path.d+="L".concat(e.x," ").concat(e.y," "),t.points.push(e)}function Mc(t){var e=t.state,n=t.start,i=void 0===n?null:n,r=t.end,a=void 0===r?null:r;null!==i&&(e.snapIndicator.x1=i.x,e.snapIndicator.y1=i.y),null!==a&&(e.snapIndicator.x2=a.x,e.snapIndicator.y2=a.y)}function _c(t,e){t.snapIndicator.visible=e}var Sc={require:["chart","renderer","settings"],defaultSettings:{displayOrder:0,settings:{brush:{components:[]},snapIndicator:{threshold:75,strokeDasharray:"5, 5",stroke:"black",strokeWidth:2,opacity:.5},lasso:{fill:"transparent",stroke:"black",strokeWidth:2,opacity:.7,strokeDasharray:"20, 10"},startPoint:{r:10,fill:"green",stroke:"black",strokeWidth:1,opacity:1}}},on:{lassoStart:function(t){this.start(t)},lassoEnd:function(t){this.end(t)},lassoMove:function(t){this.move(t)},lassoCancel:function(){this.cancel()}},created:function(){this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}}},start:function(t){var e,n,i,r,a,o;this.state.active=!0,this.state.path={visible:!0,type:"path",d:null,fill:(e=this.settings.settings.lasso).fill,stroke:e.stroke,strokeWidth:e.strokeWidth,opacity:e.opacity,strokeDasharray:e.strokeDasharray,collider:{type:null}},this.state.snapIndicator={visible:!1,type:"line",x1:0,y1:0,x2:0,y2:0,strokeDasharray:(n=this.settings.settings.snapIndicator).strokeDasharray,stroke:n.stroke,strokeWidth:n.strokeWidth,opacity:n.opacity,collider:{type:null}},this.state.startPoint={visible:!0,type:"circle",cx:0,cy:0,r:(i=this.settings.settings.startPoint).r,fill:i.fill,opacity:i.opacity,stroke:i.stroke,strokeWidth:i.strokeWidth,collider:{type:null}},this.state.rendererBounds=this.renderer.element().getBoundingClientRect(),this.state.componentDelta=(r=this.chart,a=this.state.rendererBounds,o=r.element.getBoundingClientRect(),{x:a.left-o.left,y:a.top-o.top}),this.state.brushConfig=this.settings.settings.brush.components.map(function(t){return{key:t.key,contexts:t.contexts||["lassoBrush"],data:t.data||[""],action:t.action||"add"}});var s,c,l=bc(this.state.rendererBounds,t);kc(this.state,l),Mc({state:this.state,start:l}),s=this.state,c=l,s.startPoint.cx=c.x,s.startPoint.cy=c.y},move:function(t){if(this.state.active){var e,n,i,r=bc(this.state.rendererBounds,t);wc(r,this.state,this.settings)?_c(this.state,!0):_c(this.state,!1),kc(this.state,r),Mc({state:this.state,end:r}),e=this.state,n=this.renderer,i=[e.startPoint,e.path,e.snapIndicator].filter(function(t){return t.visible}),n.render(i),function(t,e){if(t.active){var n=t.points[t.points.length-2],i=t.points[t.points.length-1];t.lineBrushShape.x1=n.x+t.componentDelta.x,t.lineBrushShape.y1=n.y+t.componentDelta.y,t.lineBrushShape.x2=i.x+t.componentDelta.x,t.lineBrushShape.y2=i.y+t.componentDelta.y;var r=e.shapesAt(t.lineBrushShape,{components:t.brushConfig});e.brushFromShapes(r,{components:t.brushConfig})}}(this.state,this.chart)}},end:function(t){this.state.active&&(_c(this.state,!1),wc(bc(this.state.rendererBounds,t),this.state,this.settings)&&function(t,e){if(t.active){var n=t.componentDelta.x,i=t.componentDelta.y,r=t.points.map(function(t){return{x:t.x+n,y:t.y+i}}),a=e.shapesAt({vertices:r},{components:t.brushConfig});e.brushFromShapes(a,{components:t.brushConfig})}}(this.state,this.chart),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach(function(t){t.contexts.forEach(function(t){e.brush(t).end()})}),this.state={points:[],active:!1,path:null,snapIndicator:null,startPoint:null,rendererBounds:null,componentDelta:null,brushConfig:null,lineBrushShape:{x1:0,y1:0,x2:0,y2:0}},this.renderer.render([]))},render:function(){}};var Rc=1.5,zc=4;function Nc(t,e){return{node:t,data:t.data,scale:e.scale,formatter:e.formatter,dataset:e.dataset}}function Cc(t,e,n){var i={type:"text",text:e,maxWidth:n.rotate?t.height:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:n.rotate?"end":"start",baseline:"alphabetical",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},r=n.textMetrics;if(t.width<n.fontSize||t.height<r.height)return!1;if(n.rotate){var a=Math.max(0,t.width-r.height/(.8*Rc)),o=Math.max(0,t.height-r.width);i.x=t.x+r.height/Rc+n.align*a,i.y=t.y+n.justify*o,i.transform="rotate(-90, ".concat(i.x+i.dx,", ").concat(i.y+i.dy,")")}else{var s=Math.max(0,t.width-r.width),c=Math.max(0,t.height-r.height/(.8*Rc));i.x=t.x+n.align*s,i.y=t.y+r.height/Rc+n.justify*c}return i}function Ac(t){var e,n,i,r,a,o,s,c,l=t.bar,u=t.view,h=t.direction,f=t.position,d=t.padding,g=void 0===d?zc:d,p={};if(G(p,l),f&&"inside"!==f)if("up"===h||"down"===h){var y=Math.max(0,Math.min(l.y,u.height)),v=Math.max(0,Math.min(l.y+l.height,u.height));"outside"===f&&"up"===h||"opposite"===f&&"down"===h?(p.y=0,p.height=y):("outside"===f&&"down"===h||"opposite"===f&&"up"===h)&&(p.y=v,p.height=u.height-v)}else{var m=Math.max(0,Math.min(l.x,u.width)),x=Math.max(0,Math.min(l.x+l.width,u.width));"outside"===f&&"left"===h||"opposite"===f&&"right"===h?(p.x=0,p.width=m):("outside"===f&&"right"===h||"opposite"===f&&"left"===h)&&(p.x=x,p.width=u.width-x)}else;return e=p,n=u,i=Math.max(0,Math.min(e.y,n.height)),r=Math.max(0,Math.min(e.y+e.height,n.height)),a=Math.max(0,Math.min(e.x,n.width)),o=Math.max(0,Math.min(e.x+e.width,n.width)),e.x=a,e.width=o-a,e.y=i,e.height=r-i,c=g,(s=p).x+=c,s.width-=2*c,s.y+=c,s.height-=2*c,p}function Tc(t){var e,n,i,r,a,o=t.direction,s=t.fitsHorizontally,c=t.measured,l=t.node,u=t.orientation,h=t.placementSettings,f=t.rect,d=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Ac,g=[];for(a=0;a<h.length;a++){if(i=h[a],r=d({bar:l.localBounds,view:f,direction:o,position:i.position}),g.push(r),e=!a||r.height>e.height?r:e,"v"===u&&(s&&r.height>c.height*Rc||!s&&r.height>c.width)){n=r;break}if("h"===u&&r.height>c.height&&r.width>c.width){n=r;break}}return n||(n=e,a=g.indexOf(n)),{bounds:n,placement:i=h[a]}}function Ec(t){for(var e,n,i,r,a,o,s,c,l,u,h,f,d,g=t.chart,p=t.targetNodes,y=t.rect,v=t.fitsHorizontally,m=t.collectiveOrientation,x=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Tc,b=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Cc,w=[],k=0,M=p.length;k<M;k++){o=null,f=Nc(i=(n=p[k]).node,g),d="left"===(l=n.direction)||"right"===l?"h":"v";for(var _=0;_<n.texts.length;_++)if(r=n.texts[_]){var S=x({direction:l,fitsHorizontally:v,lblStngs:u=n.labelSettings[_],measured:c=n.measurements[_],node:i,orientation:d,placements:u.placements,placementSettings:n.placementSettings[_],rect:y});if(o=S.bounds,h=S.placement,o&&h){a=h.justify,s="function"==typeof h.fill?h.fill(f,k):h.fill;var R="function"==typeof u.linkData?u.linkData(f,k):void 0;"up"===l&&(a=1-a),"opposite"===h.position&&(a=1-a),(e=b(o,r,{fill:s,justify:"h"===d?h.align:a,align:"h"===d?a:h.align,fontSize:u.fontSize,fontFamily:u.fontFamily,textMetrics:c,rotate:!("h"===m||v)}))&&(void 0!==R&&(e.data=R),w.push(e))}}}return w}function Oc(t){var e=2*Math.PI;return(t%e+e)%e}function jc(t,e,n){var i=e.x,r=e.y;if(t*t<i*i+r*r)return null;var a=Math.sin(n),o=Math.cos(n),s=i*o-r*a,c=t*t-s*s;if(c<0)return null;var l=Math.sqrt(c);return{x:s*o+a*l,y:-s*a+o*l}}function Pc(t){var e,n,i=t.slice,r=t.padding,a=t.measured,o=i.start,s=i.end,c=i.innerRadius,l=i.outerRadius,u=Oc((o+s)/2),h=function(t){var e,n,i=t.radius,r=t.size,a=t.angle,o=r.width,s=r.height,c={x:o/2,y:s/2};switch(Math.floor(a/(Math.PI/2))){case 0:if(!(e=jc(i,c,a)))return null;e.y*=-1,n={x:-o,y:0};break;case 1:if(!(e=jc(i,c,Math.PI-a)))return null;n={x:-o,y:-s};break;case 2:if(!(e=jc(i,c,a-Math.PI)))return null;e.x*=-1,n={x:0,y:-s};break;case 3:if(!(e=jc(i,c,2*Math.PI-a)))return null;e.x*=-1,e.y*=-1,n={x:0,y:0};break;default:throw new Error("invalid angle")}return{x:e.x+n.x,y:e.y+n.y,width:o,height:s}}({radius:l,size:{width:a.width+2*r,height:a.height+2*r},angle:u});return h?(h.baseline="top",ko(h,{x1:0,y1:0,x2:Math.sin(o)*l,y2:-Math.cos(o)*l})?null:ko(h,{x1:0,y1:0,x2:Math.sin(s)*l,y2:-Math.cos(s)*l})?null:go({cx:0,cy:0,r:c},h)?null:(n=r,(e=h).x+=n,e.width-=2*n,e.y+=n,e.height-=2*n,h)):null}function Fc(t){var e=t.slice,n=t.measured,i=t.padding,r=e.start,a=e.end,o=e.innerRadius,s=e.outerRadius,c=s-o-2*i,l=a-r;if(l<Math.PI){var u=(n.height/2+i)/Math.tan(l/2);o<u&&(c=s-u-2*i)}if(c<0)return null;var h=Oc((r+a)/2),f=s-i,d={x:Math.sin(h)*f,y:-Math.cos(h)*f,width:c,height:n.height};return h<Math.PI?(d.angle=h-Math.PI/2,d.anchor="end"):(d.angle=h+Math.PI/2,d.anchor="start"),d}function Dc(t){var e=t.context,n=t.node,i=t.bounds,r=n.desc.slice,a=Oc((r.start+r.end)/2);switch(Math.floor(a/(Math.PI/2))){case 0:e.q1maxY=i.y-2,void 0===e.q2minY&&(e.q2minY=i.y+i.height+2);break;case 1:e.q2minY=i.y+i.height+2;break;case 2:e.q3minY=i.y+i.height+2;break;case 3:e.q4maxY=i.y-2,void 0===e.q3minY&&(e.q3minY=i.y+i.height+2)}}function Lc(t,e,n){var i={type:"text",text:e,maxWidth:t.width,x:t.x,y:t.y+("top"===t.baseline?t.height/2:0),fill:n.fill,anchor:t.anchor||"start",baseline:"middle",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily};if(!isNaN(t.angle)){var r=t.angle*(360/(2*Math.PI));i.transform="rotate(".concat(r,", ").concat(i.x,", ").concat(i.y,")")}return i}function Bc(t){var e,n,i=t.slice,r=t.direction,a=t.position,o=t.padding,s=t.measured,c=t.view,l=t.context,u=i.start,h=i.end,f=i.innerRadius,d=i.offset;switch(a){case"into":e="rotate"===r?Fc({slice:i,measured:s,padding:o}):Pc({slice:i,measured:s,padding:o});break;case"inside":n={start:u,end:h,innerRadius:0,outerRadius:f},e="rotate"===r?Fc({slice:n,measured:s,padding:o}):Pc({slice:n,measured:s,padding:o});break;case"outside":e="rotate"===r?function(t){var e=t.slice,n=t.measured,i=t.padding,r=t.view,a=e.start,o=e.end,s=e.outerRadius,c=e.offset,l=s+i,u=o-a;if(u<Math.PI&&l<(n.height/2+i)/Math.tan(u/2))return null;var h=Oc((a+o)/2),f=Math.sin(h)*l,d=-Math.cos(h)*l,g=n.width,p=h%Math.PI;if(p>Math.PI/2&&(p=Math.PI-p),.001<Math.cos(p)){var y=d<0?r.y:r.y+r.height,v=Math.abs(y-c.y)/Math.cos(p)-Math.tan(p)*(n.height/2)-2*i-s;v<g&&(g=v)}if(.001<Math.sin(p)){var m=f<0?r.x:r.x+r.width,x=Math.abs(m-c.x)/Math.sin(p)-n.height/2/Math.tan(p)-2*i-s;x<g&&(g=x)}if(g<=0)return 0;var b={x:f,y:d,width:g,height:n.height};return h<Math.PI?(b.angle=h-Math.PI/2,b.anchor="start"):(b.angle=h+Math.PI/2,b.anchor="end"),b}({slice:i,measured:s,padding:o,view:c}):function(t){var e=t.slice,n=t.measured,i=t.padding,r=t.view,a=t.context,o=e.start,s=e.end,c=e.outerRadius,l=e.offset,u=Oc((o+s)/2);if(function(t,e,n){switch(e){case 0:return t.q1maxY<0;case 1:return t.q2minY>n.height;case 2:return t.q3minY>n.height;case 3:return t.q4maxY<0;default:return!0}}(a,Math.floor(u/(Math.PI/2)),r))return null;var h=c+i+n.height/2,f=Math.sin(u)*h,d=-Math.cos(u)*h,g=n.width;if(u<Math.PI){var p=Math.abs(r.x+r.width-(f+l.x));p<g&&(g=p)}else{var y=Math.abs(r.x-(f+l.x));y<g&&(g=y)}var v={x:f,y:d,width:g,height:n.height};return u<Math.PI?v.anchor="start":v.anchor="end",v}({slice:i,measured:s,padding:o,view:c,context:l});break;default:throw new Error("not implemented")}return e&&(e.x+=d.x,e.y+=d.y,"outside"===a&&"rotate"!==r&&function(t,e,n){var i=n.start,r=n.end,a=n.offset,o=n.outerRadius,s=Oc((i+r)/2);switch(Math.floor(s/(Math.PI/2))){case 0:if(void 0!==e.q1maxY){var c=Math.min(t.y,e.q1maxY-t.height),l=t.y-c;if(t.y=c,1<l){var u=o+2;t.line={type:"line",x1:t.x-2,y1:t.y+2,x2:a.x+Math.sin(s)*u,y2:a.y-Math.cos(s)*u,strokeWidth:1}}}break;case 1:if(void 0!==e.q2minY){var h=Math.max(t.y,e.q2minY),f=h-t.y;if(t.y=h,1<f){var d=o+2;t.line={type:"line",x1:t.x-2,y1:t.y-2,x2:a.x+Math.sin(s)*d,y2:a.y-Math.cos(s)*d,strokeWidth:1}}}break;case 2:if(void 0!==e.q3minY){var g=Math.max(t.y,e.q3minY),p=g-t.y;if(t.y=g,1<p){var y=o+2;t.line={type:"line",x1:t.x+2,y1:t.y-2,x2:a.x+Math.sin(s)*y,y2:a.y-Math.cos(s)*y,strokeWidth:1}}}break;case 3:if(void 0!==e.q4maxY){var v=Math.min(t.y,e.q4maxY-t.height),m=t.y-v;if(t.y=v,1<m){var x=o+2;t.line={type:"line",x1:t.x+2,y1:t.y+2,x2:a.x+Math.sin(s)*x,y2:a.y-Math.cos(s)*x,strokeWidth:1}}}}}(e,l,i)),e}function Wc(t){for(var e=t.context,n=t.direction,i=t.measured,r=t.node,a=t.placementSettings,o=t.rect,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Bc,c=0;c<a.length;c++){var l=a[c],u=s({context:e,slice:r.desc.slice,view:o,direction:n,position:l.position,measured:i,padding:l.padding});if(u)return{bounds:u,placement:l}}return{bounds:null,placement:null}}var Ic=1.2;function $c(t,e,n){var i={type:"text",text:e,maxWidth:t.width,x:0,y:t.y,dx:0,dy:0,fill:n.fill,anchor:"start",baseline:"alphabetical",fontSize:"".concat(n.fontSize,"px"),fontFamily:n.fontFamily},r=n.textMetrics;if(t.width<n.fontSize)return!1;var a=Math.max(0,t.width-r.width);return i.x=t.x+n.align*a,i.y=t.y+r.height/Ic,i}function Vc(t){return{type:"circle",bounds:{cx:t.cx,cy:t.cy,r:t.r}}}function qc(t){return t.desc&&t.desc.slice?function(t){var e=t.start,n=t.end,i=t.innerRadius,r=t.outerRadius,a=t.offset;if(1e-12<Math.abs(e+2*Math.PI-n))return{type:null,bounds:null};var o=0!==i?i:r;return Vc({cx:a.x,cy:a.y,r:o})}(t.desc.slice):"circle"===t.type?Vc(t.attrs):"rect"===t.type?{type:"rect",bounds:t.bounds}:{type:null,bounds:null}}var Uc={bar:function(t){var n=t.settings,e=t.chart,i=t.nodes,r=t.rect,a=t.renderer,o=t.style,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Ec,c=G({fontSize:12,fontFamily:"Arial",align:.5,justify:0,fill:"#333"},o.label);c.fontSize=parseInt(c.fontSize,10);var l=n.labels.map(function(t){return G({},c,n,t)}),u=n.labels.map(function(e){return e.placements.map(function(t){return G({},c,n,e,t)})}),h=function(t){for(var e,n,i,r,a,o,s,c=t.nodes,l=t.rect,u=t.chart,h=t.labelSettings,f=t.placementSettings,d=t.settings,g=t.renderer,p={},y=[],v=!0,m=!1,x=0;x<c.length;x++)if(bo(r=(n=c[x]).localBounds,l)){var b=Nc(n,u);e={node:n,texts:[],measurements:[],labelSettings:[],placementSettings:[]};for(var w=0;w<h.length;w++)(i="function"==typeof(o=h[w]).label?o.label(b,x):"")&&(s="function"==typeof d.direction?d.direction(b,x):d.direction||"up",m=m||"left"===s||"right"===s,p.fontFamily=o.fontFamily,p.fontSize="".concat(o.fontSize,"px"),p.text=i,a=g.measureText(p),e.measurements.push(a),e.texts.push(i),e.labelSettings.push(o),e.placementSettings.push(f[w]),e.direction=s,v=v&&a.width<=r.width-2*zc);y.push(e)}return{targetNodes:y,fitsHorizontally:v,hasHorizontalDirection:m}}({nodes:i,chart:e,renderer:a,settings:n,rect:r,labelSettings:l,placementSettings:u}),f=h.fitsHorizontally,d=h.hasHorizontalDirection;return s({chart:e,targetNodes:h.targetNodes,stngs:n,rect:r,fitsHorizontally:f,collectiveOrientation:d?"h":"v"})},slice:function(t){var n=t.settings,e=t.chart,i=t.nodes,r=t.rect,a=t.renderer,o=t.style,s=1<arguments.length&&void 0!==arguments[1]?arguments[1]:Wc,c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Lc,l=G({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,position:"into"},o.label);l.fontSize=parseInt(l.fontSize,10);for(var u,h,f,d,g,p=n.labels.map(function(t){return G({},l,n,t)}),y=n.labels.map(function(e){return e.placements.map(function(t){return G({},l,n,e,t)})}),v={},m=[],x={},b=0,w=(i=function(t){for(var e=[],n=[],i=[],r=[],a=0;a<t.length;++a){var o=t[a].desc.slice,s=Oc((o.start+o.end)/2);switch(Math.floor(s/(Math.PI/2))){case 0:e.push(t[a]);break;case 1:n.push(t[a]);break;case 2:i.push(t[a]);break;case 3:r.push(t[a])}}var c=function(t,e){return Oc((t.desc.slice.start+t.desc.slice.end)/2)-Oc((e.desc.slice.start+e.desc.slice.end)/2)},l=function(t,e){return c(e,t)};return e.sort(l),n.sort(c),i.sort(l),r.sort(c),e.concat(n,r,i)}(i)).length;b<w;b++)for(var k=i[b],M=(g=e,{node:d=k,data:d.data,scale:g.scale,formatter:g.formatter,dataset:g.dataset}),_=0;_<p.length;_++){var S=p[_],R="function"==typeof S.label?S.label(M,b):"";if(R){var z="function"==typeof S.direction?S.direction(M,b):S.direction||"horizontal",N="function"==typeof S.linkData?S.linkData(M,b):void 0;v.fontFamily=S.fontFamily,v.fontSize="".concat(S.fontSize,"px"),v.text=R;var C=a.measureText(v),A=s({context:x,direction:z,lblStngs:S,measured:C,node:k,placementSettings:y[_],rect:r}),T=A.bounds,E=A.placement;if(T&&E){if("outside"===E.position&&"rotate"!==z){Dc({context:x,node:k,bounds:T});var O={x:(f=T).x,y:f.y-f.height/2,width:f.width,height:f.height};if(!((u=O).x>=(h=r).x&&u.x+u.width<=h.x+h.width&&u.y>=h.y&&u.y+u.height<=h.y+h.height))continue}var j="function"==typeof E.fill?E.fill(M,b):E.fill,P=c(T,R,{fill:j,fontSize:S.fontSize,fontFamily:S.fontFamily,textMetrics:C});P&&(void 0!==N&&(P.data=N),m.push(P),T.line&&(T.line.stroke=j,m.push(T.line)))}}}return m},rows:function(t){var e=t.settings,n=t.chart,i=t.nodes,r=t.renderer,a=t.style,o=1<arguments.length&&void 0!==arguments[1]?arguments[1]:$c,s=G({fontSize:12,fontFamily:"Arial",fill:"#333",padding:4,align:.5,justify:.5},a.label);s.fontSize=parseInt(s.fontSize,10);for(var c,l,u=G({},s,e),h=e.labels.map(function(t){return G({},u,t)}),f={},d=[],g=0,p=i.length;g<p;g++){var y=i[g],v=(l=n,{node:c=y,data:c.data,scale:l.scale,formatter:l.formatter,dataset:l.dataset}),m=qc(y),x=m.type,b=m.bounds;if(b){var w=0,k=[],M=[],_="circle"===x?2*b.r*.9:b.height;w+=u.padding;var S=void 0;for(S=0;S<h.length;S++){var R=h[S],z="function"==typeof R.label?R.label(v,g):"";f.fontFamily=R.fontFamily,f.fontSize="".concat(R.fontSize,"px"),f.text=z;var N=r.measureText(f);if(_<(w+=N.height+R.padding))break;M.push(z),k.push(N)}var C=S,A=Math.max(0,_-w),T=void 0;for(T="circle"===x?b.cy-.9*b.r:b.y,T+=u.justify*A+u.padding,S=0;S<C;S++){var E=h[S],O=void 0;if("circle"===x){var j=Math.max(Math.abs(T-b.cy),Math.abs(T+k[S].height-b.cy)),P=Math.sqrt(b.r*b.r-j*j);O={x:b.cx-P+u.padding,y:T,width:2*P-2*u.padding,height:k[S].height}}else O={x:b.x+u.padding,y:T,width:b.width-2*u.padding,height:k[S].height};T+=k[S].height+u.padding;var F="function"==typeof E.fill?E.fill(v,g):E.fill,D="function"==typeof E.linkData?E.linkData(v,g):void 0,L=o(O,M[S],{fill:F,align:E.align,fontSize:E.fontSize,fontFamily:E.fontFamily,textMetrics:k[S]});L&&(void 0!==D&&(L.data=D),d.push(L))}}}return d}};var Hc={require:["chart","renderer","settings"],defaultSettings:{settings:{},style:{label:"$label"}},created:function(){this.rect={x:0,y:0,width:0,height:0}},beforeRender:function(t){this.rect=t.size},render:function(){var e=this,t=this.settings.settings,n=[];return(t.sources||[]).forEach(function(t){t.strategy&&Uc[t.strategy.type]&&t.component&&n.push.apply(n,K(function(t,e){var n=t.chart,i=t.source,r=t.rect,a=t.renderer,o=t.style;if(!n.component(i.component))return[];var s=n.findShapes(i.selector).filter(function(t){return t.key===i.component});return e({chart:n,settings:i.strategy.settings,nodes:s,rect:{x:0,y:0,width:r.width,height:r.height},renderer:a,style:o})}({chart:e.chart,rect:e.rect,renderer:e.renderer,source:t,style:e.style},Uc[t.strategy.type])))}),n}};var Yc={layout:{size:1,direction:"ltr",scrollOffset:0},item:{show:!0,justify:.5,align:.5,label:{fontSize:"12px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:136,lineHeight:1.2},shape:{type:"square",size:12}},title:{show:!0,text:void 0,anchor:"start",fontSize:"16px",fontFamily:"Arial",fill:"#595959",wordBreak:"none",maxLines:2,maxWidth:156,lineHeight:1.25},navigation:{button:{class:void 0,content:void 0}}};function Xc(t){var e,n,i,r,a,o=t.x,s=void 0===o?0:o,c=t.y,l=t.item,u=t.globalMetrics,h=t.symbolFn,f=void 0===h?cs:h,d=t.direction,g=void 0===d?"ltr":d,p=l.label.displayObject,y=l.label.bounds,v=l.symbol.meta,m="rtl"===g,x={x:m?s+u.maxLabelBounds.width:s+u.maxSymbolSize+u.spacing,y:c,width:u.maxLabelBounds.width,height:Math.max(u.maxSymbolSize,u.maxLabelBounds.height)},b=(e={x:m?s+u.maxLabelBounds.width+u.spacing:s,y:c,width:u.maxSymbolSize,height:x.height},n=v.size,i={align:void 0===v.align?.5:v.align,justify:void 0===v.justify?.5:v.justify},r=Math.max(0,e.width-n),a=Math.max(0,e.height-n),{x:e.x+n/2+i.align*r,y:e.y+n/2+i.justify*a}),w=f(G({},v,b));return delete w.collider,p.anchor=m?"end":"start",function(t,e,n){var i=n.textMetrics;if(t.height<i.height)return;var r=Math.max(0,t.width-i.width);e.baseline="hanging";var a=Math.max(0,t.height-i.height);e.x=t.x+n.align*r,e.y=t.y+n.justify*a}(x,p,{textMetrics:y,fontSize:parseInt(p.fontSize,10),align:0,justify:.5}),{item:{type:"container",data:l.label.displayObject.data,children:[w,p],collider:{type:"rect",x:s,y:c,width:u.maxItemBounds.width,height:u.maxItemBounds.height}},metrics:x}}function Zc(t,e){var n=t.items.length,i=Math.ceil(n/e),r="horizontal"===t.layout.orientation?"width":"height",a="width"===r?"horizontal":"vertical";return t.globalMetrics.maxItemBounds[r]*i+(i-1)*t.layout.margin[a]}function Jc(e,t){var r,a,i,o,n=t.onScroll,s=void 0===n?function(){}:n,c=null,l=0,u={itemize:function(t){r=function(t,e){for(var n,i,r=t.resolved,a=t.dock,o=[],s=r.items.items,c=r.symbols.items,l=r.labels.items,u=0,h=0,f=0,d=0;d<s.length;d++)if(!1!==s[d].show){var g=void 0!==l[d].text?l[d].text:l[d].data.label||"";n=G({},l[d],{type:"text",fontSize:"".concat(parseInt(l[d].fontSize,10),"px"),text:g,title:g}),i={symbol:{meta:c[d]},label:{displayObject:n,bounds:e.textBounds(n)}},o.push(i),u=Math.max(c[d].size,u),h=Math.max(i.label.bounds.width,h),f=Math.max(i.label.bounds.height,f)}return{items:o,globalMetrics:{spacing:8,maxSymbolSize:u,maxItemBounds:{height:Math.max(u,f),width:u+8+h},maxLabelBounds:{width:h,height:f}},layout:{margin:{vertical:void 0!==r.layout.item.vertical?r.layout.item.vertical:8,horizontal:void 0!==r.layout.item.horizontal?r.layout.item.horizontal:8},mode:r.layout.item.mode,size:r.layout.item.size,orientation:"top"===a||"bottom"===a?"horizontal":"vertical",direction:r.layout.item.direction,scrollOffset:r.layout.item.scrollOffset}}}(t,e.renderer),c=null!==c||isNaN(r.layout.scrollOffset)?c:r.layout.scrollOffset},getItemsToRender:function(t){i=t.viewRect,l=u.getContentOverflow(i);var e=u.extent();c=Math.max(0,Math.min(c,l)),o=G({},i);var n="horizontal"===u.orientation()?"x":"y";return o[n]-=c,o["x"===n?"width":"height"]=e,function(t,e,n){for(var i=t.viewRect,r=n.itemized,a=n.create,o=void 0===a?Xc:a,s=n.parallels,c=r.layout.direction,l=r.globalMetrics,u=r.items,h="horizontal"===r.layout.orientation,f=0,d=[],g=l.maxItemBounds.height,p=l.maxItemBounds.width,y=r.layout.margin.vertical+g,v=r.layout.margin.horizontal+p,m=e.x,x=e.y,b=i.x-e.x,w=0;w<u.length;w++){var k=o({y:x,x:"rtl"===c?i.x+b+i.width-p-(m-e.x):m,item:u[w],globalMetrics:l,direction:c});if((h&&m>=i.x-p||!h&&x>=i.y-g)&&d.push(k.item),s<=++f?(f=0,h?(m+=v,x=e.y):(x+=y,m=e.x)):h?x+=y:m+=v,!h&&x>i.y+i.height)break;if(h&&m>i.x+i.width)break}return d}(t,o,{itemized:r,parallels:a})},parallelize:function(t,e){return a=function(t,e,n){var i=n.items.length,r="horizontal"===n.layout.orientation?"width":"height",a="width"===r?"horizontal":"vertical",o=n.globalMetrics.maxItemBounds[r]*i+(i-1)*n.layout.margin[a],s=Math.ceil(o/t);if(null!=e){var c="horizontal"===n.layout.orientation?"height":"width",l=Math.floor(e/(4+n.globalMetrics.maxItemBounds[c]));s=Math.min(s,l)}var u=isNaN(n.layout.size)?1:n.layout.size;return Math.max(1,Math.min(s,u))}(t,e,r)},hasContentOverflow:function(){var t="horizontal"===r.layout.orientation?"width":"height";return Zc(r,a)>i[t]},getContentOverflow:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i,e="horizontal"===r.layout.orientation?"width":"height";return Math.max(0,Zc(r,a)-t[e])},getNextSize:function(){var t="horizontal"===r.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return r.globalMetrics.maxItemBounds[t]+r.layout.margin[e]},getPrevSize:function(){var t="horizontal"===r.layout.orientation?"width":"height",e="width"===t?"horizontal":"vertical";return r.globalMetrics.maxItemBounds[t]+r.layout.margin[e]},hasNext:function(){return"horizontal"===u.orientation()?i.x+i.width<o.x+o.width:i.y+i.height<o.y+o.height},hasPrev:function(){return"horizontal"===u.orientation()?o.x<i.x:o.y<i.y},next:function(){u.scroll(-u.getNextSize())},prev:function(){u.scroll(u.getPrevSize())},scroll:function(t){var e=Math.max(0,Math.min(l,c-t));e!==c&&(c=e,s())},offset:function(){return c},orientation:function(){return r.layout.orientation},direction:function(){return r.layout.direction},extent:function(){return Zc(r,a)},spread:function(){return e=a,n="horizontal"===(t=r).layout.orientation?"height":"width",i="width"===n?"horizontal":"vertical",t.globalMetrics.maxItemBounds[n]*e+(e-1)*t.layout.margin[i];var t,e,n,i}};return u}function Gc(e){return Object.keys(e).filter(function(t){return e[t]}).join(" ")}var Qc={up:"▲",right:"▶",down:"▼",left:"◀"};function Kc(t,e){var n=e.size,i=e.isActive,r=e.direction,a=e.nav,o=e.attrs,s={},c="";a&&a.button&&("function"==typeof a.button.class?s=a.button.class({direction:r}):a.button.class&&(s=a.button.class),"function"==typeof a.button.content&&(c=a.button.content(t,{direction:r})));var l={width:"".concat(n,"px"),minWidth:"".concat(n,"px"),height:"".concat(n,"px")};Object.keys(s).length||(l.border="0",l.background="none");var u=o;return i||(u.disabled="disabled"),t("button",G({class:Gc(s),style:l},u),[c||t("span",{style:{pointerEvents:"none"}},[Qc[r]])])}function tl(e){var i,n={itemize:function(t){var e,n;n=(e=t).dock,i={layout:{orientation:"top"===n||"bottom"===n?"vertical":"horizontal"},navigation:e.navigation}},render:function(t){return function(t,e,n,i){var r=e.rect,a=e.itemRenderer;if(t&&t.renderArgs){t.size(r);var o=t.renderArgs[0],s="vertical"===n.layout.orientation,c="rtl"===a.direction(),l=a.hasNext(),u=a.hasPrev();if(u||l){var h=s?["right","left"]:["down","up"];c&&s&&h.reverse();var f=[o("div",{style:{position:"relative",display:"flex","flex-direction":s?"column":"row","justify-content":"center",height:"100%",pointerEvents:"auto"},dir:c&&!s?"rtl":"ltr"},[Kc(o,{size:32,isActive:l,direction:h[0],attrs:{"data-action":"next","data-component-key":i.settings.key},nav:n.navigation}),Kc(o,{size:32,isActive:u,direction:h[1],attrs:{"data-action":"prev","data-component-key":i.settings.key},nav:n.navigation})])];t.render(f)}else t.render([])}}(n.renderer,t,i,e)},extent:function(){return 32},spread:function(){return 64}};return n}function el(e){var n,i={itemize:function(t){n=function(t,e){var n=t.resolved;if(!1===n.title.item.show)return null;var i=G({},n.title.item,{type:"text"});if("rtl"===n.layout.item.direction&&(i.anchor&&"start"!==i.anchor?"end"===i.anchor&&(i.anchor="start"):i.anchor="end"),void 0===n.title.settings.text){var r=e.scale.data().fields;i.text=r&&r[0]?r[0].title():""}return{displayObject:i,bounds:e.renderer.textBounds(i)}}(t,e)},render:function(t){!function(t,e,n){var i=t.rect;if(e){var r=[];if(e.size(i),n){var a={start:0,end:i.width,middle:i.width/2};r.push(G({},n.displayObject,{x:a[n.displayObject.anchor]||0,y:0,baseline:"hanging",title:n.displayObject.text}))}e.render(r)}}(t,i.renderer,n)},spread:function(){return n?1.25*n.bounds.height:0},extent:function(){return n?n.bounds.width:0}};return i}function nl(t,e,n,i){var r,a,o,s=i.itemRenderer,c=i.navigationRenderer,l=i.titleRenderer,u=i.isPreliminary,h=void 0!==u&&u,f=0,d={x:e.spacing,y:e.spacing,width:t.width-2*e.spacing,height:t.height-2*e.spacing};if(r={x:d.x,y:d.y,width:d.width,height:l.spread()},"horizontal"===n){r={x:d.x,y:d.y,width:l.extent(),height:l.spread()};var g=d.width-r.width-(r.width?e.spacing:0),p=d.height;s.parallelize(g,h?void 0:p);var y=s.extent()>g?c.extent():0,v=s.spread(),m=y?c.spread():0;o={x:(a={x:r.x+r.width+(r.width?e.spacing:0),y:d.y+Math.max(0,(m-v)/2),width:d.width-y-r.width-(y?e.spacing:0)-(r.width?e.spacing:0),height:p}).x+a.width+(y?e.spacing:0),y:d.y,width:y,height:d.height},r.y=a.y,"rtl"===s.direction()&&(o.x=d.x,a.x=o.x+o.width+(o.width?e.spacing:0),r.x=a.x+a.width+(r.width?e.spacing:0)),f=Math.max(r.height,m,s.spread())}else{var x=d.height-r.height-(r.height?e.spacing:0),b=d.width;s.parallelize(x,h?void 0:b);var w=s.extent()>x?c.extent():0;o={x:d.x,y:d.y+d.height-w,width:d.width,height:w},a={x:d.x,y:r.y+r.height+(r.height?e.spacing:0),width:d.width,height:d.height-r.height-(r.height?e.spacing:0)-o.height-(o.height?e.spacing:0)},f=Math.max(l.extent(),w?c.spread():0,s.spread())}return a=G({},t,{x:t.x+a.x,y:t.y+a.y,width:a.width,height:a.height}),o.x+=t.x,o.y+=t.y,r.x+=t.x,r.y+=t.y,{title:G({},t,r),content:G({},t,a),navigation:G({},t,o),orientation:n,preferredSize:f}}function il(t){t.state.resolved=function(i){var r=i.scale.domain(),t={items:[]};if("threshold-color"===i.scale.type){var e=i.scale.data().fields[0],n=function(t){return String(t)};i.settings.formatter?n=i.chart.formatter(i.settings.formatter):e&&(n=e.formatter());for(var a=0;a<r.length-1;a++){var o={value:r[a],label:"".concat(n(r[a])," - < ").concat(n(r[a+1]))};e&&(o.source={field:e.id()}),t.items.push(o)}"vertical"==("top"===i.settings.dock||"bottom"===i.settings.dock?"horizontal":"vertical")&&t.items.reverse()}else{var s=i.scale.labels?i.scale.labels():null;t.items=r.map(function(t,e){var n=i.scale.datum?G({},i.scale.datum(t)):{value:t};return i.scale.datum&&((n=G({},i.scale.datum(t))).value=t),i.scale.label?n.label=i.scale.label(t):s&&(n.label=s[e]),n})}var c=i.resolver.resolve({data:{fields:i.scale.data().fields},defaults:G(!0,{},Yc.title,i.style.title),settings:i.settings.settings.title}),l=i.resolver.resolve({data:{fields:i.scale.data().fields},defaults:Yc.layout,settings:i.settings.settings.layout}),u=i.resolver.resolve({data:t,defaults:G(!0,{},Yc.item.label,i.style.item.label),settings:(i.settings.settings.item||{}).label}),h=G(!0,{},(i.settings.settings.item||{}).shape);void 0===h.fill&&i.settings.scale&&(h.fill={scale:i.settings.scale});var f=i.resolver.resolve({data:t,defaults:G(!0,{},Yc.item.shape,i.style.item.shape),settings:h}),d=i.resolver.resolve({data:t,defaults:G(!0,{},{show:Yc.item.show}),settings:{show:(i.settings.settings.item||{}).show}});function g(t,e){var n=t.data.value,i=r[e+1];t.data.value=[n,i]}return"threshold-color"===i.scale.type&&("vertical"==("top"===i.settings.dock||"bottom"===i.settings.dock?"horizontal":"vertical")?(d.items.reverse().forEach(g),d.items.reverse()):d.items.forEach(g)),{title:c,labels:u,symbols:f,items:d,layout:l}}(t),t.titleRenderer.itemize({resolved:t.state.resolved,dock:t.settings.dock||"center"}),t.itemRenderer.itemize({resolved:t.state.resolved,dock:t.settings.dock||"center"}),t.navigationRenderer.itemize({resolved:t.state.resolved,dock:t.settings.dock||"center",navigation:t.settings.settings.navigation}),t.state.display={spacing:8}}function rl(t){var e=t.rect,n=t.settings,i=t.state,r=t.itemRenderer,a=t.navigationRenderer,o=t.titleRenderer,s="top"===n.dock||"bottom"===n.dock?"horizontal":"vertical",c=nl(e,i.display,s,{itemRenderer:r,navigationRenderer:a,titleRenderer:o});t.renderer.size(c.content);var l=r.getItemsToRender({viewRect:G({},c.content,{x:0,y:0})});return a.render({rect:c.navigation,itemRenderer:r}),o.render({rect:c.title}),t.state.views={layout:c},l}var al={require:["chart","settings","renderer","update","resolver","registries"],defaultSettings:{settings:{},style:{item:{label:"$label",shape:"$shape"},title:"$title"}},mounted:function(t){t&&t.parentNode&&(this.navigationRenderer.renderer.appendTo(t.parentNode),this.titleRenderer.renderer.appendTo(t.parentNode)),this.navigationRenderer.render({rect:this.state.views.layout.navigation,itemRenderer:this.itemRenderer}),this.titleRenderer.render({rect:this.state.views.layout.title})},beforeUnmount:function(){this.navigationRenderer.renderer.clear(),this.titleRenderer.renderer.clear()},on:{panstart:function(){this.state.interaction.started||this.itemRenderer.getContentOverflow()&&(this.state.interaction.started=!0,this.state.interaction.delta=0)},panmove:function(t){if(this.state.interaction.started){var e="horizontal"===this.itemRenderer.orientation()?("rtl"===this.itemRenderer.direction()?-1:1)*t.deltaX:t.deltaY;this.itemRenderer.scroll(e-this.state.interaction.delta),this.state.interaction.delta=e}},panend:function(){this.state.interaction.started=!1},scroll:function(t){this.itemRenderer.scroll(-t)},next:function(){this.itemRenderer.next()},prev:function(){this.itemRenderer.prev()}},created:function(){var e=this;this.rect={x:0,y:0,width:0,height:0},this.state={interaction:{}},this.onScroll=function(){var t=rl(e);e.update(t)},this.itemRenderer=Jc(this,{onScroll:this.onScroll}),this.navigationRenderer=tl(this),this.titleRenderer=el(this),this.navigationRenderer.renderer=this.registries.renderer("dom")(),this.titleRenderer.renderer=this.registries.renderer(this.settings.renderer)(),il(this)},preferredSize:function(t){return n=t,i=0,r=(e=this).settings.dock||"center",a="top"===r||"bottom"===r?"horizontal":"vertical",o=e.state.display,s=nl(n.inner,o,a,{itemRenderer:e.itemRenderer,navigationRenderer:e.navigationRenderer,titleRenderer:e.titleRenderer,isPreliminary:!0}),i+=o.spacing,i+=s.preferredSize,i+=o.spacing;var e,n,i,r,a,o,s},beforeUpdate:function(){il(this)},beforeRender:function(t){this.rect=t.size},render:function(){return rl(this)},beforeDestroy:function(){this.navigationRenderer.renderer.destroy(),this.titleRenderer.renderer.destroy()},_DO_NOT_USE_getInfo:function(){return{offset:this.itemRenderer.offset()}}};function ol(t,e){var n=0,i=t.state.isVertical?"justify":"align",r=t.state.isVertical?"y":"x",a=t.state.isVertical?"height":"width",o=t.state.isVertical?"requiredHeight":"requiredWidth";n=t.state.rect[a]-t.state.legend.length()-t.state.title[o](),n*=Math.min(1,Math.max(t.stgns[i],0)),e[r]+=n}function sl(t,e,n){var i=n[t];return"object"===Q(i)?-1!==i.valid.indexOf(e)?e:i.default:n.default}function cl(t,e){var n={x:0,y:0,width:0,height:0},i=t.stgns.padding;return n.x=i.left,n.y=i.top,n.width=e.width-i.left-i.right,n.height=e.height-i.top-i.bottom,n}function ll(i){var r,a,t,o,e,n,s="top"!==i.settings.dock&&"bottom"!==i.settings.dock,c=i.stgns.title,l=i.chart.scale(i.stgns.fill),u=i.chart.scale(i.stgns.major),h=(r=i,t=(a=u).domain(),o=t,!(e=r.stgns.tick.label)&&r.formatter?e=r.formatter:!e&&a.data().fields&&(e=a.data().fields[0].formatter()),"function"==typeof e&&(o=t.map(e).map(String)),t.map(function(t,e){var n=o[e];return{value:t,label:n,pos:a.norm(parseFloat(t,10)),textMetrics:r.renderer.measureText({text:n,fontSize:r.stgns.tick.fontSize,fontFamily:r.stgns.tick.fontFamily})}})),f=sl((n=i.settings).dock,n.settings.tick.anchor,{left:{valid:["left","right"],default:"left"},right:{valid:["left","right"],default:"right"},top:{valid:["top","bottom"],default:"top"},bottom:{valid:["top","bottom"],default:"bottom"},default:"right"});if(void 0===c.text){var d=u.data().fields;c.text=d&&d[0]?d[0].title():""}var g,p=i.renderer.measureText({text:c.text,fontSize:c.fontSize,fontFamily:c.fontFamily}),y=i.renderer.textBounds({text:c.text,fontSize:c.fontSize,fontFamily:c.fontFamily,maxLines:c.maxLines,maxWidth:c.maxLengthPx,wordBreak:c.wordBreak,hyphens:c.hyphens,lineHeight:c.lineHeight}),v={isVertical:s,nodes:[],title:{anchor:(g=i.settings,sl(g.dock,g.settings.title.anchor,{left:{valid:["top"],default:"top"},right:{valid:["top"],default:"top"},top:{valid:["left","right"],default:"left"},bottom:{valid:["left","right"],default:"left"},default:"top"})),textMetrics:p,textBounds:y,requiredWidth:function(){if(!c.show)return 0;var t=y.width,e=c.maxLengthPx;return s||(t+=c.padding,e+=c.padding),Math.min(t,e,v.rect.width)},requiredHeight:function(){if(!c.show)return 0;var t=y.height;return s&&(t+=c.padding),Math.min(t,v.rect.height)}},ticks:{values:h,anchor:f,length:Math.min(Math.max.apply(Math,K(h.map(function(t){return t.textMetrics.width}))),i.stgns.tick.maxLengthPx),requiredHeight:function(){return"top"===f?Math.max.apply(Math,K(v.ticks.values.map(function(t){return t.textMetrics.height})))+i.stgns.tick.padding:0},height:Math.max.apply(Math,K(h.map(function(t){return t.textMetrics.height})))},legend:{fillScale:l,majorScale:u,length:function(){var t=s?"height":"width",e=s?"requiredHeight":"requiredWidth",n=Math.min(v.rect[t],v.rect[t]*i.stgns.length)-v.title[e]();return Math.max(0,Math.min(n,i.stgns.maxLengthPx))}}};return v}var ul={require:["chart","settings","renderer"],defaultSettings:{displayOrder:0,dock:"right",settings:{size:15,length:.5,maxLengthPx:250,align:.5,justify:0,padding:{left:5,right:5,top:5,bottom:5},tick:{label:null,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,anchor:null,padding:5},title:{show:!0,text:void 0,fill:"#595959",fontSize:"12px",fontFamily:"Arial",maxLengthPx:100,padding:5,maxLines:2,wordBreak:"none",lineHeight:1.2,hyphens:"auto",anchor:null}}},preferredSize:function(t){var e=this.state;e.rect=cl(this,t.inner);var n=this.stgns.size,i=e.isVertical?this.stgns.padding.left+this.stgns.padding.right:this.stgns.padding.top+this.stgns.padding.bottom;n+=i;var r=Math.max(t.inner.width,t.inner.height);if("left"===e.ticks.anchor||"right"===e.ticks.anchor){if(e.ticks.values.reduce(function(t,e){return t+e.textMetrics.height},0)>this.state.legend.length())return r;n+=e.ticks.length}else{if(e.ticks.length>this.state.legend.length())return r;n+=Math.max.apply(Math,K(e.ticks.values.map(function(t){return t.textMetrics.height})))}return n+=this.stgns.tick.padding,this.stgns.title.show&&(n="left"===e.title.anchor||"right"===e.title.anchor?Math.max(e.title.textBounds.height+i,n):Math.max(n,e.title.requiredWidth()+i)),this.state.preferredSize=n},created:function(){this.stgns=this.settings.settings,this.state=ll(this)},beforeUpdate:function(t){this.stgns=t.settings.settings,this.state=ll(this)},beforeRender:function(t){if(this.state.nodes=[],this.state.rect=cl(this,t.size),this.stgns.title.show){var e=function(t){var e=t.state,n=t.stgns,i="left"===e.ticks.anchor,r="top"===e.ticks.anchor,a=e.rect.x,o=e.rect.y,s="start";"left"===e.title.anchor?(a+=e.title.requiredWidth()-n.title.padding,o+=e.title.textMetrics.height,o+=r?e.rect.height-e.title.textBounds.height:0,s="end"):"right"===e.title.anchor?(a+=e.legend.length(),a+=n.title.padding,o+=e.title.textMetrics.height,o+=r?e.rect.height-e.title.textBounds.height:0):"top"===e.title.anchor&&(a+=i?e.rect.width:0,o+=e.title.textMetrics.height,s=i?"end":"start");var c={tag:"legend-title",type:"text",x:a,y:Math.min(o,e.rect.y+e.rect.height),text:n.title.text,fill:n.title.fill,fontSize:n.title.fontSize,fontFamily:n.title.fontFamily,maxWidth:n.title.maxLengthPx,maxLines:n.title.maxLines,wordBreak:n.title.wordBreak,hyphens:n.title.hyphens,lineHeight:n.title.lineHeight,anchor:s,title:n.title.text};return ol(t,c),c}(this);this.state.nodes.push(e)}var n,i,r,a,o,s,c,l,u,h=function(t,e){var n=t.state,i=t.stgns,r=n.rect,a=r.x,o=r.y,s=n.isVertical?i.size:n.legend.length(),c=n.isVertical?n.legend.length():i.size;"left"===n.ticks.anchor?a+=n.rect.width-i.size:"top"===n.ticks.anchor&&(o+=n.rect.height-i.size),"top"===n.title.anchor?o+=n.title.requiredHeight():"left"===n.title.anchor&&(a+=n.title.requiredWidth());var l={type:"rect",x:a,y:o,width:s,height:c,fill:{type:"gradient",stops:e,degree:n.isVertical?90:180}};return ol(t,l),l}(this,(i=(n=this).state.legend.fillScale,r=n.state.legend.majorScale,i.domain().map(function(t){return{type:"stop",color:i(t),offset:Math.min(1,Math.max(0,r.norm(t)))}}).sort(function(t,e){return t.offset-e.offset}))),f={id:"legend-seq-target",type:"container",children:[h,(o=h,s=(a=this).state,c=a.stgns,l="start",u={type:"rect",x:o.x,y:o.y,width:s.isVertical?0:o.width,height:s.isVertical?o.height:0,fill:"transparent"},{type:"container",id:"legend-seq-ticks",children:K(s.ticks.values.map(function(t){var e=0,n=0,i=0;return s.isVertical?(n=o.y+o.height*t.pos,i=1===t.pos?-t.textMetrics.height/5:t.textMetrics.height):e=o.x+o.width*t.pos,"right"===s.ticks.anchor?(e=o.x+c.size+c.tick.padding,u.x=o.x+o.width):"left"===s.ticks.anchor?(e=o.x-c.tick.padding,l="end"):"top"===s.ticks.anchor?(n=o.y-c.tick.padding,i-=.25*t.textMetrics.height,l=0===t.pos?"start":"end"):"bottom"===s.ticks.anchor&&(n=o.y+o.height+c.tick.padding,i=.8*t.textMetrics.height,l=0===t.pos?"start":"end",u.y=o.y+o.height),{type:"text",x:e,y:n,dx:0,dy:i,text:t.label,fontSize:c.tick.fontSize,fontFamily:c.tick.fontFamily,fill:c.tick.fill,maxWidth:s.isVertical?c.tick.maxLengthPx:Math.min(c.tick.maxLengthPx,s.legend.length()/2),anchor:l,textBoundsFn:a.renderer.textBounds,title:t.label}})).concat([u])})]};this.state.nodes.push(f)},render:function(){return this.state.nodes}};var hl={step:function(t){return new Xt(t,.5)},stepAfter:function(t){return new Xt(t,1)},stepBefore:function(t){return new Xt(t,0)},linear:St,basis:function(t){return new Ot(t)},cardinal:Ft.tension(0),catmullRom:Lt,monotonex:function(t){return new Vt(t)},monotoney:function(t){return new qt(t)},natural:function(t){return new Ht(t)}},fl={coordinates:{minor:.5,major:.5,layerId:0},orientation:"horizontal",layers:{curve:"linear",show:!0,sort:void 0,line:{stroke:"#ccc",strokeWidth:1,strokeLinejoin:"miter",strokeDasharray:void 0,opacity:1,show:!0},area:{fill:"#ccc",opacity:.8,show:!0}}};function dl(t,e){var n=e.generator,i=e.item,r=e.data,a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",o={type:"path",d:n(t),opacity:i.opacity,stroke:i.stroke,strokeWidth:i.strokeWidth,strokeLinejoin:i.strokeLinejoin,fill:a||i.fill,data:r};return i.strokeDasharray&&(o.strokeDasharray=i.strokeDasharray),o}function gl(l){var t=function(t){for(var e=t.data,n=t.stngs,i=t.rect,r=t.resolver,a=t.style,o=i.width,s=i.height,c=r.resolve({data:e,defaults:fl.coordinates,settings:n.coordinates||{},scaled:{major:"vertical"===n.orientation?s:o,minor:"vertical"===n.orientation?o:s}}),l={},u=0,h=0;h<c.items.length;h++){var f=c.items[h],d=f.layerId;l[d]=l[d]||{order:u++,id:d,items:[],firstPoint:f.data},l[d].items.push(f)}var g=Object.keys(l).map(function(t){return l[t]}),p={items:g.map(function(t){return t.firstPoint})},y=n.layers||{};return{coordinates:c,metaLayers:g,layers:r.resolve({data:p,defaults:{curve:fl.layers.curve,show:fl.layers.show},settings:{curve:y.curve,show:y.show}}),lines:r.resolve({data:p,defaults:G({},fl.layers.line,a.line),settings:y.line}),areas:r.resolve({data:p,defaults:G({},fl.layers.area,a.area),settings:y.area})}}(l),e=t.metaLayers,u=t.coordinates,h=t.layers,f=t.lines,d=t.areas,g=[];return e.forEach(function(t,e){var n=h.items[e];if(!1!==n.show){n.datum=n.data,n.data=[],n.id=t.id;for(var i,r,a=[],o=[],s=0;s<t.items.length;s++)r=(i=t.items[s]).data,isNaN(i.major)||(l.missingMinor0&&(i.minor0=u.settings.minor.scale?u.settings.minor.scale(r.minor0?r.minor0.value:0):0),isNaN(i.minor)||a.push(i.minor),o.push(i),n.data.push(i.data));var c=a.sort(function(t,e){return t-e})[Math.floor((a.length-1)/2)];g.push({layerObj:n,lineObj:f.items[e],areaObj:d.items[e],median:c,points:o,firstPoint:t.firstPoint})}}),g}var pl={require:["chart","resolver"],defaultSettings:{style:{area:"$shape",line:"$shape-outline"}},created:function(){},beforeRender:function(t){var e=t.size;this.rect=e},render:function(t){var e=t.data,n=this.rect,i=n.width,r=n.height;this.stngs=this.settings.settings||{};var a,o,h,f,d,g,p,y,s=!this.stngs.coordinates||void 0===this.stngs.coordinates.minor0,c=gl({data:e,stngs:this.stngs,rect:this.rect,resolver:this.resolver,style:this.style,missingMinor0:s});if(this.stngs.layers&&this.stngs.layers.sort){var l=c.map(function(t){return{id:t.layerObj.id,data:t.layerObj.data}});l.sort(this.stngs.layers.sort).map(function(t){return t.id}),c.sort(function(t,e){return l.indexOf(e.layerObj.id)-l.indexOf(t.layerObj.id)})}else c.sort(function(t,e){return t.median-e.median});return a=c,o={width:i,height:r,missingMinor0:s,stngs:this.stngs},h=o.width,f=o.height,d=o.missingMinor0,g=o.stngs,p=[],y=g.layers||{},a.forEach(function(t){var e,n,i=t.lineObj,r=t.layerObj,a=t.areaObj,o=t.points,s=Nt(),c={size:f,p:"y"},l={size:h,p:"x"};if("vertical"===g.orientation){var u=G(!0,{},l);l=G(!0,{},c),c=G(!0,{},u)}s[l.p](function(t){return t.major*l.size})["".concat(c.p,"1")](function(t){return t.minor*c.size})["".concat(c.p,"0")](function(t){return t.minor0*c.size}).defined(function(t){return"number"==typeof t.minor&&!isNaN(t.minor)}).curve(hl["monotone"===r.curve?"monotone".concat(l.p):r.curve]),e=s["line".concat(c.p.toUpperCase(),"1")](),n=s["line".concat(c.p.toUpperCase(),"0")](),y.area&&!1!==a.show&&p.push(dl(o,{data:t.firstPoint,item:a,generator:s})),i&&!1!==i.show&&(p.push(dl(o,{data:t.firstPoint,item:i,generator:e},"none")),!d&&y.area&&!1!==a.show&&p.push(dl(o,{data:t.firstPoint,item:i,generator:n},"none")))}),p}};function yl(t,e){var n,i,r=!(2<arguments.length&&void 0!==arguments[2])||arguments[2];i="object"===Q(e.center)?(n=e.center.x,e.center.y):(n=e.clientX,e.clientY);var a=n-t.state.boundingRect.left,o=i-t.state.boundingRect.top;return{x:r?Math.max(0,Math.min(a,t.rect.width)):a,y:r?Math.max(0,Math.min(o,t.rect.height)):o}}function vl(t,e){return{x:e.x+t.rect.x,y:e.y+t.rect.y}}function ml(t,e){var n=Math.min(t.x,e.x),i=Math.min(t.y,e.y);return{x:n,y:i,width:Math.max(t.x,e.x)-n,height:Math.max(t.y,e.y)-i}}var xl={require:["chart","renderer"],defaultSettings:{displayOrder:99,settings:{brush:{components:[]}},style:{area:"$selection-area-target"}},on:{areaStart:function(t){this.start(t)},areaMove:function(t){this.move(t)},areaEnd:function(t){this.end(t)},areaCancel:function(){this.cancel()}},created:function(){this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1}},preferredSize:function(){return 0},render:function(){},beforeRender:function(t){var e=t.size;this.rect=e},start:function(t){this.state.boundingRect=this.renderer.element().getBoundingClientRect();var e=yl(this,t,!1);wo({x:0,y:0,width:this.rect.width,height:this.rect.height},e)&&(this.state.brushConfig=this.settings.settings.brush.components.map(function(t){return{key:t.key,contexts:t.contexts,data:t.data,action:t.action||"set"}}),this.state.start=yl(this,t),this.state.active=!0)},move:function(t){var e;this.state.active&&(this.state.end=yl(this,t),function(t){if(t.state.active){var e=vl(t,t.state.start),n=vl(t,t.state.end),i=t.chart.shapesAt(ml(e,n),{components:t.state.brushConfig});t.chart.brushFromShapes(i,{components:t.state.brushConfig})}}(this),(e=this).renderer.render([G({type:"rect"},ml(e.state.start,e.state.end),e.style.area)]))},end:function(){this.state.active&&(this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))},cancel:function(){var t,e;this.state.active&&(t=this.state,e=this.chart,t.brushConfig.forEach(function(t){Array.isArray(t.contexts)&&t.contexts.forEach(function(t){e.brush(t).end()})}),this.state={start:{x:0,y:0},end:{x:0,y:0},active:!1},this.renderer.render([]))}};function bl(t,e,n){var i,r,a,o,s,c=n.renderer,l=n.style,u=n.props,h=n.h,f=(r=e,{tooltip:"function"==typeof(i=u).tooltipClass?i.tooltipClass({dock:r.dock}):i.tooltipClass,content:"function"==typeof i.contentClass?i.contentClass({dock:r.dock}):i.contentClass,arrow:"function"==typeof i.arrowClass?i.arrowClass({dock:r.dock}):i.arrowClass}),d=(a=h,o=t,s=l,u.content({h:a,style:s,data:o})),g=h("div",{dir:u.direction,class:Gc(G({"pic-tooltip":!0},f.tooltip)),style:G({position:"relative",display:"inline-block"},e.computedTooltipStyle)},h("div",{style:l.content,class:Gc(G({"pic-tooltip-content":!0},f.content))},d),h("div",{class:Gc(G({"pic-tooltip-arrow":!0},f.arrow)),style:G({},l.arrow,l["arrow-".concat(e.dock)],e.computedArrowStyle)}));return c.render(g),c.element().children[0]}function wl(t){var e,n,i=t.defaultDuration,r=t.defaultDelay,a=null,o=null,s=!1,c=(n={pending:[],debounced:[],active:[],cancelled:[],rejected:[],fulfilled:[]},(e=function(){}).set=function(e){n[e].forEach(function(t){return t(e)})},e.on=function(t,e){Array.isArray(t)?t.forEach(function(t){return n[t].push(e)}):n[t].push(e)},e),l=function(){},u=function(){o=a=null,s=!1,c.set("fulfilled")};return l.invoke=function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:i,n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:r;a&&(clearTimeout(a),c.set("debounced")),c.set("pending"),a=setTimeout(function(){t(),s=!0,a=null,c.set("active")},n),0<e&&(o&&clearTimeout(o),o=setTimeout(u,e+Math.max(n,0)))},l.clear=function(){s?c.set("cancelled"):a&&(clearTimeout(a),c.set("rejected")),o&&clearTimeout(o),o=a=null,s=!1},l.on=function(t,e){c.on(t,e)},l}function kl(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0;return{left:"translate(-100%,-50%) translateX(".concat(-t,"px)"),right:"translate(".concat(t,"px, -50%)"),top:"translate(-50%, -100%) translateY(".concat(-t,"px)"),bottom:"translate(-50%, ".concat(t,"px)")}}function Ml(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:0;return{left:{x:-t-n,y:-e/2},right:{x:n,y:-e/2},top:{x:-t/2,y:-e-n},bottom:{x:-t/2,y:n}}}function _l(t){return{left:{left:"100%",top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},right:{left:"".concat(2*-t,"px"),top:"calc(50% - ".concat(t,"px)"),borderWidth:"".concat(t,"px")},top:{left:"calc(50% - ".concat(t,"px)"),top:"100%",borderWidth:"".concat(t,"px")},bottom:{left:"calc(50% - ".concat(t,"px)"),top:"".concat(2*-t,"px"),borderWidth:"".concat(t,"px")}}}function Sl(t){var e=t.options,n=t.pointer,i=t.width,r=t.height,a=t.dockOrder,o=t.x,s=t.y,c=n.targetBounds,l=kl(e.offset),u=l[e.dock];if(u)return{computedTooltipStyle:{left:"".concat(o,"px"),top:"".concat(s,"px"),transform:u},computedArrowStyle:_l(e.offset)[e.dock],dock:e.dock};for(var h,f,d,g,p,y,v,m,x,b,w,k,M,_={width:"target"===e.area?c.width:window.innerWidth,height:"target"===e.area?c.height:window.innerHeight},S=Ml(i,r,e.offset),R=[],z="target"===e.area?o:c.left+o,N="target"===e.area?s:c.top+s,C=0;C<a.length;C+=1){var A=a[C],T=(h={area:_,vx:z,vy:N,width:i,height:r,offset:S[A]},M=k=w=b=x=m=void 0,f=h.area,d=h.vx,g=h.vy,p=h.width,y=h.height,v=h.offset,m=d+v.x,x=g+v.y,w=y,k=m<0?-m:0,M=x<0?-x:0,{x:k+=m+(b=p)>f.width?-(m+b-f.width):0,y:M+=x+w>f.height?-(x+w-f.height):0}),E={left:"".concat(o,"px"),top:"".concat(s,"px"),transform:l[A]},O=_l(e.offset)[A];0!==T.x&&(E.width="".concat(i-20-Math.abs(T.x),"px"),"top"!==A&&"bottom"!==A||(E.left="".concat(o+T.x,"px"),O.left="calc(50% ".concat(0<T.x?"-":"+"," ").concat(Math.abs(T.x),"px)")));var j={computedTooltipStyle:E,computedArrowStyle:O,dock:A,rect:{width:i,height:r}};if(0===T.x&&0===T.y)return j;j.offset=T,R.push(j)}return R.sort(function(t,e){return Math.abs(t.offset.x)-Math.abs(e.offset.x)}),R[0]}function Rl(t,e,n){var i=t.key?n.component(t.key):n.componentsFromPoint({x:e.clientX,y:e.clientY})[0];if(!i)return{x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1}};var r=i.rect;return{x:r.margin.left+r.x*r.scaleRatio.x,y:r.margin.top+r.y*r.scaleRatio.y,width:r.width*r.scaleRatio.x,height:r.height*r.scaleRatio.y,scaleRatio:r.scaleRatio}}var zl,Nl={bounds:function(t){var e=t.resources,n=t.nodes,i=t.pointer,r=t.width,a=t.height,o=t.options,s=i.targetBounds,c=e.getNodeBoundsRelativeToTarget(n[0]),l=c.x,u=c.y,h=c.width,f=c.height,d={left:{x:l,y:u+f/2},right:{x:l+h,y:u+f/2},top:{x:l+h/2,y:u},bottom:{x:l+h/2,y:u+f}},g=kl(o.offset),p=g[o.dock];if(p)return{computedTooltipStyle:{left:"".concat(d[o.dock].x,"px"),top:"".concat(d[o.dock].y,"px"),transform:p},computedArrowStyle:_l(o.offset)[o.dock],dock:o.dock};for(var y,v,m,x,b,w,k,M,_,S={width:"target"===o.area?s.width:window.innerWidth,height:"target"===o.area?s.height:window.innerHeight},R=Ml(r,a,o.offset),z=["top","left","right","bottom"],N=0;N<z.length;N+=1){var C=z[N],A="target"===o.area?d[C].x:s.left+d[C].x,T="target"===o.area?d[C].y:s.top+d[C].y;if(y=S,v=A,m=T,x=r,b=a,w=R[C],_=M=k=void 0,k=v+w.x,M=m+w.y,_=b,!(k<0||M<0||k+x>y.width||M+_>y.height))return{computedTooltipStyle:{left:"".concat(d[C].x,"px"),top:"".concat(d[C].y,"px"),transform:g[C]},computedArrowStyle:_l(o.offset)[C],dock:C}}return{computedTooltipStyle:{left:"".concat(d.top.x,"px"),top:"".concat(d.top.y,"px"),transform:g.top},computedArrowStyle:_l(o.offset).top,dock:"top"}},pointer:function(t){var e=t.options,n=t.pointer,i=t.width,r=t.height;return Sl({x:n.x,y:n.y,pointer:n,width:i,height:r,options:e,dockOrder:["top","left","right","bottom"]})},slice:function(t){var e=t.options,n=t.pointer,i=t.width,r=t.height,a=t.nodes,o=t.resources,s=a[0],c=n.dx,l=n.dy,u=o.getComponentBoundsFromNode(s),h=c+u.x+u.width/2,f=l+u.y+u.height/2,d=s.desc.slice,g=d.start,p=d.end,y=d.outerRadius,v=(g+p)/2-Math.PI/2,m=2*Math.PI,x=(v%m+m)%m,b=["top","left","right","bottom"];return"auto"===e.dock&&(b=x<=Math.PI/4||x>=7*Math.PI/4?["right","top","bottom","left"]:x<=3*Math.PI/4?["bottom","left","right","top"]:x<=5*Math.PI/4?["left","top","bottom","right"]:["top","left","right","bottom"]),Sl({x:h+y*u.scaleRatio.x*Math.cos(x),y:f+y*u.scaleRatio.y*Math.sin(x),pointer:n,width:i,height:r,options:e,dockOrder:b})}};function Cl(t,e){var n=t.width,i=t.height,a=e.chart,o=e.state,r=e.props,s={resources:{formatter:a.formatter,scale:a.scale,component:a.component,getComponentBoundsFromNode:function(t){return Rl(t,o.pointer,a)},getNodeBoundsRelativeToTarget:function(t){return e=t,n=o.pointer,i=Rl(e,n,a),r=e.bounds,{x:i.x+n.dx+r.x,y:i.y+n.dy+r.y,width:r.width,height:r.height};var e,n,i,r}},nodes:o.activeNodes,pointer:o.pointer,width:n,height:i},c=Q(r.placement);if("object"===c&&"function"==typeof r.placement.fn)return r.placement.fn(s);var l={type:"pointer",offset:8,dock:"auto",area:"viewport"};return"function"===c&&(l=G(l,r.placement(s))),"object"===c&&Nl[r.placement.type]?l=G(l,r.placement):"string"===c&&Nl[r.placement]&&(l=G(l,{type:r.placement})),s.options=l,Nl[l.type](s)}var Al={require:["chart","renderer"],defaultSettings:{settings:{duration:8e3,delay:500,filter:function(t){return t.filter(function(t){return t.data&&void 0!==t.data.value})},extract:function(t){return t.node.data.value},content:function(t){var e=t.h;return t.data.map(function(t){return e("div",{},t)})},isEqual:function(t,n){return t.length&&t.length===n.length&&t.every(function(t,e){return n[e]&&JSON.stringify(t.data)===JSON.stringify(n[e].data)})},placement:{type:"pointer",dock:"auto",offset:8,area:"viewport"},tooltipClass:{},contentClass:{},arrowClass:{},direction:"ltr",appendTo:void 0,beforeShow:void 0,afterShow:void 0,beforeHide:void 0,onHide:void 0,afterHide:void 0},style:{tooltip:{},content:{backgroundColor:"$gray-25",color:"$font-color--inverted",fontFamily:"$font-family",fontSize:"$font-size",lineHeight:"$line-height",borderRadius:"4px",padding:"8px",opacity:.9},arrow:{position:"absolute",width:"0px",height:"0px",borderStyle:"solid",color:"$gray-25",opacity:.9},"arrow-bottom":{borderTopColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-top":{borderBottomColor:"transparent",borderLeftColor:"transparent",borderRightColor:"transparent"},"arrow-right":{borderTopColor:"transparent",borderLeftColor:"transparent",borderBottomColor:"transparent"},"arrow-left":{borderTopColor:"transparent",borderBottomColor:"transparent",borderRightColor:"transparent"}}},renderer:"dom",on:{hide:function(){this.hide()},show:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};this.show(t,e)},prevent:function(t){this.prevent(t)}},hide:function(){this.dispatcher.clear(),this.state.activeNodes=[],this.state.pointer={}},show:function(t){var e,n=this,i=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r=i.nodes,a=i.duration,o=i.delay;this.state.prevent||(this.state.pointer=function(t,e){var n=e.chart,i=e.state,r=0,a=0;t.center?(r+=t.center.x,a+=t.center.y):(r+=t.clientX,a+=t.clientY);var o=n.element.getBoundingClientRect(),s=i.targetElement.getBoundingClientRect(),c=r,l=a,u=o.left-s.left,h=o.top-s.top,f=r-o.left,d=a-o.top;return{x:r-=s.left,y:a-=s.top,dx:u,dy:h,cx:f,cy:d,clientX:c,clientY:l,targetBounds:s,chartBounds:o}}(t,this),e=Array.isArray(r)?this.props.filter(r):this.props.filter(this.chart.shapesAt({x:this.state.pointer.cx,y:this.state.pointer.cy})),this.props.isEqual(this.state.activeNodes,e)||(this.dispatcher.clear(),this.state.activeNodes=e,this.state.activeNodes.length&&this.dispatcher.invoke(function(){return n.invokeRenderer(n.state.activeNodes)},a,o)))},prevent:function(t){this.state.prevent=!!t},init:function(t){var e=this;this.state={activeNodes:[],pointer:{},targetElement:null,prevent:!1},this.props=t.settings,this.dispatcher=wl({defaultDuration:this.props.duration,defaultDelay:this.props.delay});var n=this.dispatcher.clear;this.dispatcher.on("pending",function(){var t;t=n,zl&&zl!==t&&zl(),zl=n,"function"==typeof e.props.beforeShow&&e.props.beforeShow.call(void 0,{resources:{formatter:e.chart.formatter,scale:e.chart.scale}})}),this.dispatcher.on(["cancelled","fulfilled"],function(){var t={resources:{formatter:e.chart.formatter,scale:e.chart.scale}};"function"==typeof e.props.beforeHide&&e.props.beforeHide.call(void 0,G({element:e.state.tooltipElm},t)),"function"==typeof e.props.onHide?e.props.onHide.call(void 0,G({element:e.state.tooltipElm},t)):e.renderer.clear([]),"function"==typeof e.props.afterHide&&e.props.afterHide.call(void 0,t),zl===n&&(zl=null),e.state.tooltipElm=void 0}),this.dispatcher.on("active",function(){"function"==typeof e.props.afterShow&&e.props.afterShow.call(void 0,{element:e.state.tooltipElm,resources:{formatter:e.chart.formatter,scale:e.chart.scale}})})},created:function(){this.init(this.settings)},beforeUpdate:function(t){var e=t.settings;this.dispatcher&&this.dispatcher.clear(),this.init(e)},beforeRender:function(t){this.rect=t.size},render:function(t){return this.h=t,[]},beforeDestroy:function(){this.dispatcher.clear()},appendTo:function(){if(this.props.appendTo){this.state.targetElement="function"==typeof this.props.appendTo?this.props.appendTo({resources:{formatter:this.chart.formatter,scale:this.chart.scale}}):this.props.appendTo;var t=this.state.targetElement.getBoundingClientRect(),e={width:t.width,height:t.height,scaleRatio:this.renderer.size().scaleRatio};this.renderer.destroy(),this.rect=this.renderer.size(e),this.renderer.appendTo(this.state.targetElement)}else this.state.targetElement=this.renderer.element()},mounted:function(){this.appendTo()},updated:function(){this.appendTo()},invokeRenderer:function(t){var e,n,i,r,a,o,s,c,l=(e=t,i=(n=this).chart,r=n.scale,a=n.props,o=n.h,s={resources:{dataset:i.dataset,scale:i.scale,formatter:i.formatter},scale:r,h:o},c=[],e.forEach(function(t){if("function"==typeof a.extract){var e=G({node:t},s);c.push(a.extract(e))}}),c),u=Cl(bl(l,{style:{left:"0px",top:"0px",visibility:"hidden"}},this).getBoundingClientRect(),this);this.state.tooltipElm=bl(l,u,this)}};var Tl={require:["renderer","chart"],defaultSettings:{settings:{target:"",selector:"*",fill:"rgba(0, 255, 0, 0.1)",stroke:"lime",opacity:1}},on:{update:function(){this.draw()}},draw:function(){var e=this,t=this.chart.findShapes(this.props.selector).filter(function(t){return t.key===e.props.target}).filter(function(t){return t.collider}).map(function(t){return t.collider});t.forEach(function(t){t.fill=e.props.fill,t.stroke=e.props.stroke,t.opacity=e.props.opacity,t.collider={type:null}}),this.renderer.render(t)},created:function(){this.props=this.settings.settings},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}},El=2*Math.PI;function Ol(t,e){return{x:(t.x+e.x)/2,y:(t.y+e.y)/2}}function jl(t,e,n,i,r){var a=1-t;return Math.pow(a,3)*e+3*Math.pow(a,2)*t*n+3*a*Math.pow(t,2)*i+Math.pow(t,3)*r}function Pl(t,e,n,i){var r,a,o,s,c=4<arguments.length&&void 0!==arguments[4]?arguments[4]:[];if(r=t,a=e,o=n,s=i,Math.abs(r.x+o.x-(a.x+a.x))+Math.abs(r.y+o.y-(a.y+a.y))+Math.abs(a.x+s.x-(o.x+o.x))+Math.abs(a.y+s.y-(o.y+o.y))<=10)return-1===c.indexOf(t)&&c.push(t),-1===c.indexOf(i)&&c.push(i),c;var l=Ol(t,e),u=Ol(e,n),h=Ol(n,i),f={x:jl(.5,t.x,e.x,n.x,i.x),y:jl(.5,t.y,e.y,n.y,i.y)},d=Ol(l,u),g=Ol(u,h);return Pl(t,l,d,f,c),Pl(f,g,h,i,c),c}function Fl(t,e,n){var i,r,a,o=(r=e,a=n,{cp1:{x:(i=t).x+2/3*(r.x-i.x),y:i.y+2/3*(r.y-i.y)},cp2:{x:a.x+2/3*(r.x-a.x),y:a.y+2/3*(r.y-a.y)}});return Pl(t,o.cp1,o.cp2,n)}var Dl=1e-12;function Ll(t,e,n){var i,r,a,o,s=[],c=!!t[4],l=!!t[5],u=t[3],h=t[6],f=t[7],d=t[1],g=t[2];if("a"===t[0]&&(h+=e,f+=n),e===f&&n===f)return s;if(!d||!g)return s.push({x:h,y:f}),s;var p=function(t,e,n,i,r,a,o,s,c){var l,u,h,f,d,g,p=rs(n%360),y=Math.cos(p),v=Math.sin(p),m=(s-a)/2,x=(c-o)/2,b=y*m+v*x,w=y*x-v*m;t=Math.abs(t),e=Math.abs(e),1<(g=Math.pow(b,2)/Math.pow(t,2)+Math.pow(w,2)/Math.pow(e,2))&&(t*=g=Math.sqrt(g),e*=g);var k=t*e,M=t*w,_=e*b,S=Math.pow(M,2)+Math.pow(_,2),R=Math.pow(k,2)-S,z=Math.sqrt(Math.max(R/S,0));i===r&&(z=-z);var N=z*(M/e),C=z*(-_/t);f=y*N-v*C+(s+a)/2,d=v*N+y*C+(c+o)/2;var A=(b-N)/t,T=(w-C)/e,E=(-b-N)/t,O=(-w-C)/e;return l=Math.atan2(T,A),l+=l<0?El:0,u=Math.atan2(O,E),h=(u+=u<0?El:0)-l,!r&&l<u?h-=El:r&&u<l&&(h+=El),{startAngle:l,sweepAngle:h%=El,cx:f,cy:d,rx:t,ry:e}}(d,g,u,c,l,h,f,e,n);i=p.cx,r=p.cy,d=p.rx,g=p.ry,a=p.sweepAngle,o=p.startAngle;for(var y=Math.abs(a*Math.sqrt((Math.pow(d,2)+Math.pow(g,2))/2)),v=Math.ceil(y/10),m=a/v,x=1;x<=v;x++){var b=(o+m*x)%El,w=Math.cos(b),k=Math.sin(b);s.push({x:i+w*d+-k*w,y:r+k*g+w*k})}return s}function Bl(t){for(var e=d(t),n=[],i=[],r=0,a=0,o=null,s=null,c=null,l=null,u=0;u<e.length;++u){var h=e[u],f=h[0];switch("S"!==f&&"s"!==f&&"C"!==f&&"c"!==f&&(s=o=null),"T"!==f&&"t"!==f&&"Q"!==f&&"q"!==f&&(l=c=null),f){case"m":i.length&&n.push(i.splice(0));case"l":r+=h[1],a+=h[2],i.push({x:r,y:a});break;case"M":i.length&&n.push(i.splice(0));case"L":r=h[1],a=h[2],i.push({x:r,y:a});break;case"H":r=h[1],i.push({x:r,y:a});break;case"h":r+=h[1],i.push({x:r,y:a});break;case"V":a=h[1],i.push({x:r,y:a});break;case"v":a+=h[1],i.push({x:r,y:a});break;case"a":i.push.apply(i,K(Ll(h,r,a))),r+=h[6],a+=h[7];break;case"A":i.push.apply(i,K(Ll(h,r,a))),r=h[6],a=h[7];break;case"c":i.push.apply(i,K(Pl({x:r,y:a},{x:h[1]+r,y:h[2]+a},{x:h[3]+r,y:h[4]+a},{x:h[5]+r,y:h[6]+a}))),o=h[3]+r,s=h[4]+a,r+=h[5],a+=h[6];break;case"C":i.push.apply(i,K(Pl({x:r,y:a},{x:h[1],y:h[2]},{x:h[3],y:h[4]},{x:h[5],y:h[6]}))),o=h[3],s=h[4],r=h[5],a=h[6];break;case"s":null!==o&&null!==o||(o=r,s=a),i.push.apply(i,K(Pl({x:r,y:a},{x:2*r-o,y:2*a-s},{x:h[1]+r,y:h[2]+a},{x:h[3]+r,y:h[4]+a}))),o=h[1]+r,s=h[2]+a,r+=h[3],a+=h[4];break;case"S":null!==o&&null!==o||(o=r,s=a),i.push.apply(i,K(Pl({x:r,y:a},{x:2*r-o,y:2*a-s},{x:h[1],y:h[2]},{x:h[3],y:h[4]}))),o=h[1],s=h[2],r=h[3],a=h[4];break;case"Q":i.push.apply(i,K(Fl({x:r,y:a},{x:h[1],y:h[2]},{x:h[3],y:h[4]}))),c=h[1],l=h[2],r=h[3],a=h[4];break;case"q":i.push.apply(i,K(Fl({x:r,y:a},{x:h[1]+r,y:h[2]+a},{x:h[3]+r,y:h[4]+a}))),c=h[1]+r,l=h[2]+a,r+=h[3],a+=h[4];break;case"T":null!==c&&null!==c||(c=r,l=a),c=2*r-c,l=2*a-l,i.push.apply(i,K(Fl({x:r,y:a},{x:c,y:l},{x:h[1],y:h[2]}))),r=h[1],a=h[2];break;case"t":null!==c&&null!==c||(c=r,l=a),c=2*r-c,l=2*a-l,i.push.apply(i,K(Fl({x:r,y:a},{x:c,y:l},{x:h[1]+r,y:h[2]+a}))),r+=h[1],a+=h[2];break;case"z":case"Z":i.length&&i.push({x:i[0].x,y:i[0].y})}}return function(t){for(var e=0;e<t.length-1;e++){var n=t[e],i=t[e+1];Math.abs(n.x-i.x)<Dl&&Math.abs(n.y-i.y)<Dl&&(t.splice(e,1),e--)}}(i),n.push(i.splice(0)),n}var Wl={require:["renderer","chart"],defaultSettings:{settings:{target:"",fill:"transparent",stroke:"lime",opacity:1,radius:2}},on:{update:function(){this.draw()}},draw:function(){var e=this,t=this.chart.findShapes("path").filter(function(t){return t.key===e.props.target}),n=[];t.forEach(function(t){Bl(t.attrs.d).forEach(function(t){t.forEach(function(t){n.push({type:"circle",cx:t.x,cy:t.y,r:e.props.radius,fill:e.props.fill,stroke:e.props.stroke,opacity:e.props.opacity,collider:{type:null}})})})}),this.renderer.render(n)},created:function(){this.props=this.settings.settings},render:function(){},mounted:function(){this.draw()},updated:function(){this.props=this.settings.settings,this.draw()}};var Il=[function(t){t.component("box",ts),t.component("box-marker",ts)},function(t){t.component("point",ds),t.component("point-marker",ds)},function(t){t.component("pie",ys)},function(t){t.component("grid-line",ws)},function(t){t.component("ref-line",Ss)},function(t){t.component("axis",Us)},function(t){t.component("text",Ys)},function(t){t.component("scrollbar",Js)},function(t){t.component("brush-range",fc),t.component("brush-area-dir",pc)},function(t){t.component("range",xc)},function(t){t.component("brush-lasso",Sc)},function(t){t.component("labels",Hc)},function(t){t.component("legend-cat",al)},function(t){t.component("legend-seq",ul)},function(t){t.component("line",pl)},function(t){t.component("brush-area",xl)},function(t){t.component("tooltip",Al)},function(t){t.component("debug-collider",Tl)},function(t){t.component("debug-path-to-points",Wl)}],$l=function(){function e(t){v(this,e),this._parent=null,this._children=[],this._ancestors=null,this.type=t,this.data=null}return x(e,[{key:"detach",value:function(){return this._parent&&this._parent.removeChild(this),this}},{key:"equals",value:function(t){var e=this.children,n=t.children;if(e.length!==n.length)return!1;for(var i=0;i<e.length;i++)if(!e[i].equals(n[i]))return!1;return!0}},{key:"toJSON",value:function(){return{type:this.type,children:this.children.map(function(t){return t.toJSON()})}}},{key:"parent",get:function(){return this._parent}},{key:"isBranch",get:function(){return this._children&&this._children.length}},{key:"children",get:function(){return this._children}},{key:"ancestors",get:function(){if(!this._ancestors){var t=this._parent;this._ancestors=t?[t].concat(t.ancestors):[]}return this._ancestors}},{key:"descendants",get:function(){var t,e,n,i=[];for(t=0,e=this._children.length;t<e;t++)n=this._children[t],i.push(n),n._children.length&&(i=i.concat(n.descendants));return i}}]),e}(),Vl=function(){function d(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,i=t.y,r=void 0===i?0:i,a=t.width,o=void 0===a?0:a,s=t.height,c=void 0===s?0:s,l=t.minWidth,u=void 0===l?0:l,h=t.minHeight,f=void 0===h?0:h;v(this,d),this.set({x:n,y:r,width:o,height:c,minWidth:u,minHeight:f})}return x(d,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,i=t.y,r=void 0===i?0:i,a=t.width,o=void 0===a?0:a,s=t.height,c=void 0===s?0:s,l=t.minWidth,u=void 0===l?0:l,h=t.minHeight,f=void 0===h?0:h;this.type="rect",this.width=0<=o?(this.x=n,Math.max(o,u)):(this.x=n+Math.min(o,-u),-Math.min(o,-u)),this.height=0<=c?(this.y=r,Math.max(c,f)):(this.y=r+Math.min(c,-f),-Math.min(c,-f))}},{key:"containsPoint",value:function(t){return wo(this,t)}},{key:"intersectsLine",value:function(t){return ko(this,B(t))}},{key:"intersectsRect",value:function(t){return bo(this,L(t))}},{key:"intersectsCircle",value:function(t){return go(t,this)}},{key:"intersectsPolygon",value:function(t){return xo(t,this)}},{key:"points",value:function(){return[{x:this.x,y:this.y},{x:this.x+this.width,y:this.y},{x:this.x+this.width,y:this.y+this.height},{x:this.x,y:this.y+this.height}]}}]),d}();var ql=function(){function l(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,n=void 0===e?0:e,i=t.cy,r=void 0===i?0:i,a=t.r,o=void 0===a?0:a,s=t.minRadius,c=void 0===s?0:s;v(this,l),this.set({cx:n,cy:r,r:o,minRadius:c})}return x(l,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,n=void 0===e?0:e,i=t.cy,r=void 0===i?0:i,a=t.r,o=void 0===a?0:a,s=t.minRadius,c=void 0===s?0:s;this.type="circle",this.cx=n,this.cy=r,this.r=Math.max(o,c),this.vector={x:this.cx,y:this.cy}}},{key:"containsPoint",value:function(t){return fo(this,t)}},{key:"intersectsLine",value:function(t){return po(this,B(t))}},{key:"intersectsRect",value:function(t){return go(this,L(t))}},{key:"intersectsCircle",value:function(t){return function(t,e){if(uo(t)||uo(e))return!1;var n=t.cx-e.cx,i=t.cy-e.cy;return Math.pow(n,2)+Math.pow(i,2)<=Math.pow(t.r+e.r,2)}(this,t)}},{key:"intersectsPolygon",value:function(t){return yo(this,t)}},{key:"points",value:function(){return[{x:this.cx,y:this.cy}]}}]),l}();var Ul=function(){function h(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,n=void 0===e?0:e,i=t.y1,r=void 0===i?0:i,a=t.x2,o=void 0===a?0:a,s=t.y2,c=void 0===s?0:s,l=t.tolerance,u=void 0===l?0:l;v(this,h),this.set({x1:n,y1:r,x2:o,y2:c,tolerance:u})}return x(h,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,n=void 0===e?0:e,i=t.y1,r=void 0===i?0:i,a=t.x2,o=void 0===a?0:a,s=t.y2,c=void 0===s?0:s,l=t.tolerance,u=void 0===l?0:l;this.type="line",this.x1=n,this.y1=r,this.x2=o,this.y2=c,this.tolerance=Math.max(0,Math.round(u)),this.vectors=this.points(),this.zeroSize=n===o&&r===c}},{key:"containsPoint",value:function(t){return 0<this.tolerance?po({cx:t.x,cy:t.y,r:this.tolerance},this):_o(this,t)}},{key:"intersectsLine",value:function(t){return Mo(this,B(t))}},{key:"intersectsRect",value:function(t){return ko(L(t),this)}},{key:"intersectsCircle",value:function(t){return po(t,this)}},{key:"intersectsPolygon",value:function(t){return mo(t,this)}},{key:"points",value:function(){return[{x:this.x1,y:this.y1},{x:this.x2,y:this.y2}]}}]),h}();var Hl=function(){function n(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).vertices,e=void 0===t?[]:t;v(this,n),this.set({vertices:e})}return x(n,[{key:"set",value:function(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).vertices,e=void 0===t?[]:t;if(this.type="polygon",this.vertices=e.slice(),this.edges=[],function(t){for(var e=0;e<t.length-1;e++){var n=t[e],i=t[e+1];n.x===i.x&&n.y===i.y&&(t.splice(e,1),e--)}}(this.vertices),!(this.vertices.length<=2)){var n,i,r;n=this.vertices,i=n[0],r=n[n.length-1],i.x===r.x&&i.y===r.y||n.push(i),this.xMin=NaN,this.yMin=NaN,this.xMax=NaN,this.yMax=NaN;for(var a=0;a<this.vertices.length;a++)a<this.vertices.length-1&&this.edges.push([this.vertices[a],this.vertices[a+1]]),this.xMin=isNaN(this.xMin)?this.vertices[a].x:Math.min(this.xMin,this.vertices[a].x),this.xMax=isNaN(this.xMax)?this.vertices[a].x:Math.max(this.xMax,this.vertices[a].x),this.yMin=isNaN(this.yMin)?this.vertices[a].y:Math.min(this.yMin,this.vertices[a].y),this.yMax=isNaN(this.yMax)?this.vertices[a].y:Math.max(this.yMax,this.vertices[a].y);this._bounds=null,this._boundingRect=null}}},{key:"containsPoint",value:function(t){return vo(this,t)}},{key:"intersectsCircle",value:function(t){return yo(t,this)}},{key:"intersectsLine",value:function(t){return mo(this,B(t))}},{key:"intersectsRect",value:function(t){return xo(this,L(t))}},{key:"intersectsPolygon",value:function(t){if(!bo(this.boundingRect(),t.boundingRect()))return!1;for(var e=!1,n=0,i=this.edges.length;n<i&&!0!==(e=mo(t,B(this.edges[n])));n++);return e}},{key:"points",value:function(){return this.vertices}},{key:"bounds",value:function(){return this._bounds||(this._bounds=[{x:this.xMin,y:this.yMin},{x:this.xMax,y:this.yMin},{x:this.xMax,y:this.yMax},{x:this.xMin,y:this.yMax}]),this._bounds}},{key:"boundingRect",value:function(){return this._boundingRect||(this._boundingRect={x:this.xMin,y:this.yMin,width:this.xMax-this.xMin,height:this.yMax-this.yMin}),this._boundingRect}}]),n}();function Yl(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Hl,e)}var Xl=function(){function n(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).points,e=void 0===t?[]:t;v(this,n),this.set({points:e})}return x(n,[{key:"set",value:function(){var t,e,n=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).points,i=void 0===n?[]:n;if(this.type="polyline",this.segments=[],this._points=i.slice(),1<this._points.length)for(var r=0,a=this._points.length-1;r<a;r++)t=this._points[r],e=this._points[r+1],(t.x!==e.x||t.y!==e.y)&&this.segments.push({x1:this._points[r].x,y1:this._points[r].y,x2:this._points[r+1].x,y2:this._points[r+1].y})}},{key:"containsPoint",value:function(e){return this.segments.some(function(t){return _o(t,e)})}},{key:"intersectsCircle",value:function(e){return this.segments.some(function(t){return po(e,t)})}},{key:"intersectsLine",value:function(t){var e=B(t);return this.segments.some(function(t){return Mo(t,e)})}},{key:"intersectsRect",value:function(t){var e=L(t);return this.segments.some(function(t){return ko(e,t)})}},{key:"intersectsPolygon",value:function(e){return this.segments.some(function(t){return mo(e,t)})}},{key:"points",value:function(){return this._points}}]),n}();var Zl=Kt();function Jl(t,e){return Zl.get(t)(e)}Zl.add("rect",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Vl,e)}),Zl.add("circle",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(ql,e)}),Zl.add("line",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Ul,e)}),Zl.add("polygon",Yl),Zl.add("polyline",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Xl,e)});var Gl=function(){function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];v(this,e),this.set(t)}return x(e,[{key:"set",value:function(){var n=this,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this.geometries=[],t.forEach(function(t){var e=Jl(t.type,t);e&&n.geometries.push(e)})}},{key:"containsPoint",value:function(e){return this.geometries.some(function(t){return t.containsPoint(e)})}},{key:"intersectsLine",value:function(e){return this.geometries.some(function(t){return t.intersectsLine(e)})}},{key:"intersectsRect",value:function(e){return this.geometries.some(function(t){return t.intersectsRect(e)})}},{key:"intersectsCircle",value:function(e){return this.geometries.some(function(t){return t.intersectsCircle(e)})}},{key:"intersectsPolygon",value:function(e){return this.geometries.some(function(t){return t.intersectsPolygon(e)})}}]),e}();var Ql=function(){function a(){v(this,a),this._elements=[[1,0,0],[0,1,0],[0,0,1]],this._stack=[]}return x(a,[{key:"clone",value:function(){return(new a).multiply(this)}},{key:"set",value:function(t){return this._elements=t,this}},{key:"save",value:function(){return this._stack.push(this.elements),this}},{key:"restore",value:function(){return this._stack.length&&(this._elements=this._stack.pop()),this}},{key:"add",value:function(t){var e,n;for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)this._elements[e][n]+=t;return this}},{key:"translate",value:function(t,e){return this.multiply([[1,0,t],[0,1,e],[0,0,1]]),this}},{key:"rotate",value:function(t){var e=Math.cos(-t),n=Math.sin(-t);return this.multiply([[e,n,0],[-n,e,0],[0,0,1]]),this}},{key:"multiply",value:function(t){var e,n,i,r;if(t instanceof a&&(t=t._elements),Array.isArray(t)){for(i=[[0,0,0],[0,0,0],[0,0,0]],e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)for(r=0;r<3;r++)i[e][n]+=this._elements[e][r]*t[r][n];this._elements=i}else for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)this._elements[e][n]*=t;return this}},{key:"scale",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:t;return this.multiply([[t,0,0],[0,e,0],[0,0,1]]),this}},{key:"transform",value:function(t,e,n,i,r,a){return this.multiply([[t,n,r],[e,i,a],[0,0,1]]),this}},{key:"determinant",value:function(){var t=this._elements[0][0],e=this._elements[0][1],n=this._elements[0][2],i=this._elements[1][0],r=this._elements[1][1],a=this._elements[1][2],o=this._elements[2][0],s=this._elements[2][1],c=this._elements[2][2];return t*r*c+e*a*o+n*i*s-n*r*o-e*i*c-t*a*s}},{key:"invert",value:function(){var t=this.determinant(),e=this._elements[0][0],n=this._elements[0][1],i=this._elements[0][2],r=this._elements[1][0],a=this._elements[1][1],o=this._elements[1][2],s=this._elements[2][0],c=this._elements[2][1],l=this._elements[2][2];return this._elements=[[a*l-o*c,i*c-n*l,n*o-i*a],[o*s-r*l,e*l-i*s,i*r-e*o],[r*c-a*s,s*n-e*c,e*a-n*r]],this.multiply(1/t),this}},{key:"transpose",value:function(){var t=Object.create(this._elements);return this._elements=[[t[0][0],t[1][0],t[2][0]],[t[0][1],t[1][1],t[2][1]],[t[0][2],t[1][2],t[2][2]]],this}},{key:"identity",value:function(){return this._elements=[[1,0,0],[0,1,0],[0,0,1]],this}},{key:"toString",value:function(){return"".concat(this._elements.map(function(t){return t.join("\t")}).join("\n"))}},{key:"isIdentity",value:function(){var t=this._elements;return 1===t[0][0]&&0===t[0][1]&&0===t[0][2]&&0===t[1][0]&&1===t[1][1]&&0===t[1][2]&&0===t[2][0]&&0===t[2][1]&&1===t[2][2]}},{key:"transformPoint",value:function(t){var e,n,i=[t.x,t.y,1],r=this._elements,a=[0,0,0];for(e=0;e<this._elements.length;e++)for(n=0;n<this._elements[e].length;n++)a[e]+=i[n]*r[e][n];return{x:a[0],y:a[1]}}},{key:"transformPoints",value:function(t){var e,n,i,r,a,o=this._elements,s=[];for(r=0;r<t.length;r++){for(e=[t[r].x,t[r].y,1],a=[0,0,0],n=0;n<this._elements.length;n++)for(i=0;i<this._elements[n].length;i++)a[n]+=e[i]*o[n][i];s.push({x:a[0],y:a[1]})}return s}},{key:"elements",get:function(){var t=this._elements;return[[t[0][0],t[0][1],t[0][2]],[t[1][0],t[1][1],t[1][2]],[t[2][0],t[2][1],t[2][2]]]}}]),a}(),Kl=/(translate|scale|rotate|matrix)\(([0-9,.eE+-\s]+)(?:,|\s?)+\)/g;function tu(t,e){var n=e.args[0]*(Math.PI/180);if(2<e.args.length){var i=e.args[1],r=e.args[2];t.translate(i,r),t.rotate(n),t.translate(-i,-r)}else 1===e.args.length&&t.rotate(n)}function eu(t,e){for(var n,i,r,a,o,s,c,l,u,h,f,d=function(t){for(var e,n=[];null!==(e=Kl.exec(t));){var i=e[2].trim(),r=-1===i.indexOf(",")?i.split(" "):i.split(",");n.push({cmd:e[1],args:r.filter(function(t){return 0<t.trim().length}).map(function(t){return Number(t)})})}return n}(t),g=0,p=d.length;g<p;g++)"rotate"===(n=d[g]).cmd?tu(e,n):"scale"===n.cmd?(l=e,void 0,h=(u=n).args[0],f=isNaN(u.args[1])?u.args[0]:u.args[1],l.scale(h,f)):"matrix"===n.cmd?(s=e,6<=(c=n).args.length&&s.transform.apply(s,K(c.args))):"translate"===n.cmd&&(i=e,void 0,a=(r=n).args[0],o=isNaN(r.args[1])?0:r.args[1],i.translate(a,o))}var nu={type:/^\w[\w-]+/,attr:/^\[\w(?:[\w\._-]+)?(?:[!]?=['\"][\w\s*#_-]*['\"])?\]/,universal:/^(\*)/,tag:/^\.(\w+)/},iu={type:function(n,t){return t.filter(function(t){var e=t.type;return!!e&&e.toLowerCase()===n.toLowerCase()})},attr:function(n,i,r,t){return t.filter(function(t){var e=t.attrs[n];if(!i)return void 0!==e;if(void 0===e)return!1;switch(i){case"=":return r===String(e);case"!=":return r!==String(e);default:return!1}})},universal:function(t){return t},tag:function(n,t){return t.filter(function(t){var e=t.tag;return!!e&&-1!==e.trim().split(/\s+/).indexOf(n.replace(".",""))})}};var ru={find:function(t,e){var o,s,n,i,r,a,c,l=[],u=[];if(e.isBranch){var h;c=[],t.split(/\s*,\s*/).forEach(function(e){e=e.trim(),n=[];for(var t=function(t){(r=e.match(nu[t]))&&(a=!0,e=e.slice(r[0].length),i={type:t,value:r[0]},"attr"===t&&(r=r[0].match(/\[(\w[\w\._-]+)?(?:([!]?=)['\"]([\w\s#_-]*)['\"])?\]/),i.attribute=r[1],i.operator=r[2],i.attributeValue=r[3]),n.push(i))};e&&(a=!1,(r=e.match(/^\s*([>+~]|\s)\s*/))&&(a=!0,n.push({type:" ",value:r[0]}),e=e.slice(r[0].length)),Object.keys(nu).forEach(t),n&&n.length&&c.indexOf(n)<0&&c.push(n),a););}),o=c,s=e.descendants;for(var f=function(t,e){h=o[t];var r=[],n=s.slice(),i=!1;h.reverse().forEach(function(t){if(" "===t.type)return r.push(n),n=s.slice(),void(i=!1);n=function(t,e){if(!e||!e.length||!t||"function"!=typeof iu[t.type])return[];switch(t.type){case"type":return iu[t.type](t.value,e);case"attr":return iu[t.type](t.attribute,t.operator,t.attributeValue,e);case"universal":return iu[t.type](e);case"tag":return iu[t.type](t.value,e);default:return[]}}(t,n),i=!0}),i&&r.push(n);var a=r[0].filter(function(t){for(var e,n=t.parent,i=1;i<r.length;i++){for(e=r[i].indexOf(n);n&&e<0;)n=n.parent,e=r[i].indexOf(n);if(e<0)return!1}return!0});u.push(a)},d=0,g=o.length;d<g;d++)f(d);for(var p=0,y=u.length;p<y;p++)for(var v=0,m=u[p].length;v<m;v++)l.indexOf(u[p][v])<0&&l.push(u[p][v])}return l||[]}};function au(t,e,n){var i=t.type,r=n?n.transformPoints(t.points()):t.points();!function(t,e){for(var n=0,i=t.length;n<i;n++)t[n].x/=e,t[n].y/=e}(r,e);var a,o,s=null;if("rect"===i||"bounds"===i)(s=L(r)).type=i;else if("circle"===i)a=r,o=t.r,(s={cx:a[0].x,cy:a[0].y,r:o}).type=i;else if("line"===i)(s=B(r)).type=i;else if("polygon"===i||"polyline"===i){s={type:"path",d:ns(r,"polygon"===i)}}return s}var ou=function(){function n(e){var t=this;v(this,n),this._bounds=e.boundingRect?function(){var t=!(0<arguments.length&&void 0!==arguments[0])||arguments[0];return e.boundingRect(t)}:function(){return{x:0,y:0,width:0,height:0}},this._attrs=e.attrs,this._type=e.type,this._data=e.data,this._dpi=e.stage?e.stage.dpi:1,this._collider=function(){return function(t,e){if(t.collider){var n=t.modelViewMatrix;return"collection"===t.colliderType?{type:"container",children:t.collider.geometries.map(function(t){return au(t,e,n)})}:au(t.collider,e,n)}return null}(e,t._dpi)},this._desc=e.desc,this._tag=e.tag}return x(n,[{key:"type",get:function(){return this._type}},{key:"data",get:function(){return this._data}},{key:"attrs",get:function(){return this._attrs}},{key:"element",set:function(t){this._element=t},get:function(){return this._element}},{key:"key",set:function(t){this._key=t},get:function(){return this._key}},{key:"bounds",get:function(){var t=this._bounds();return t.x/=this._dpi,t.y/=this._dpi,t.width/=this._dpi,t.height/=this._dpi,t}},{key:"localBounds",get:function(){return this._bounds(!1)}},{key:"collider",get:function(){return this._collider()}},{key:"desc",get:function(){return this._desc}},{key:"tag",get:function(){return this._tag}}]),n}();function su(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(ou,e)}var cu=function(){function e(t){v(this,e),this._node=su(t),this._parent=null,this._input=null}return x(e,[{key:"node",get:function(){return this._node}},{key:"parent",set:function(t){this._parent=t},get:function(){return this._parent}},{key:"input",set:function(t){this._input=t},get:function(){return this._input}}]),e}();function lu(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(cu,e)}function uu(t,e){var n=t.parent;if(n&&"stage"!==n.type){e.parent=lu(n);var i=n.parent;i&&"stage"!==i.type&&uu(i,e.parent)}}function hu(t,e,n){if(null===t.colliderType)return null;var i=function(t,e){var n={};if(t.modelViewMatrix)if(Array.isArray(e))n=t.inverseModelViewMatrix.transformPoints(e);else if(isNaN(e.r))Array.isArray(e.vertices)?n.vertices=t.inverseModelViewMatrix.transformPoints(e.vertices):n=t.inverseModelViewMatrix.transformPoint(e);else{var i={x:e.cx,y:e.cy},r=t.inverseModelViewMatrix.transformPoint(i);n.cx=r.x,n.cy=r.y,n.r=e.r}else n=e;return Array.isArray(n.vertices)&&(n=Yl(n)),n}(t,n);return"frontChild"===t.colliderType?function(t,e,n){for(var i=t.descendants.length-1;0<=i;i--){var r=t.descendants[i];if(null!==r.collider&&r.collider[e](n)){var a=lu(r);return uu(r,a),a}}return null}(t,e,i):function(t,e,n){if(t.collider[e](n)){var i=lu(t);return uu(t,i),i}return null}(t,e,i)}function fu(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:1,n={};switch(W(t)){case"circle":return n.cx=t.cx*e,n.cy=t.cy*e,n.r=t.r,["intersectsCircle",n];case"rect":return["intersectsRect",n=D(t).map(function(t){return Qa(t,e)})];case"line":return["intersectsLine",n=F(t).map(function(t){return Qa(t,e)})];case"point":return["containsPoint",n=Qa(t,e)];case"polygon":return n.vertices=t.vertices.map(function(t){return Qa(t,e)}),["intersectsPolygon",n];default:return[]}}function du(t,e){var n=C(fu(e,t.dpi),2),i=n[0],r=n[1],a=[];return i&&(function t(e,n,i,r){for(var a=e.length,o=0;o<a;o++){var s=e[o],c=hu(s,n,r);c&&i.push(c),!s.children||c||s.collider||t(s.children,n,i,r)}}([t],i,a,r),function(t,e){for(var n=0,i=e.length;n<i;n++)e[n].input=t}(e,a)),a}function gu(t,e){var n=C(fu(e,t.dpi),2);return function t(e,n,i){for(var r=e.length,a=0;a<r;a++){var o=e[a];if(null!==hu(o,n,i))return!0;if(o.children&&!o.collider)return t(o.children,n,i)}return!1}([t],n[0],n[1])}var pu=function(t){function s(t){var e;return v(this,s),(e=S(this,w(s).call(this,t)))._stage=null,e._collider={type:null,definition:null,fn:null},e._attrs={},e._node=null,e}return b(s,$l),x(s,[{key:"set",value:function(){var i,r,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=(this.node=t).data,n=t.desc,a=t.tag;i=this.attrs,r=t,Object.keys(es).forEach(function(t){var e=r[t];if(void 0!==e){var n=es[t];i[n]=e}}),void 0!==e&&(this.data=e),"object"===Q(n)&&(this.desc=G(!0,{},n)),"string"==typeof a&&(this.tag=a)}},{key:"findShapes",value:function(t){return ru.find(t,this).map(function(t){return su(t)})}},{key:"getItemsFrom",value:function(t){return du(this,t)}},{key:"containsPoint",value:function(t){return gu(this,t)}},{key:"intersectsLine",value:function(t){return gu(this,t)}},{key:"intersectsRect",value:function(t){return gu(this,t)}},{key:"intersectsCircle",value:function(t){return gu(this,t)}},{key:"intersectsPolygon",value:function(t){return gu(this,t)}},{key:"resolveLocalTransform",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Ql;void 0!==this.attrs.transform&&eu(this.attrs.transform,t),this.modelViewMatrix=t.clone()}},{key:"resolveGlobalTransform",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new Ql,e=this.ancestors;if(0<e.length)for(var n=e.length-1;0<=n;n--)e[n].resolveLocalTransform(t),t=e[n].modelViewMatrix;this.resolveLocalTransform(t)}},{key:"attr",value:function(t){return this.attrs[t]}},{key:"equals",value:function(t){var e=this.attrs,n=Object.keys(e),i=t.attrs,r=Object.keys(i);if(n.length!==r.length)return!1;for(var a=0;a<n.length;a++){var o=n[a];if(!Object.hasOwnProperty.call(i,o))return!1;if(e[o]!==i[o])return!1}return N(w(s.prototype),"equals",this).call(this,t)}},{key:"toJSON",value:function(){var t=N(w(s.prototype),"toJSON",this).call(this);return t.attrs=this.attrs,t}},{key:"attrs",get:function(){return this._attrs}},{key:"stage",get:function(){return this._parent&&!this._stage?this._stage=this._parent.stage:this._parent||this._stage===this||(this._stage=null),this._stage}},{key:"modelViewMatrix",set:function(t){this._mvm=t,this._imvm=null},get:function(){return this._mvm}},{key:"inverseModelViewMatrix",get:function(){return this._imvm=this._imvm?this._imvm:this._mvm.clone().invert(),this._imvm}},{key:"node",set:function(t){this._node=t},get:function(){return this._node}},{key:"collider",set:function(t){var e=Array.isArray(t)?"collection":t&&t.type;return"string"!=typeof e?(this._collider.type=null,this._collider.definition=null,void(this._collider.fn=null)):(null!==this._collider&&this._collider.type===e&&null!==this._collider.fn?this._collider.fn.set(t):this._collider.type=e,void(this._collider.definition=t))},get:function(){if(null!==this._collider.fn)return this._collider.fn;switch(this._collider.type){case"collection":this._collider.fn=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Gl,e)}(this._collider.definition);break;case"frontChild":return!0;case"bounds":this._collider.fn=Jl("rect",this.boundingRect());break;case"line":case"rect":case"circle":case"polygon":case"polyline":this._collider.fn=Jl(this._collider.type,this._collider.definition);break;default:return null}return this._collider.fn}},{key:"colliderType",get:function(){return this._collider.type}}]),s}(),yu=function(t){function e(){return v(this,e),S(this,w(e).apply(this,arguments))}return b(e,$l),x(e,[{key:"addChild",value:function(t){if(!(t&&t instanceof $l))throw new TypeError("Expecting a Node as argument, but got ".concat(t));if(t===this)throw new Error("Can not add itself as child!");if(t._children&&t._children.length&&0<=this.ancestors.indexOf(t))throw new Error("Can not add an ancestor as child!");t._parent&&t._parent!==this&&t._parent.removeChild(t);var e=this._children.indexOf(t);return 0<=e&&this._children.splice(e,1),this._children.push(t),t._parent=this,t._ancestors=null,this}},{key:"addChildren",value:function(t){var e,n=t?t.length:0;for(e=0;e<n;e++)this.addChild(t[e]);return this}},{key:"removeChild",value:function(t){var e=this._children.indexOf(t);return 0<=e&&(this._children.splice(e,1),t._parent=null,t._ancestors=null),this}},{key:"removeChildren",value:function(t){var e,n;if(!this._children)return this;if(t)for(n=t.length,e=0;e<n;e++)this.removeChild(t[e]);else for(;this._children.length;)this.removeChild(this._children[0]);return this}}]),e}(),vu=yu.prototype;function mu(t,e){var n=2<arguments.length&&void 0!==arguments[2]&&arguments[2];if(void 0!==e.bounds){var i=C(e.bounds(n),3),r=i[0],a=i[2],o=r.x,s=r.y,c=a.x,l=a.y,u=isNaN(t._boundingRect.width)?c:Math.max(c,t._boundingRect.width+t._boundingRect.x),h=isNaN(t._boundingRect.height)?l:Math.max(l,t._boundingRect.height+t._boundingRect.y);t._boundingRect.x=isNaN(t._boundingRect.x)?o:Math.min(o,t._boundingRect.x),t._boundingRect.y=isNaN(t._boundingRect.y)?s:Math.min(s,t._boundingRect.y),t._boundingRect.width=u-t._boundingRect.x,t._boundingRect.height=h-t._boundingRect.y}}var xu=function(t){function r(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};v(this,r);var n=e.type,i=void 0===n?"container":n;return(t=S(this,w(r).call(this,i))).set(e),t._boundingRect={},t}return b(r,pu),x(r,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};N(w(r.prototype),"set",this).call(this,t);var e=t.collider,n=G({type:null},e);this.collider=n}},{key:"boundingRect",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.children.length;this._boundingRect={};for(var n=0;n<e;n++)mu(this,this.children[n],t);return G({x:0,y:0,width:0,height:0},this._boundingRect)}},{key:"bounds",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}},{key:"addChild",value:function(t){var e=vu.addChild.call(this,t);if(this._collider&&"bounds"===this._collider.type){mu(this,t,!0);var n=G({type:"bounds",x:0,y:0,width:0,height:0},this._boundingRect);this.collider=n}return e}},{key:"addChildren",value:function(t){var e=vu.addChildren.call(this,t),n=t.length;if(this._collider&&"bounds"===this._collider.type&&0<n){for(var i=0;i<n;i++)mu(this,t[i],!0);var r=G({type:"bounds",x:0,y:0,width:0,height:0},this._boundingRect);this.collider=r}return e}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,i=n?n.length:0;for(e=0;e<i;e++)n[e]._stage=null;if(vu.removeChild.call(this,t),this._collider&&"bounds"===this._collider.type){var r=G(this.boundingRect(!0),{type:"bounds"});this.collider=r}return this}},{key:"removeChildren",value:function(t){if(vu.removeChildren.call(this,t),this._collider&&"bounds"===this._collider.type){var e=G(this.boundingRect(!0),{type:"bounds"});this.collider=e}return this}}]),r}();var bu=function(t){function n(t){var e;return v(this,n),(e=S(this,w(n).call(this,"stage")))._stage=_(_(e)),e._dpiRatio=t||1,e}return b(n,xu),x(n,[{key:"dpi",get:function(){return this._dpiRatio}}]),n}();var wu=yu.prototype,ku=["x1","x2","y1","y2","id","offset","style"],Mu=function(t){function a(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};v(this,a);var n=e.type,i=void 0===n?"container":n;return(t=S(this,w(a).call(this,i))).set(e),t._boundingRect={},t}return b(a,pu),x(a,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};N(w(a.prototype),"set",this).call(this,t);for(var e=this.attrs,n="",i=0,r=ku.length;i!==r;i++)t[n=ku[i]]&&(e[n]=t[n])}},{key:"addChild",value:function(t){return wu.addChild.call(this,t)}},{key:"addChildren",value:function(t){return wu.addChildren.call(this,t)}},{key:"removeChild",value:function(t){t._stage=null;var e,n=t.descendants,i=n?n.length:0;for(e=0;e<i;e++)n[e]._stage=null;return wu.removeChild.call(this,t),this}},{key:"removeChildren",value:function(t){return wu.removeChildren.call(this,t),this}}]),a}();function _u(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Mu,e)}var Su=function(t){function h(){var t,e;return v(this,h),(t=e=S(this,w(h).call(this,"rect"))).set.apply(t,arguments),e}return b(h,pu),x(h,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=void 0===e?0:e,i=t.y,r=void 0===i?0:i,a=t.width,o=void 0===a?0:a,s=t.height,c=void 0===s?0:s,l=t.collider,u=G({type:"rect",x:n,y:r,width:o,height:c},l);N(w(h.prototype),"set",this).call(this,t),this.attrs.width=0<=o?(this.attrs.x=n,o):(this.attrs.x=n+o,-o),this.attrs.height=0<=c?(this.attrs.y=r,c):(this.attrs.y=r+c,-c),this.collider=u}},{key:"boundingRect",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=D(this.attrs),n=C(P(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e),4),i=n[0],r=n[1];return{x:i,y:r,width:n[2]-i,height:n[3]-r}}},{key:"bounds",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),h}();var Ru=function(t){function l(){var t,e;return v(this,l),(t=e=S(this,w(l).call(this,"circle"))).set.apply(t,arguments),e}return b(l,pu),x(l,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.cx,n=void 0===e?0:e,i=t.cy,r=void 0===i?0:i,a=t.r,o=void 0===a?0:a,s=t.collider,c=G({type:"circle",cx:n,cy:r,r:o},s);N(w(l.prototype),"set",this).call(this,t),this.attrs.cx=n,this.attrs.cy=r,this.attrs.r=o,this.collider=c}},{key:"boundingRect",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.bounds(t);return{x:e[0].x,y:e[0].y,width:e[2].x-e[0].x,height:e[2].y-e[0].y}}},{key:"bounds",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.attrs,n=e.cx,i=e.cy,r=e.r,a=e.r,o=n-r,s=i-a,c=2*r,l=2*a,u=[{x:o,y:s},{x:o+c,y:s},{x:o+c,y:s+l},{x:o,y:s+l}];if(t&&this.modelViewMatrix){var h=C(P(u=this.modelViewMatrix.transformPoints(u)),4),f=h[0],d=h[1];return[{x:f,y:d},{x:f+(c=h[2]-f),y:d},{x:f+c,y:d+(l=h[3]-d)},{x:f,y:d+l}]}return u}}]),l}();var zu=function(t){function h(){var t,e;return v(this,h),(t=e=S(this,w(h).call(this,"line"))).set.apply(t,arguments),e}return b(h,pu),x(h,[{key:"set",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x1,n=void 0===e?0:e,i=t.y1,r=void 0===i?0:i,a=t.x2,o=void 0===a?0:a,s=t.y2,c=void 0===s?0:s,l=t.collider;N(w(h.prototype),"set",this).call(this,t);var u={type:"line",x1:this.attrs.x1=n,y1:this.attrs.y1=r,x2:this.attrs.x2=o,y2:this.attrs.y2=c};this.collider=G(u,l)}},{key:"boundingRect",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=F(this.attrs);t&&this.modelViewMatrix&&(e=this.modelViewMatrix.transformPoints(e));var n=C(P(e),4),i=n[0],r=n[1],a=n[2],o=n[3],s=i!==a||r!==o;return{x:i,y:r,width:s?Math.max(1,a-i):0,height:s?Math.max(1,o-r):0}}},{key:"bounds",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),h}();var Nu=Math.PI/2;function Cu(t,e){var n=Math.atan2(e.y-t.y,e.x-t.x);return n<0?n+2*Math.PI:n}function Au(t,e,n){return{x:t.x+Math.cos(e)*n,y:t.y+Math.sin(e)*n}}var Tu=function(t){function r(){var t,e;return v(this,r),(t=e=S(this,w(r).call(this,"path"))).set.apply(t,arguments),e}return b(r,pu),x(r,[{key:"set",value:function(){var n=this,i=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};N(w(r.prototype),"set",this).call(this,i),this.segments=[],this.points=[],this.attrs.d=i.d,Array.isArray(i.collider)||"object"===Q(i.collider)&&void 0!==i.collider.type?this.collider=i.collider:i.d&&(this.segments=Bl(i.d),this.segments.forEach(function(t){if(t.length<=1);else if(function(t){if(t.length<2)return!1;var e=t[0],n=t[t.length-1];return Math.abs(e.x-n.x)<1e-12&&Math.abs(e.y-n.y)<1e-12}(t))n.collider=G({type:"polygon",vertices:t},i.collider);else if("object"===Q(i.collider)&&i.collider.visual){var e=n.attrs["stroke-width"]/2;n.collider=function(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{},i=[],r=[];if("h"===n.forceOrientation){var a=t[0].x<t[1].x?-1:1,o=t[t.length-1].x>t[t.length-2].x?1:-1;t.unshift({x:t[0].x+a,y:t[0].y}),t.push({x:t[t.length-1].x+o,y:t[t.length-1].y})}else if("v"===n.forceOrientation){var s=t[0].y<t[1].y?-1:1,c=t[t.length-1].y>t[t.length-2].y?1:-1;t.unshift({x:t[0].x,y:t[0].y+s}),t.push({x:t[t.length-1].x,y:t[t.length-1].y+c})}for(var l=t.length-1,u=1;u<l;u++){var h=t[u-1],f=t[u],d=t[u+1],g=Cu(f,h),p=Cu(f,d),y=(g+p)/2,v=y+Math.PI,m=Math.max(y,v),x=Math.min(y,v),b=p<g;if(1===u){var w=Cu(h,f);i.push(Au(h,w-Nu,e)),r.unshift(Au(h,w+Nu,e))}var k=b?m:x,M=b?x:m;if(i.push(Au(f,k,e)),r.unshift(Au(f,M,e)),u===l-1){var _=Cu(d,f);i.push(Au(d,_+Nu,e)),r.unshift(Au(d,_-Nu,e))}}return{type:"polygon",vertices:i.concat(r)}}(t,e,i.collider)}else n.collider=G({type:"polyline",points:t},i.collider)}))}},{key:"boundingRect",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];this.points.length||(this.segments=this.segments.length?this.segments:Bl(this.attrs.d),this.points=function(t){for(var e,n=[],i=t.length,r=0;r<i;r++){e=t[r];for(var a=0;a<e.length;a++)n.push(e[a])}return n}(this.segments));var e=C(P(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(this.points):this.points),4),n=e[0],i=e[1];return{x:n||0,y:i||0,width:e[2]-n||0,height:e[3]-i||0}}},{key:"bounds",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),r}();var Eu=function(t){function m(){var t,e;return v(this,m),(t=e=S(this,w(m).call(this,"text"))).set.apply(t,arguments),e}return b(m,pu),x(m,[{key:"set",value:function(){var t,e,n,i,r=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=r.x,o=void 0===a?0:a,s=r.y,c=void 0===s?0:s,l=r.dx,u=void 0===l?0:l,h=r.dy,f=void 0===h?0:h,d=r.textBoundsFn,g=r.text,p=r.title,y=r.collider,v=r.boundingRect;N(w(m.prototype),"set",this).call(this,r),this.attrs.x=o,this.attrs.y=c,this.attrs.dx=u,this.attrs.dy=f,this.attrs.text=g,this.attrs.title=p,this._boundingRect=null,v?this._boundingRect=v:"function"==typeof d&&(this._textBoundsFn=d),this.collider=G({type:(t=this,e=t.data,n=t._boundingRect,i=t._textBoundsFn,null!=e&&(n||i)?"bounds":null)},y)}},{key:"boundingRect",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0];if(!this._boundingRect&&!this._textBoundsFn)return{x:0,y:0,width:0,height:0};!this._boundingRect&&this._textBoundsFn&&(this._boundingRect=this._textBoundsFn(this.attrs));var e=D(this._boundingRect),n=C(P(t&&this.modelViewMatrix?this.modelViewMatrix.transformPoints(e):e),4),i=n[0],r=n[1];return{x:i,y:r,width:n[2]-i,height:n[3]-r}}},{key:"bounds",value:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=this.boundingRect(t);return[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y},{x:e.x+e.width,y:e.y+e.height},{x:e.x,y:e.y+e.height}]}}]),m}();var Ou=Kt();function ju(t,e){return Ou.get(t)(e)}Ou.add("rect",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Su,e)}),Ou.add("circle",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Ru,e)}),Ou.add("text",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Eu,e)}),Ou.add("line",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(zu,e)}),Ou.add("path",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(Tu,e)}),Ou.add("stage",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(bu,e)}),Ou.add("container",function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return M(xu,e)}),Ou.add("defs",_u),Ou.add("linearGradient",_u),Ou.add("radialGradient",_u),Ou.add("stop",_u);var Pu=function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],o=[{}];function s(){return o[o.length-1]}return s.save=function(){for(var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=s(),n={},i="",r=0;r<a.length;r++)void 0!==e[i=a[r]]&&(n[i]=e[i]);return G(n,t),o.push(n),s()},s.restore=function(){o.splice(o.length-1,1)},s}(["stroke","fill","strokeWidth","opacity","fontFamily","fontSize","baseline"]);function Fu(t,e){if(Array.isArray(e))for(var n=0,i=e.length;n<i;n++)e[n](t)}function Du(t){var e=t.items,n=t.stage,i=t.dpi,r=t.on,a=void 0===r?{}:r;return n||(n=ju("stage",i)),function t(e,n,i,r){for(var a,o,s,c={siblings:e,node:null,index:0},l=0,u=e.length;l<u;l++)if(o=l,s=e,(a=c).node=s[o],a.index=o,Fu(c,r.create),!("function"==typeof c.node.disabled?c.node.disabled():c.node.disabled)){c.node=Pu.save(c.node);var h=ju(c.node.type,c.node);h&&(c.node.transform&&(i.save(),eu(c.node.transform,i)),i.isIdentity()||(h.modelViewMatrix=i.clone()),n.addChild(h),c.node.children&&t(c.node.children,h,i,r),c.node.transform&&i.restore()),Pu.restore()}}(e,n,new Ql,a),n}var Lu=/\n+|\r+|\r\n/,Bu=/\s/,Wu=/[a-zA-Z\u00C0-\u00F6\u00F8-\u00FF\u00AD]/,Iu=0,$u=1,Vu=2;function qu(t){return"string"==typeof t?-1!==t.search(Lu):-1!==String(t).search(Lu)}function Uu(t){return-1!==t.search(Bu)}function Hu(t){return-1!==t.search(Wu)}function Yu(t,e,n){return Math.max(e,Math.min(n,t))}function Xu(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.string,i=e.separator,r=void 0===i?"":i,a=e.reverse,o=void 0!==a&&a,s=e.measureText,l=void 0===s?function(t){return{width:t.length,height:1}}:s,c=e.mandatoryBreakIdentifiers,u=void 0===c?[qu]:c,h=e.noBreakAllowedIdentifiers,f=void 0===h?[]:h,d=e.suppressIdentifier,g=void 0===d?[Uu,qu,function(t){return""===t}]:d,p=e.hyphenationIdentifiers,y=void 0===p?[Hu]:p,v=String(n).split(r);""===(t=v)[0]&&t.shift(),""===t[t.length-1]&&t.pop();var m=v.length,x=o?function(t){return 0<=t}:function(t){return t<m},b=o?m:-1;function w(t){var e,n,i,r,a=Yu(t,0,m-1),o=v[a],s=l(o),c=(e=o,n=a,i=v,r=f,u.some(function(t){return t(e,n,i)})?$u:r.some(function(t){return t(e,n,i)})?Iu:Vu);return{index:a,value:o,breakOpportunity:c,suppress:g.some(function(t){return t(o,a,v)}),hyphenation:y.some(function(t){return t(o,a,v)}),width:s.width,height:s.height,done:!1}}return{next:function(t){return isNaN(t)?o?b--:b++:b=Yu(t,0,m-1),x(b)?w(b):{done:!0}},peek:w,length:m}}var Zu=1.2,Ju="‐",Gu="…";function Qu(t,e){return{lines:[],line:"",width:0,maxLines:function(t,e){var n=t.maxHeight,i=Math.max(t.maxLines,1)||1/0;if(isNaN(n))return i;var r=e*(t.lineHeight||Zu);return Math.max(1,Math.min(Math.floor(n/r),i))}(t,e(t.text).height),maxWidth:t.maxWidth,hyphens:{enabled:"auto"===t.hyphens,char:Ju,metrics:e(Ju)}}}function Ku(t){t.lines.push(t.line),t.line="",t.width=0}function th(t,e){t.line+=e.value,t.width+=e.width}function eh(t,e,n){if(e.width>t.maxWidth)return e;for(var i=e.index,r=1;r<5;r++){var a=n.peek(e.index-1);if(!e.hyphenation||!a.hyphenation||0===e.index)return e;if(t.width+t.hyphens.metrics.width<=t.maxWidth)return t.line+=t.hyphens.char,e;if(1===t.line.length)return e;e=n.next(i-r),t.line=t.line.slice(0,-1),t.width-=e.width}return e}function nh(t,e,n){for(var i=Xu({string:e.value,measureText:n});t.lines.length<t.maxLines;){var r=i.next();if(r.done)break;t.width+r.width>t.maxWidth&&r.breakOpportunity===Vu&&0<t.line.length&&(r=t.hyphens.enabled?eh(t,r,i):r,Ku(t)),th(t,r)}}function ih(t,e){for(var n=Xu({string:t.text,separator:"",measureText:e,noBreakAllowedIdentifiers:[function(t,e){return 0===e}]}),i=Qu(t,e),r=!0;i.lines.length<i.maxLines;){var a=n.next();if(a.done){Ku(i),r=!1;break}a.breakOpportunity===$u?Ku(i):i.width+a.width>i.maxWidth&&a.breakOpportunity===Vu?a.suppress?i.width+=a.width:(a=i.hyphens.enabled?eh(i,a,n):a,Ku(i),th(i,a)):th(i,a)}return{lines:i.lines,reduced:r}}function rh(t,e){for(var n=Xu({string:t.text,separator:/(\s|-|\u2010)/,measureText:e}),i=Qu(t,e),r=!0;i.lines.length<i.maxLines;){var a=n.next();if(a.done){Ku(i),r=!1;break}a.breakOpportunity===$u?Ku(i):i.width+a.width>i.maxWidth&&a.breakOpportunity===Vu?a.suppress?Ku(i):a.width>i.maxWidth?nh(i,a,e):(Ku(i),th(i,a)):th(i,a)}return{lines:i.lines,reduced:r}}function ah(t){return{"break-all":ih,"break-word":rh}[t.wordBreak]}function oh(l){return function(t){var e,n,i,r=t.node;if("text"===(i=r).type&&!i._lineBreak){var a=ah(r);if(!a)return;var o=l(r);if(o.width<=r.maxWidth&&!qu(r.text))return;var s=o.height*(r.lineHeight||Zu),c=a(r,(e=r,n=l,function(t){return n({text:t,fontSize:e.fontSize,fontFamily:e.fontFamily})}));t.node=function(i,r,a){var o={type:"container",children:[]};void 0!==r.id&&(o.id=r.id);var s=0;return i.lines.forEach(function(t,e){var n=G({},r);n.text=t,n._lineBreak=!0,i.reduced&&e===i.lines.length-1?n.text+=Gu:delete n.maxWidth,n.dy=isNaN(n.dy)?s:n.dy+s,s+=a,o.children.push(n)}),o}(c,r,s)}}}function sh(t,e){var n=t.text,i=t["font-size"],r=t["font-family"],a=t.maxWidth;if(n="string"==typeof n?n:"".concat(n),void 0===a)return n;var o=e({text:n,fontSize:i,fontFamily:r}).width;if(o<=a)return n;for(var s=0,c=n.length-1;s<=c;){var l=Math.floor((s+c)/2);(o=e({text:n.substr(0,l)+Gu,fontSize:i,fontFamily:r}).width)<=a?s=l+1:c=l-1}return n.substr(0,c)+Gu}function ch(t){var e=t.baseline||t["dominant-baseline"],n=0,i=parseInt(t.fontSize||t["font-size"],10)||0;switch(e){case"hanging":n=.75*i;break;case"text-before-edge":n=.85*i;break;case"middle":n=.25*i;break;case"central":n=.35*i;break;case"mathemetical":n=i/2;break;case"text-after-edge":case"ideographic":n=.2*-i;break;default:n=0}return n}var lh,uh={},hh={};function fh(t){var e=t.text,n=t.fontSize,i=t.fontFamily,r=hh[e+n+i];if(void 0!==r)return r;var a=(lh=lh||document.createElement("canvas")).getContext("2d");a.font="".concat(n," ").concat(i);var o=a.measureText(e).width;return hh[e+n+i]=o}function dh(t){var e=t.text,n=t.fontSize,i=t.fontFamily;return{width:fh({text:e,fontSize:n,fontFamily:i}),height:function(t){var e=t.fontSize,n=t.fontFamily,i=uh[e+n];if(void 0!==i)return i;var r=1.2*fh({text:"M",fontSize:e,fontFamily:n});return uh[e+n]=r}({fontSize:n,fontFamily:i})}}function gh(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:dh,n=t["font-size"]||t.fontSize,i=t["font-family"]||t.fontFamily,r=e({text:t.text,fontFamily:i,fontSize:n}),a=Math.min(t.maxWidth||r.width,r.width),o=t.x||0,s=t.y||0,c=t.dx||0,l={x:0,y:s+((t.dy||0)+ch(t))-.75*r.height,width:a,height:r.height},u=t["text-anchor"]||t.anchor;return l.x="middle"===u?o+c-a/2:"end"===u?o+c-a:o+c,l}function ph(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:dh,n=ah(t);if(n){for(var i=t["font-size"]||t.fontSize,r=t["font-family"]||t.fontFamily,a=n(t,function(t){return e({text:t,fontFamily:r,fontSize:i})}),o=G({},t),s=0,c="",l=0,u=a.lines.length;l<u;l++){var h=a.lines[l];h+=l===u-1&&a.reduced?Gu:"";var f=e({text:h,fontSize:i,fontFamily:r}).width;s<=f&&(s=f,c=h)}o.text=c;var d=gh(o,e),g=t.lineHeight||Zu;return d.height=d.height*a.lines.length*g,d}return gh(t,e)}function yh(t,e,n){var i=n.orientation,r=n.degree,a=n.stops,o=void 0===a?[]:a,s=null;if("radial"===i){var c=e.width||0,l=e.height||0,u=void 0!==e.x?e.x:e.cx,h=void 0!==e.y?e.y:e.cy;s=t.createRadialGradient(u+c/2,h+l/2,1,u+c/2,h+l/2,e.r||Math.max(e.width,e.height)/2)}else{var f=as(r),d=e.width||2*e.r,g=e.height||2*e.r,p=void 0!==e.x?e.x:e.cx-e.r,y=void 0!==e.y?e.y:e.cy-e.r;s=t.createLinearGradient(p+f.x1*d,y+f.y1*g,p+f.x2*d,y+f.y2*g)}for(var v=0,m=o.length;v<m;v++){var x=o[v];s.addColorStop(x.offset,x.color)}return s}function vh(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.x,n=t.y,i=t.width,r=t.height,a=t.scaleRatio,o=t.margin,s={x:0,y:0,width:0,height:0,scaleRatio:{x:1,y:1},margin:{left:0,top:0}};return s.x=isNaN(e)?s.x:e,s.y=isNaN(n)?s.y:n,s.width=isNaN(i)?s.width:i,s.height=isNaN(r)?s.height:r,void 0!==a&&(s.scaleRatio.x=isNaN(a.x)?s.scaleRatio.x:a.x,s.scaleRatio.y=isNaN(a.y)?s.scaleRatio.y:a.y),void 0!==o&&(s.margin.left=isNaN(o.left)?0:o.left,s.margin.top=isNaN(o.top)?0:o.top),s}function mh(){return{element:function(){},root:function(){},appendTo:function(){},render:function(){return!1},itemsAt:function(){return[]},findShapes:function(){return[]},clear:function(){},destory:function(){},size:function(){},measureText:dh,textBounds:ph}}function xh(n){return function(t){var e=t.node;"text"!==e.type||null==e.data||e.textBoundsFn||(e.textBoundsFn=n.textBounds)}}var bh=Kt();function wh(t){return Array.isArray(t)?t:"string"==typeof t?-1!==t.indexOf(",")?t.split(","):t.split(" "):[]}function kh(t,e,n){for(var i=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},r=Object.keys(i),a=0,o=n.length;a<o;a++){var s=n[a],c=s[0],l=s[1],u=s[2];if(c in e.attrs&&!(l in i)&&t[l]!==e.attrs[c]){var h=u?u(e.attrs[c]):e.attrs[c];"function"==typeof t[l]?t[l](h):t[l]=h}}for(var f=0,d=r.length;f<d;f++){var g=r[f];t[g]=i[g]}}function Mh(){var u,h,f=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Du,d=!1,g=vh(),p=[["fill","fillStyle"],["stroke","strokeStyle"],["opacity","globalAlpha"],["globalAlpha","globalAlpha"],["stroke-width","lineWidth"],["stroke-linejoin","lineJoin"],["stroke-dasharray","setLineDash",wh]],y=mh();return y.element=function(){return u},y.root=function(){return u},y.appendTo=function(t){return u||((u=t.ownerDocument.createElement("canvas")).style.position="absolute",u.style["-webkit-font-smoothing"]="antialiased",u.style["-moz-osx-font-smoothing"]="antialiased",u.style.pointerEvents="none"),t.appendChild(u),u},y.render=function(t){if(!u)return!1;var e,n=u.getContext("2d"),i=(e=n,("undefined"==typeof window?1:window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1)),r=g.scaleRatio.x,a=g.scaleRatio.y;d&&(u.style.left="".concat(Math.round(g.margin.left+g.x*r),"px"),u.style.top="".concat(Math.round(g.margin.top+g.y*a),"px"),u.style.width="".concat(Math.round(g.width*r),"px"),u.style.height="".concat(Math.round(g.height*a),"px"),u.width=Math.round(g.width*i*r),u.height=Math.round(g.height*i*a));var o={type:"container",children:t};1===i&&1===r&&1===a||(o.transform="scale(".concat(i*r,", ").concat(i*a,")"));var s=f({items:[o],dpi:i,on:{create:[oh(y.measureText),xh(y)]}}),c=!h||!s.equals(h),l=d||c;return l&&(y.clear(),function t(e,n,i){for(var r=0,a=e.length;r<a;r++){var o=e[r],s={};n.save(),o.attrs&&(o.attrs.fill||o.attrs.stroke)&&(o.attrs.fill&&"object"===Q(o.attrs.fill)&&"gradient"===o.attrs.fill.type&&(s.fillStyle=yh(n,o.attrs,o.attrs.fill)),o.attrs.stroke&&"object"===Q(o.attrs.stroke)&&"gradient"===o.attrs.stroke.type&&(s.strokeStyle=yh(n,o.attrs,o.attrs.stroke))),kh(n,o,i,s),o.modelViewMatrix&&(c=o.modelViewMatrix.elements,n.setTransform(c[0][0],c[1][0],c[0][1],c[1][1],c[0][2],c[1][2])),bh.has(o.type)&&bh.get(o.type)(o.attrs,{g:n,doFill:"fill"in o.attrs&&"none"!==o.attrs.fill,doStroke:"stroke"in o.attrs&&0!==o.attrs["stroke-width"]}),o.children&&t(o.children,n,i),n.restore()}var c}(s.children,n,p)),d=!1,h=s,l},y.itemsAt=function(t){return h?h.getItemsFrom(t):[]},y.findShapes=function(t){return h?h.findShapes(t):[]},y.clear=function(){return u&&(u.width=u.width),h=null,y},y.size=function(t){if(t){var e=vh(t);JSON.stringify(g)!==JSON.stringify(e)&&(d=!0,g=e)}return g},y.destroy=function(){u&&(u.parentElement&&u.parentElement.removeChild(u),u=null),h=null},y}function _h(t,e){bh.add(t,e)}var Sh=new RegExp("[A-Za-zªµºÀ-ÖØ-öø-ʸʻ-ˁː-ˑˠ-ˤˮͰ-ͳͶ-ͽΆΈ-ϵϷ-҂Ҋ-։ः-हऻऽ-ीॉ-ौॎ-ॐक़-ॡ।-ॿং-হঽ-ীে-ৌৎ-ৡ০-ৱ৴-৺ਃ-ਹਾ-ੀਖ਼-੯ੲ-ੴઃ-હઽ-ીૉ-ૌૐ-ૡ૦-૯ଂ-ହଽ-ାୀେ-ୌୗ-ୡ୦-୷ஃ-ிு-ௌௐ-௲ఁ-ఽు-ౄౘ-ౡ౦-౯౿-ಹಽ-ೋೕ-ೡ೦-ീെ-ൌൎ-ൡ൦-ෆා-ෑෘ-ะา-ำเ-ๆ๏-ະາ-ຳຽ-ໆ໐-༗༚-༴༶༸༾-ཬཿ྅ྈ-ྌ྾-࿅࿇-ာေးျ-ြဿ-ၗၚ-ၝၡ-ၰၵ-ႁႃ-ႄႇ-ႌႎ-ႜ႞-ፚ፠-ᎏᎠ-Ᏼᐁ-ᙿᚁ-ᚚᚠ-ᜑᜠ-ᜱ᜵-ᝑᝠ-ᝰក-ាើ-ៅះ-ៈ។-៚ៜ០-៩᠐-ᢨᢪ-ᤜᤣ-ᤦᤩ-ᤱᤳ-ᤸ᥆-᧚ᨀ-ᨖᨙ-ᩕᩗᩡᩣ-ᩤᩭ-ᩲ᪀-᪭ᬄ-ᬳᬵᬻᬽ-ᭁᭃ-᭪᭴-᭼ᮂ-ᮡᮦ-ᮧ᮪-ᯥᯧᯪ-ᯬᯮ᯲-ᰫᰴ-ᰵ᰻-᱿᳓᳡ᳩ-ᳬᳮ-ᶿḀ-ᾼιῂ-ῌῐ-Ίῠ-Ῥῲ-ῼ‎ⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎ-⅏Ⅰ-ↈ⌶-⍺⎕⒜-ⓩ⚬⠀-⣿Ⰰ-ⳤⳫ-ⳮⴀ-⵰ⶀ-ⷞ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ㆺㇰ-㈜㈠-㉏㉠-㉻㉿-㊰㋀-㋋㋐-㍶㍻-㏝㏠-㏾㐀-䶵一-ꒌꓐ-ꘌꘐ-ꙮꚀ-ꛯ꛲-꛷Ꜣ-ꞇ꞉-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠤꠧ꠰-꠷ꡀ-ꡳꢀ-ꣃ꣎-꣙ꣲ-ꤥ꤮-ꥆꥒ-ꥼꦃ-ꦲꦴ-ꦵꦺ-ꦻꦽ-ꨨꨯ-ꨰꨳ-ꨴꩀ-ꩂꩄ-ꩋꩍ-ꪯꪱꪵ-ꪶꪹ-ꪽꫀꫂ-ꯤꯦ-ꯧꯩ-꯬꯰-ﬗＡ-Ｚａ-ｚｦ-ￜ]"),Rh=new RegExp("[־׀׃׆א-״߀-ߪߴ-ߵߺ-ࠕࠚࠤࠨ࠰-ࡘ࡞‏יִײַ-ﬨשׁ-ﭏ]"),zh=new RegExp("[؈؋؍؛-ي٭-ٯٱ-ەۥ-ۦۮ-ۯۺ-܍ܐܒ-ܯݍ-ޥޱﭐ-ﴽﵐ-﷼ﹰ-ﻼ]");function Nh(t){var e,n,i,r,a=t?t.length:0;for(e=0;e<a;e++){if(n=t[e],r=n,Sh.test(r))return"ltr";if(i=n,Rh.test(i)||zh.test(i))return"rtl"}return"ltr"}var Ch={start:"end",end:"start",center:"center",middle:"middle"};function Ah(t,e){return"rtl"===e?Ch[t]:t}function Th(t,e,n){for(var i=0,r=t.length;i<r;i++)t[i].object=n(t[i].content.type,e)}function Eh(t,e){for(var n=0,i=t.length;n<i;n++)null!==t[n].object&&void 0!==t[n].object&&(e(t[n].object),t[n].object=null)}function Oh(t,e,n,i,r,a){var o=function t(e,n){var i,r,a,o=[],s=[],c=[],l=[],u=function(t){return t.id},h=function(t,e){var n;return n="object"===Q(t)?"id"in t?t.id:e:t,{content:t,id:"".concat(n,"__").concat(t.type||"")}};e.isTree||(e=e.map(h)),n=n.map(h),r=e.map(u),a=n.map(u);for(var f=0,d=n.length;f<d;f++)-1===r.indexOf(n[f].id)?o.push(n[f]):c.push(n[f]);for(var g=0,p=e.length;g<p;g++)-1===a.indexOf(e[g].id)?s.push(e[g]):l.push(e[g]);for(var y=0,v=o.length;y<v;y++)o[y].content.children&&(o[y].diff=t([],o[y].content.children),o[y].children=o[y].diff.updatedNew.concat(o[y].diff.added),o[y].children.isTree=!0);for(var m=0,x=c.length;m<x;m++)c[m].diff=t(l[m].children||[],c[m].content.children||[]),c[m].object=l[m].object,c[m].children=c[m].diff.items;return i=c.concat(o),o.isTree=!0,s.isTree=!0,c.isTree=!0,l.isTree=!0,i.isTree=!0,{added:o,updatedNew:c,updatedOld:l,removed:s,items:i}}(t,e);return Th(o.added,n,i),Eh(o.removed,a),function t(e,n,i,r){for(var a,o=0,s=e.length;o<s;o++)null!==(a=e[o]).object&&void 0!==a.object&&(i(a.object,a.content),a.diff&&(Th(a.diff.added,a.object,n),Eh(a.diff.removed,r),t(a.diff.items,n,i,r)))}(o.items,i,r,a),o.items}_h("rect",function(t,e){var n=e.g,i=e.doFill,r=e.doStroke;n.beginPath(),n.rect(t.x,t.y,t.width,t.height),i&&n.fill(),r&&n.stroke()}),_h("circle",function(t,e){var n=e.g,i=e.doFill,r=e.doStroke;n.beginPath(),n.moveTo(t.cx+t.r,t.cy),n.arc(t.cx,t.cy,t.r,0,2*Math.PI,!1),i&&n.fill(),r&&n.stroke()}),_h("line",function(t,e){var n=e.g,i=e.doStroke;n.beginPath(),n.moveTo(t.x1,t.y1),n.lineTo(t.x2,t.y2),i&&n.stroke()}),_h("path",function(t,e){var n=e.g,i=e.doStroke,r=e.doFill,a=new Path2D(t.d);r&&n.fill(a),i&&n.stroke(a)}),_h("text",function(t,e){var n=e.g,i=sh(t,dh);n.font="".concat(t["font-size"]," ").concat(t["font-family"]),n.canvas.dir=Nh(t.text);var r="middle"===t["text-anchor"]?"center":t["text-anchor"];n.textAlign=Ah(r,n.canvas.dir);var a=ch(t);n.fillText(i,t.x+t.dx,t.y+t.dy+a)});var jh="http://www.w3.org/2000/svg",Ph=function(t,e){if(!t||"string"!=typeof t)throw new Error("Invalid type: ".concat(t));var n=e.ownerDocument.createElementNS(jh,"container"===t?"g":t);return e.appendChild(n),n},Fh=function(t){t.parentNode&&t.parentNode.removeChild(t)},Dh=function(t,e){for(var n in e.attrs)if("text"===n){t.setAttribute("style","white-space: pre"),t.textContent=sh(e.attrs,dh);var i=Nh(e.attrs.text);"rtl"===i&&(t.setAttribute("direction","rtl"),t.setAttribute("dir","rtl"),t.setAttribute("text-anchor",Ah(t.getAttribute("text-anchor"),i)))}else if("text"!==e.type||"dy"!==n&&"dominant-baseline"!==n)if("text"===e.type&&"title"===n&&e.attrs.title){var r=t.ownerDocument.createElementNS(jh,"title");r.textContent=e.attrs.title,t.appendChild(r)}else t.setAttribute(n,e.attrs[n]);else{var a=+t.getAttribute(n)||0,o=0;o="dominant-baseline"===n?ch(e.attrs):e.attrs[n],t.setAttribute("dy",o+a)}if("string"==typeof e.data||"number"==typeof e.data||"boolean"==typeof e.data)t.setAttribute("data",e.data);else if("object"===Q(e.data)&&null!==e.data)for(var s in e.data)"string"!=typeof e.data[s]&&"number"!=typeof e.data[s]&&"boolean"!=typeof e.data[s]||t.setAttribute("data-".concat(s),e.data[s])},Lh=function(){function r(t,e,n,i){v(this,r),this.create=t,this.nodeCreator=e,this.nodeMaintainer=n,this.nodeDestroyer=i}return x(r,[{key:"render",value:function(t,e){return this.create([],t,e,this.nodeCreator,this.nodeMaintainer,this.nodeDestroyer)}}]),r}();function Bh(){return new Lh(Oh,Ph,Dh,Fh)}var Wh=[],Ih={};function $h(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"fill",n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"",i=function(t){var e,n,i=0;if(0===(t=JSON.stringify(t)).length)return i;for(e=0,n=t.length;e<n;e++)i=(i<<5)-i+t.charCodeAt(e),i&=i;return i}(t[e]),r="";if(void 0!==Ih[i])r=Ih[i];else{var a=t[e],o=a.orientation,s=a.degree,c=a.stops,l=void 0===c?[]:c,u={};void 0===s&&(s=90),"radial"===o?u.type="radialGradient":(u=as(s)).type="linearGradient",u.id="picasso-gradient-".concat(i),u.children=l.map(function(t){var e=t.offset,n=t.color,i=t.opacity;return{type:"stop",offset:"".concat(100*e,"%"),style:"stop-color:".concat(n,";stop-opacity:").concat(i||1)}}),Wh.push(u),Ih[i]=u.id,r=u.id}return"url('".concat(n,"#").concat(r,"')")}function Vh(t){var e="";"undefined"!=typeof window&&(e=window.location.href.split("#")[0]);var n=t.node;n.fill&&"object"===Q(n.fill)&&"gradient"===n.fill.type&&(n.fill=$h(n,"fill",e)),n.stroke&&"object"===Q(n.stroke)&&"gradient"===n.stroke.type&&(n.stroke=$h(n,"stroke",e))}function qh(){var s,c,l,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:Bh,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:jh,u=2<arguments.length&&void 0!==arguments[2]?arguments[2]:Du,h=t(),f=!1,d=vh(),g=mh();return g.element=function(){return s},g.root=function(){return c},g.appendTo=function(t){return s||((s=t.ownerDocument.createElementNS(e,"svg")).style.position="absolute",s.style["-webkit-font-smoothing"]="antialiased",s.style["-moz-osx-font-smoothing"]="antialiased",s.style.pointerEvents="none",s.setAttribute("xmlns",e),(c=t.ownerDocument.createElementNS(e,"g")).style.pointerEvents="auto",s.appendChild(c)),t.appendChild(s),s},g.render=function(t){if(!s)return!1;var e=d.scaleRatio.x,n=d.scaleRatio.y;f&&(s.style.left="".concat(Math.round(d.margin.left+d.x*e),"px"),s.style.top="".concat(Math.round(d.margin.top+d.y*n),"px"),s.setAttribute("width",Math.round(d.width*e)),s.setAttribute("height",Math.round(d.height*n))),Wh=[],Ih={};var i={type:"container",children:Array.isArray(t)?K(t).concat([{type:"defs",children:Wh,disabled:function(){return 0===Wh.length}}]):t};1===e&&1===n||(i.transform="scale(".concat(e,", ").concat(n,")"));var r=u({items:[i],on:{create:[Vh,oh(g.measureText),xh(g)]}}),a=!l||!r.equals(l),o=f||a;return o&&(g.clear(),h.render(r.children,c)),f=!1,l=r,o},g.itemsAt=function(t){return l?l.getItemsFrom(t):[]},g.findShapes=function(t){return l?l.findShapes(t):[]},g.clear=function(){if(!c)return g;l=null;var t=c.cloneNode(!1);return s.replaceChild(t,c),c=t,g},g.destroy=function(){s&&s.parentNode&&s.parentNode.removeChild(s),c=s=null},g.size=function(t){if(t){var e=vh(t);JSON.stringify(d)!==JSON.stringify(e)&&(f=!0,d=e)}return d},g}var Uh=function(){},Hh={},Yh=[],Xh=[];function Zh(t,e){var n,i,r,a,o=Xh;for(a=arguments.length;2<a--;)Yh.push(arguments[a]);for(e&&null!=e.children&&(Yh.length||Yh.push(e.children),delete e.children);Yh.length;)if((i=Yh.pop())&&void 0!==i.pop)for(a=i.length;a--;)Yh.push(i[a]);else"boolean"==typeof i&&(i=null),(r="function"!=typeof t)&&(null==i?i="":"number"==typeof i?i=String(i):"string"!=typeof i&&(r=!1)),r&&n?o[o.length-1]+=i:o===Xh?o=[i]:o.push(i),n=r;var s=new Uh;return s.nodeName=t,s.children=o,s.attributes=null==e?void 0:e,s.key=null==e?void 0:e.key,s}function Jh(t,e){for(var n in e)t[n]=e[n];return t}var Gh="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout,Qh=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,Kh=[];function tf(t){!t._dirty&&(t._dirty=!0)&&1==Kh.push(t)&&Gh(ef)}function ef(){var t,e=Kh;for(Kh=[];t=e.pop();)t._dirty&&wf(t)}function nf(t,e){return t.normalizedNodeName===e||t.nodeName.toLowerCase()===e.toLowerCase()}function rf(t){var e=Jh({},t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(void 0!==n)for(var i in n)void 0===e[i]&&(e[i]=n[i]);return e}function af(t){var e=t.parentNode;e&&e.removeChild(t)}function of(t,e,n,i,r){if("className"===e&&(e="class"),"key"===e);else if("ref"===e)n&&n(null),i&&i(t);else if("class"!==e||r)if("style"===e){if(i&&"string"!=typeof i&&"string"!=typeof n||(t.style.cssText=i||""),i&&"object"==typeof i){if("string"!=typeof n)for(var a in n)a in i||(t.style[a]="");for(var a in i)t.style[a]="number"==typeof i[a]&&!1===Qh.test(a)?i[a]+"px":i[a]}}else if("dangerouslySetInnerHTML"===e)i&&(t.innerHTML=i.__html||"");else if("o"==e[0]&&"n"==e[1]){var o=e!==(e=e.replace(/Capture$/,""));e=e.toLowerCase().substring(2),i?n||t.addEventListener(e,sf,o):t.removeEventListener(e,sf,o),(t._listeners||(t._listeners={}))[e]=i}else if("list"!==e&&"type"!==e&&!r&&e in t){try{t[e]=null==i?"":i}catch(t){}null!=i&&!1!==i||"spellcheck"==e||t.removeAttribute(e)}else{var s=r&&e!==(e=e.replace(/^xlink:?/,""));null==i||!1===i?s?t.removeAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase()):t.removeAttribute(e):"function"!=typeof i&&(s?t.setAttributeNS("http://www.w3.org/1999/xlink",e.toLowerCase(),i):t.setAttribute(e,i))}else t.className=i||""}function sf(t){return this._listeners[t.type](t)}var cf=[],lf=0,uf=!1,hf=!1;function ff(){for(var t;t=cf.pop();)t.componentDidMount&&t.componentDidMount()}function df(t,e,n,i,r,a){lf++||(uf=null!=r&&void 0!==r.ownerSVGElement,hf=null!=t&&!("__preactattr_"in t));var o=gf(t,e,n,i,a);return r&&o.parentNode!==r&&r.appendChild(o),--lf||(hf=!1,a||ff()),o}function gf(t,e,n,i,r){var a=t,o=uf;if(null!=e&&"boolean"!=typeof e||(e=""),"string"==typeof e||"number"==typeof e)return t&&void 0!==t.splitText&&t.parentNode&&(!t._component||r)?t.nodeValue!=e&&(t.nodeValue=e):(a=document.createTextNode(e),t&&(t.parentNode&&t.parentNode.replaceChild(a,t),pf(t,!0))),a.__preactattr_=!0,a;var s,c,l=e.nodeName;if("function"==typeof l)return function(t,e,n,i){var r=t&&t._component,a=r,o=t,s=r&&t._componentConstructor===e.nodeName,c=s,l=rf(e);for(;r&&!c&&(r=r._parentComponent);)c=r.constructor===e.nodeName;r&&c&&(!i||r._component)?(bf(r,l,3,n,i),t=r.base):(a&&!s&&(kf(a),t=o=null),r=mf(e.nodeName,l,n),t&&!r.nextBase&&(r.nextBase=t,o=null),bf(r,l,1,n,i),t=r.base,o&&t!==o&&(o._component=null,pf(o,!1)));return t}(t,e,n,i);if(uf="svg"===l||"foreignObject"!==l&&uf,l=String(l),(!t||!nf(t,l))&&(s=l,(c=uf?document.createElementNS("http://www.w3.org/2000/svg",s):document.createElement(s)).normalizedNodeName=s,a=c,t)){for(;t.firstChild;)a.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(a,t),pf(t,!0)}var u=a.firstChild,h=a.__preactattr_,f=e.children;if(null==h){h=a.__preactattr_={};for(var d=a.attributes,g=d.length;g--;)h[d[g].name]=d[g].value}return!hf&&f&&1===f.length&&"string"==typeof f[0]&&null!=u&&void 0!==u.splitText&&null==u.nextSibling?u.nodeValue!=f[0]&&(u.nodeValue=f[0]):(f&&f.length||null!=u)&&function(t,e,n,i,r){var a,o,s,c,l,u=t.childNodes,h=[],f={},d=0,g=0,p=u.length,y=0,v=e?e.length:0;if(0!==p)for(var m=0;m<p;m++){var x=u[m],b=x.__preactattr_,w=v&&b?x._component?x._component.__key:b.key:null;null!=w?(d++,f[w]=x):(b||(void 0!==x.splitText?!r||x.nodeValue.trim():r))&&(h[y++]=x)}if(0!==v)for(var m=0;m<v;m++){c=e[m],l=null;var w=c.key;if(null!=w)d&&void 0!==f[w]&&(l=f[w],f[w]=void 0,d--);else if(g<y)for(a=g;a<y;a++)if(void 0!==h[a]&&(k=o=h[a],_=r,"string"==typeof(M=c)||"number"==typeof M?void 0!==k.splitText:"string"==typeof M.nodeName?!k._componentConstructor&&nf(k,M.nodeName):_||k._componentConstructor===M.nodeName)){l=o,h[a]=void 0,a===y-1&&y--,a===g&&g++;break}l=gf(l,c,n,i),s=u[m],l&&l!==t&&l!==s&&(null==s?t.appendChild(l):l===s.nextSibling?af(s):t.insertBefore(l,s))}var k,M,_;if(d)for(var m in f)void 0!==f[m]&&pf(f[m],!1);for(;g<=y;)void 0!==(l=h[y--])&&pf(l,!1)}(a,f,n,i,hf||null!=h.dangerouslySetInnerHTML),function(t,e,n){var i;for(i in n)e&&null!=e[i]||null==n[i]||of(t,i,n[i],n[i]=void 0,uf);for(i in e)"children"===i||"innerHTML"===i||i in n&&e[i]===("value"===i||"checked"===i?t[i]:n[i])||of(t,i,n[i],n[i]=e[i],uf)}(a,e.attributes,h),uf=o,a}function pf(t,e){var n=t._component;n?kf(n):(null!=t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),!1!==e&&null!=t.__preactattr_||af(t),yf(t))}function yf(t){for(t=t.lastChild;t;){var e=t.previousSibling;pf(t,!0),t=e}}var vf=[];function mf(t,e,n){var i,r=vf.length;for(t.prototype&&t.prototype.render?(i=new t(e,n),Mf.call(i,e,n)):((i=new Mf(e,n)).constructor=t,i.render=xf);r--;)if(vf[r].constructor===t)return i.nextBase=vf[r].nextBase,vf.splice(r,1),i;return i}function xf(t,e,n){return this.constructor(t,n)}function bf(t,e,n,i,r){t._disable||(t._disable=!0,t.__ref=e.ref,t.__key=e.key,delete e.ref,delete e.key,void 0===t.constructor.getDerivedStateFromProps&&(!t.base||r?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,i)),i&&i!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=i),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,0!==n&&(1!==n&&!1===Hh.syncComponentUpdates&&t.base?tf(t):wf(t,1,r)),t.__ref&&t.__ref(t))}function wf(t,e,n,i){if(!t._disable){var r,a,o,s=t.props,c=t.state,l=t.context,u=t.prevProps||s,h=t.prevState||c,f=t.prevContext||l,d=t.base,g=t.nextBase,p=d||g,y=t._component,v=!1,m=f;if(t.constructor.getDerivedStateFromProps&&(c=Jh(Jh({},c),t.constructor.getDerivedStateFromProps(s,c)),t.state=c),d&&(t.props=u,t.state=h,t.context=f,2!==e&&t.shouldComponentUpdate&&!1===t.shouldComponentUpdate(s,c,l)?v=!0:t.componentWillUpdate&&t.componentWillUpdate(s,c,l),t.props=s,t.state=c,t.context=l),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!v){r=t.render(s,c,l),t.getChildContext&&(l=Jh(Jh({},l),t.getChildContext())),d&&t.getSnapshotBeforeUpdate&&(m=t.getSnapshotBeforeUpdate(u,h));var x,b,w=r&&r.nodeName;if("function"==typeof w){var k=rf(r);(a=y)&&a.constructor===w&&k.key==a.__key?bf(a,k,1,l,!1):(x=a,t._component=a=mf(w,k,l),a.nextBase=a.nextBase||g,a._parentComponent=t,bf(a,k,0,l,!1),wf(a,1,n,!0)),b=a.base}else o=p,(x=y)&&(o=t._component=null),(p||1===e)&&(o&&(o._component=null),b=df(o,r,l,n||!d,p&&p.parentNode,!0));if(p&&b!==p&&a!==y){var M=p.parentNode;M&&b!==M&&(M.replaceChild(b,p),x||(p._component=null,pf(p,!1)))}if(x&&kf(x),(t.base=b)&&!i){for(var _=t,S=t;S=S._parentComponent;)(_=S).base=b;b._component=_,b._componentConstructor=_.constructor}}for(!d||n?cf.unshift(t):v||t.componentDidUpdate&&t.componentDidUpdate(u,h,m);t._renderCallbacks.length;)t._renderCallbacks.pop().call(t);lf||i||ff()}}function kf(t){var e=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var n=t._component;n?kf(n):e&&(e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),af(t.nextBase=e),vf.push(t),yf(e)),t.__ref&&t.__ref(null)}function Mf(t,e){this._dirty=!0,this.context=e,this.props=t,this.state=this.state||{},this._renderCallbacks=[]}function _f(){var r,a,t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).createElement,e=void 0===t?document.createElement.bind(document):t,o=vh(),n=mh();return n.element=function(){return r},n.root=function(){return r},n.appendTo=function(t){return r||((r=e("div")).style.position="absolute",r.style["-webkit-font-smoothing"]="antialiased",r.style["-moz-osx-font-smoothing"]="antialiased",r.style.pointerEvents="none"),t.appendChild(r),r},n.render=function(t){if(!r)return!1;var e,n=o.scaleRatio.x,i=o.scaleRatio.y;return r.style.left="".concat(Math.round(o.margin.left+o.x*n),"px"),r.style.top="".concat(Math.round(o.margin.left+o.y*i),"px"),r.style.width="".concat(Math.round(o.width*n),"px"),r.style.height="".concat(Math.round(o.height*i),"px"),e=Array.isArray(t)?Zh("div",null,t):t,a=df(a,e,{},!1,r,!1),!0},n.renderArgs=[Zh],n.clear=function(){if(r){for(var t=r.firstChild;t;)r.removeChild(t),t=r.firstChild;a=null}return n},n.destroy=function(){r&&r.parentElement&&r.parentElement.removeChild(r),a=r=null},n.size=function(t){return t&&(o=vh(t)),o},n}Jh(Mf.prototype,{setState:function(t,e){this.prevState||(this.prevState=this.state),this.state=Jh(Jh({},this.state),"function"==typeof t?t(this.state,this.props):t),e&&this._renderCallbacks.push(e),tf(this)},forceUpdate:function(t){t&&this._renderCallbacks.push(t),wf(this,2)},render:function(){}});var Sf=[function(t){t.renderer("svg",qh)},function(t){t.renderer("canvas",Mh)},function(t){t.renderer("dom",_f)}],Rf={OFF:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},zf=function(){var t,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},n=e.level,i=void 0===n?Rf.OFF:n,r=e.pipe,a=void 0===r?console:r,o=i,s=(A(t={},Rf.OFF,function(){}),A(t,Rf.ERROR,function(){return a.error.apply(a,arguments)}),A(t,Rf.WARN,function(){return a.warn.apply(a,arguments)}),A(t,Rf.INFO,function(){return a.info.apply(a,arguments)}),A(t,Rf.DEBUG,function(){return a.log.apply(a,arguments)}),t),c=function(t){if(t&&!(o<t)){for(var e=arguments.length,n=new Array(1<e?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];(s[t]||s[Rf.DEBUG]).apply(void 0,n)}};return{log:c,error:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Rf.ERROR].concat(e))},warn:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Rf.WARN].concat(e))},info:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Rf.INFO].concat(e))},debug:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return c.apply(void 0,[Rf.DEBUG].concat(e))},level:function(t){return"number"==typeof t&&(o=t),o},LOG_LEVEL:Rf}};var Nf=function e(){var n=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},i=zf(n.logger),r={component:Kt(t.component),data:Kt(t.data),formatter:Kt(t.formatter),interaction:Kt(t.interaction),renderer:Eo(t.renderer),scale:Kt(t.scale),symbol:Kt(t.symbol),logger:i};function a(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};return e({palettes:n.palettes.concat(t.palettes||[]),style:G({},n.style,t.style),logger:t.logger||n.logger,renderer:t.renderer||n.renderer},r)}return n.renderer&&n.renderer.prio&&r.renderer.default(n.renderer.prio[0]),a.use=function(t){return function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};t(2<arguments.length?arguments[2]:void 0,e)}(t,1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},r)},a.chart=function(t){return To(t,{registries:r,logger:i,style:n.style,palettes:n.palettes})},a.config=function(){return n},Object.keys(r).forEach(function(t){a[t]=r[t]}),a.version=y.version,a}({renderer:{prio:["svg","canvas"]},logger:{level:0},style:{"$font-family":"'Source Sans Pro', Arial, sans-serif","$font-size":"12px","$line-height":"16px","$font-size--l":"16px","$gray-100":"#ffffff","$gray-98":"#f9f9f9","$gray-95":"#f2f2f2","$gray-90":"#e6e6e6","$gray-35":"#595959","$gray-30":"#4d4d4d","$gray-25":"#404040","$gray-20":"#333333","$border-95":"rgba(255, 255, 255, 0.05)","$border-90":"rgba(255, 255, 255, 0.1)","$border-80":"rgba(255, 255, 255, 0.2)","$border-20":"rgba(0, 0, 0, 0.2)","$border-10":"rgba(0, 0, 0, 0.1)","$border-5":"rgba(0, 0, 0, 0.05)","$primary-blue":"#3F8AB3","$primary-green":"#6CB33F","$primary-red":"#DC423F","$primary-orange":"#EF960F","$spacing--s":4,$spacing:8,"$spacing--l":12,"$font-color":"$gray-35","$font-color--inverted":"$gray-90","$guide-color":"$gray-90","$guide-color--inverted":"$gray-35",$border:"$border-80","$border--inverted":"$border-10",$shape:{fill:"$primary-blue",strokeWidth:1,stroke:"$border"},"$shape-outline":{stroke:"$primary-blue",strokeWidth:2},"$shape-guide":{stroke:"$guide-color",strokeWidth:1},"$shape-guide--inverted":{"@extend":"$shape-guide",stroke:"$guide-color--inverted"},$label:{fontSize:"$font-size",fontFamily:"$font-family",fill:"$font-color"},"$label--inverted":{$extend:"$label",fill:"$font-color--inverted"},"$label-overlay":{fontSize:"$font-size--l",fontFamily:"$font-family",fill:"$gray-100",color:"$font-color",stroke:"$guide-color--inverted",strokeWidth:1,borderRadius:4},$title:{"@extend":"$label",fontSize:"$font-size--l"},"$guide-line":{strokeWidth:1,stroke:"$guide-color"},"$guide-line--minor":{strokeWidth:1,stroke:"$gray-95"},"$padding--s":{left:"$spacing--s",right:"$spacing--s",top:"$spacing--s",bottom:"$spacing--s"},$padding:{left:"$spacing",right:"$spacing",top:"$spacing",bottom:"$spacing"},"$selection-area-target":{fill:"$primary-green",strokeWidth:0,opacity:.2}},palettes:[{key:"categorical",colors:[["#a54343","#d76c6c","#ec983d","#ecc43d","#f9ec86","#cbe989","#70ba6e","#578b60","#79d69f","#26a0a7","#138185","#65d3da"]]},{key:"diverging",colors:[["#3d52a1","#3a89c9","#77b7e5","#b4ddf7","#e6f5fe","#ffe3aa","#f9bd7e","#ed875e","#d24d3e","#ae1c3e"]]},{key:"sequential",colors:[["rgb(180,221,212)","rgb(34, 83, 90)"]]}]},{component:Oo,data:Uo,formatter:Gn,interaction:Ho,renderer:Eo(),scale:ha});return Il.forEach(Nf.use),Sf.forEach(Nf.use),[].forEach(Nf.use),Nf});
//# sourceMappingURL=picasso.js.map
